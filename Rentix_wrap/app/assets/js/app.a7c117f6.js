(function(t){function e(e){for(var r,n,a=e[0],c=e[1],u=e[2],d=0,l=[];d<a.length;d++)n=a[d],o[n]&&l.push(o[n][0]),o[n]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);f&&f(e);while(l.length)l.shift()();return i.push.apply(i,u||[]),s()}function s(){for(var t,e=0;e<i.length;e++){for(var s=i[e],r=!0,n=1;n<s.length;n++){var a=s[n];0!==o[a]&&(r=!1)}r&&(i.splice(e--,1),t=c(c.s=s[0]))}return t}var r={},n={app:0},o={app:0},i=[];function a(t){return c.p+"assets/js/"+({}[t]||t)+"."+{"chunk-2d222385":"6381e742","chunk-7a7fe8ed":"3d25fa80"}[t]+".js"}function c(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.e=function(t){var e=[],s={"chunk-7a7fe8ed":1};n[t]?e.push(n[t]):0!==n[t]&&s[t]&&e.push(n[t]=new Promise(function(e,s){for(var r="assets/css/"+({}[t]||t)+"."+{"chunk-2d222385":"31d6cfe0","chunk-7a7fe8ed":"a4a7f632"}[t]+".css",o=c.p+r,i=document.getElementsByTagName("link"),a=0;a<i.length;a++){var u=i[a],d=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(d===r||d===o))return e()}var l=document.getElementsByTagName("style");for(a=0;a<l.length;a++){u=l[a],d=u.getAttribute("data-href");if(d===r||d===o)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var r=e&&e.target&&e.target.src||o,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.request=r,delete n[t],f.parentNode.removeChild(f),s(i)},f.href=o;var _=document.getElementsByTagName("head")[0];_.appendChild(f)}).then(function(){n[t]=0}));var r=o[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise(function(e,s){r=o[t]=[e,s]});e.push(r[2]=i);var u,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=a(t),u=function(e){d.onerror=d.onload=null,clearTimeout(l);var s=o[t];if(0!==s){if(s){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src,i=new Error("Loading chunk "+t+" failed.\n("+r+": "+n+")");i.type=r,i.request=n,s[1](i)}o[t]=void 0}};var l=setTimeout(function(){u({type:"timeout",target:d})},12e4);d.onerror=d.onload=u,document.head.appendChild(d)}return Promise.all(e)},c.m=t,c.c=r,c.d=function(t,e,s){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(s,r,function(e){return t[e]}.bind(null,r));return s},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],d=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var f=d;i.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"017f":function(t,e,s){},"034f":function(t,e,s){"use strict";var r=s("64a9"),n=s.n(r);n.a},"0b64":function(t,e,s){"use strict";var r=s("3679"),n=s.n(r);n.a},"0bda":function(t,e,s){"use strict";var r=s("d283"),n=s.n(r);n.a},1184:function(t,e,s){"use strict";var r=s("9474"),n=s.n(r);n.a},1733:function(t,e,s){},"1a29":function(t,e,s){"use strict";var r=s("5299"),n=s.n(r);n.a},"1c89":function(t,e,s){"use strict";var r=s("73bf"),n=s.n(r);n.a},"1cac":function(t,e,s){"use strict";var r=s("a7a4"),n=s.n(r);n.a},"20b7":function(t,e,s){"use strict";var r=s("c03e"),n=s.n(r);n.a},"237a":function(t,e,s){},"25ad":function(t,e,s){"use strict";var r=s("cb2f"),n=s.n(r);n.a},"26a1":function(t,e,s){},"2ad2":function(t,e,s){},3679:function(t,e,s){},"3d08":function(t,e,s){"use strict";var r=s("26a1"),n=s.n(r);n.a},"3ff9":function(t,e,s){},4103:function(t,e,s){},"42ce":function(t,e,s){},"43e6":function(t,e,s){"use strict";var r=s("92b5"),n=s.n(r);n.a},"4af1":function(t,e,s){"use strict";var r=s("edf7"),n=s.n(r);n.a},5107:function(t,e,s){"use strict";var r=s("42ce"),n=s.n(r);n.a},5216:function(t,e,s){"use strict";var r=s("ff4c"),n=s.n(r);n.a},5238:function(t,e,s){"use strict";var r=s("a159"),n=s.n(r);n.a},5299:function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("097d");var r=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app black"},[s("div",{staticClass:"app__wrap"},[t.dev?s("span",{staticClass:"app__branch"},[t._v("β")]):t._e(),s("adm-panel",{staticClass:"adm"}),s("router-view")],1)])},o=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ul",{staticClass:"adm_list"},[s("li",[s("router-link",{staticClass:"router-link",attrs:{to:"/"}},[t._v("Прокат")])],1),s("li",[s("router-link",{staticClass:"router-link",attrs:{to:"/customers"}},[t._v("Клиенты")])],1),s("li",[s("router-link",{staticClass:"router-link",attrs:{to:"/history"}},[t._v("История")])],1),s("li",[s("router-link",{staticClass:"router-link",attrs:{to:"/options"}},[t._v("Настройки")])],1)])])},a=[],c={name:"admPanel"},u=c,d=(s("edc0"),s("2877")),l=Object(d["a"])(u,i,a,!1,null,null,null);l.options.__file="index.vue";var f=l.exports,_={name:"app",components:{admPanel:f},created:function(){this.$store.dispatch("startTimer")},computed:{dev:function(){return"dev"===this.$store.getters.activeBranch}}},p=_,h=(s("034f"),Object(d["a"])(p,n,o,!1,null,null,null));h.options.__file="App.vue";var v=h.exports,m=s("8c4f"),g=s("75fc"),b=s("2f62"),C=s("bc3a"),O=s.n(C),w={state:{products:[]},mutations:{setProducts:function(t,e){t.products=e,console.log("set products")}},actions:{setProducts:function(t,e){var s=t.commit;s("setProducts",e)}},getters:{products:function(t){return t.products}}},y=(s("c5f6"),{state:{subOrders:[]},mutations:{setSubOrders:function(t,e){t.subOrders=e?e.map(function(t){return t.id=Number(t.id),t.id_rent=Number(t.id_rent),t}):[],console.log("set subOrders")}},actions:{setSubOrders:function(t,e){var s=t.commit;s("setSubOrders",e)}},getters:{orderProducts:function(t){return t.subOrders},subOrders:function(t){return t.subOrders}}}),k={state:{customers:[]},mutations:{setCustomers:function(t,e){t.customers=e?e.map(function(t){return t.id=Number(t.id),t.id_rent=Number(t.id_rent),t}):[],console.log("set customers")}},getters:{customers:function(t){return t.customers}}},$={state:{orders:[]},mutations:{setOrders:function(t,e){t.orders=e,console.log("set Orders")}},actions:{setOrders:function(t,e){var s=t.commit;s("setOrders",e)}},getters:{orders:function(t){return t.orders}}},T=(s("7f7f"),s("0a0d")),P=s.n(T),S={state:{cmds:["getProducts","getOrders","getClients","getHistory","getTariffs","getCategories","getOptions","getLogs","getHeaders"],app_id:null,options:{rent_min_time:0,rent_round_bill:0,lastOrderID:null,lastOrderTime:null,lastOrderInterval:18e4,registration_time:0},now:P()(),activeBranch:"master",branch:{master:{url:"https://rentix.biz/api/request.php",path:"https://app.rentix.biz/"},dev:{url:"https://test.rentix.biz/api/request.php",path:"localhost:8080/"}},depositList:[{id_rent:1,name:"Паспорт"},{id_rent:2,name:"Водительское"},{id_rent:3,name:"Военный билет"},{id_rent:4,name:"Загран. паспорт"},{id_rent:5,name:"Мед. полис"},{id_rent:6,name:"Снилс"},{id_rent:7,name:"Студентческий"},{id_rent:8,name:"Водительское"},{id_rent:9,name:"Другое"}],promotions:[{id:1,name:"30%",discount:30},{id:2,name:"Студент - 10%",discount:10}]},mutations:{setOptions:function(t,e){e&&e.map(function(e){t.options[e.name]=e.value})},setOption:function(t,e){var s=e.option,r=e.value;s&&(t.options[s]=r,console.log("setOption",s,t.options[s]))},now:function(t,e){t.now=e},setAppId:function(t,e){t.app_id=e}},actions:{startTimer:function(t){var e=t.commit;setInterval(function(){e("now",P()())},1e3)},setAppId:function(t,e){t("setAppId",e)}},getters:{now:function(t){return t.now},options:function(t){return t.options},depositList:function(t){return t.depositList},deposits:function(t){return t.depositList},promotions:function(t){return t.promotions},activeBranch:function(t){return t.activeBranch},activePath:function(t){return t.branch[t.activeBranch].path},url:function(t){return t.branch[t.activeBranch].url},appID:function(t){return t.app_id}}},x={state:{tariffs:[]},mutations:{setTariffs:function(t,e){t.tariffs=e,console.log("set tariffs")}},actions:{setProducts:function(t,e){var s=t.commit;s("setTariffs",e)}},getters:{tariffs:function(t){return t.tariffs}}},A={state:{categories:[]},mutations:{setCategories:function(t,e){t.categories=e,console.log("set categories")}},actions:{setCategories:function(t,e){var s=t.commit;s("setCategories",e)}},getters:{categories:function(t){return t.categories}}},E=(s("7514"),{state:{history:[]},mutations:{setHistory:function(t,e){if(!e)return[];var s=this.getters.products;!e||e.map(function(t){for(var e=0,r=0;r<t.products.length;r++){var n=s.find(function(e){return e.id_rent==t.products[r].product_id});t.products[r].name=n?n.name:"",e+=+t.products[r].bill}return t.bill=e,t}),t.history=e,console.log("set history")}},getters:{history:function(t){return t.history}}}),D={state:{accessories:[]},mutations:{setAccessories:function(t,e){t.accessories=e,console.log("set accessories")}},actions:{setAccessories:function(t,e){var s=t.commit;s("setAccessories",e)}},getters:{accessories:function(t){return t.accessories}}},I=s("795b"),N=s.n(I),j={state:{token:localStorage.getItem("user-token")||"",status:""},getters:{isAuthenticated:function(t){return!!t.token},authStatus:function(t){return t.status}},actions:{AUTH_REQUEST:function(t,e){var s=t.getters,r=t.commit;t.dispatch;return console.log("AUTH_REQUEST"),new N.a(function(t,n){r("AUTH_REQUEST"),O()({url:s.url,data:{cmd:"login",value:e},method:"POST"}).then(function(e){console.log(e);var s=e.data.token;s&&(r("AUTH_SUCCESS",s),localStorage.setItem("user-token",s)),t(e)}).catch(function(t){console.log(t),r("AUTH_ERROR",t),localStorage.removeItem("user-token"),n(t)})})},AUTH_TOKEN:function(t,e){var s=t.getters,r=(t.dispatch,t.commit);return console.log("AUTH_TOKEN",e),new N.a(function(t,n){O()({url:s.url,method:"POST",data:{token:e}}).then(function(s){console.log("its ok",s),r("AUTH_SUCCESS",e),localStorage.setItem("user-token",e),t(s)}).catch(function(t){r("AUTH_ERROR",t),localStorage.removeItem("user-token"),n(t)})})},AUTH_REGISTER:function(t,e){var s=t.getters,r=t.commit;t.dispatch;return new N.a(function(t,n){O()({url:s.url+"/api/register",data:e,method:"POST"}).then(function(e){var s=e.data.success.token;O.a.defaults.headers.common["Authorization"]=s,r("AUTH_SUCCESS",s),localStorage.setItem("user-token",s),t(e)}).catch(function(t){r("AUTH_ERROR",t),localStorage.removeItem("user-token"),n(t)})})},AUTH_LOGOUT:function(t){var e=t.commit;t.dispatch,t.state;return new N.a(function(t,s){e("AUTH_LOGOUT"),localStorage.removeItem("user-token"),delete O.a.defaults.headers.common["Authorization"],t()})}},mutations:{AUTH_REQUEST:function(t){t.status="loading"},AUTH_SUCCESS:function(t,e){t.status="success",t.token=e},AUTH_ERROR:function(t){t.status="error"},AUTH_LOGOUT:function(t){t.token="",t.status=""}}},R={state:{initAppStatus:"not init"},getters:{isAppInited:function(t){return"inited"===t.initAppStatus}},actions:{INIT_APP:function(t,e){var s=t.getters,r=t.commit;t.dispatch;if(!s.isAppInited)return console.log("inited = ",s.isAppInited),r("INIT_APP_STATUS","loading"),new N.a(function(t,e){var n=[{cmd:"getProducts",value:""},{cmd:"getSubOrders",value:""},{cmd:"getOrders",value:""},{cmd:"getCustomers",value:""},{cmd:"getHistory",value:""},{cmd:"getTariffs",value:""},{cmd:"getCategories",value:""},{cmd:"getOptions",value:""},{cmd:"getLogs",value:""},{cmd:"getAccessories",value:""},{cmd:"getHeaders",value:""},{cmd:"getRentalPointInfo",value:""}],o=localStorage.getItem("user-token");console.log("front --\x3e back",n,o),O()({url:s.url,method:"POST",data:{token:o,queue:n}}).then(function(e){console.log("front <-- back",e),r("setProducts",e.data.products),r("setHistory",e.data.history),r("setOptions",e.data.options),r("setTariffs",e.data.tariffs),r("setCategories",e.data.categories),r("setCustomers",e.data.customers),r("setSubOrders",e.data.sub_orders),r("setOrders",e.data.orders),r("setAccessories",e.data.accessories),r("setRentalPointInfo",e.data.rental_point_info[0]),r("INIT_APP_STATUS","inited"),console.log("INIT_APP"),t(e)}).catch(function(t){console.log(t),r("INIT_APP_STATUS","not init"),e(t)})})},REBOOT_APP_INIT_STATUS:function(t){var e=t.commit;e("SET_APP_INIT_STATUS","not init")}},mutations:{INIT_APP_STATUS:function(t,e){t.initAppStatus=e},SET_APP_INIT_STATUS:function(t,e){t.initAppStatus=e}}},U={state:{name:null,address:null,open:null,close:null,telephone:null,description:null,coordinates:null},getters:{rentalPointInfo:function(t){return{name:t.name,city:t.city,address:t.address,time_open:t.time_open,time_close:t.time_close,phone:t.phone,description:t.description,coordinates:t.coordinates}}},mutations:{setRentalPointInfo:function(t,e){for(var s in e)t[s]=e[s]}},actions:{sendRentalPointOptions:function(t,e){var s=this,r=(t.commit,t.dispatch);t.getters;return new N.a(function(t,n){O()({method:"post",url:s.getters.url,data:{queue:[{cmd:"setRentalPointInfo",value:e}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("setRentalPointInfo",e)})})},setRentalPointInfo:function(t,e){var s=t.commit;s("setRentalPointInfo",e)}}};r["a"].use(b["a"]);var M=new b["a"].Store({modules:{products:w,subOrders:y,customers:k,orders:$,options:S,tariffs:x,categories:A,history:E,accessories:D,auth:j,initApp:R,RentalPointOptions:U},actions:{send:function(t,e){var s=this,r=t.commit,n=e&&e.config?e.config:null,o=function(t){if(t)return t.cmd?[{cmd:t.cmd,value:t.value}]:t},i=function(t){var e=s.getters.url;console.log("front --\x3e back",t),O()({method:"post",url:e,data:{queue:t,token:localStorage.getItem("user-token")},config:n}).catch(function(t){console.log(t)}).then(function(t){console.log("front <-- back",t),r("setProducts",t.data.products),r("setHistory",t.data.history),r("setOptions",t.data.options),r("setTariffs",t.data.tariffs),r("setCategories",t.data.categories),r("setCustomers",t.data.customers),r("setSubOrders",t.data.sub_orders),r("setOrders",t.data.orders),r("setAccessories",t.data.accessories)})},a=function(){e=["getProducts","getSubOrders","getOrders","getCustomers","getHistory","getTariffs","getCategories","getOptions","getLogs","getAccessories","getHeaders","getRentalPointInfo"];var t=e.map(function(t){return{cmd:t}});return t},c=function(t){t=t||[],t=[].concat(Object(g["a"])(t),Object(g["a"])(a())),i(t)};c(o(e))},upload:function(t){var e=this.getters.activePath+"user_uploads.php";console.log(e);var s={header:{"Content-Type":"multipart/form-data"}};O.a.post(e,t,s).then(function(t){console.log(t)})},upd:function(t){var e=t.dispatch;e("send")}}}),L=M,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"desktop"},[s("product-list",{staticClass:"snippet snippet__products",on:{addOrder:function(e){t.addOrder(e)}}}),s("order-list",{staticClass:"snippet snippet__orders"}),t.show?s("DetailsOrder",{attrs:{product:t.product},on:{close:t.onClose}}):t._e()],1)},B=[],z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-list"},[s("h3",[t._v("Свободныe "),t.products.length?s("span",[t._v("("+t._s(t.products.length)+")")]):t._e()]),s("table",{staticClass:"table table-bordered"},t._l(t.products,function(e){return s("tr",{key:e.id_rent,staticClass:"products__product",on:{click:function(s){t.onClick(e)}}},[s("td",{staticClass:"products__td products__td--icon",on:{mousemove:function(s){t.openPhoto(e)},mouseout:function(e){t.closePhoto()}}},[s("Bike",{attrs:{_color:e.color,_type:+e.type}})],1),s("td",{staticClass:"products__td"},[t._v(t._s(e.name))])])}),0),t.product.id_rent?s("Photo",{staticClass:"products__photo",attrs:{product:t.product}}):t._e()],1)},V=[],q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"icon"},[1===t.type?s("i",{staticClass:"icon"},[s("svg",{attrs:{viewBox:"0 0 1010 585.7407"}},[s("path",{attrs:{id:"bike-12-bike-12",fill:t.color,d:"M309.8848,64.7134c-12.4971,0-23.9776-4.0542-33.4268-10.8008h-4.0635\n            c-12.645,0-22.9126,10.248-22.9126,22.9224c0,12.645,10.2676,22.893,22.9126,22.893h121.4761\n            c8.6401,0,18.8189-4.9419,18.8189-17.2314c0-11.8555-9.5967-17.7832-19.0064-17.7832H309.8848z M820.9512,207.6811\n            c-16.1758,0-31.7998,2.2784-46.8018,6.1153L697.7881,12.9111c-3.1865-8.4038-11.4522-13.3154-19.9932-12.7632\n            C677.3418,0.0986,676.8877,0,676.4043,0h-67.9678c-9.6172,0-17.4189,7.8022-17.4189,17.4185\n            c0,9.6069,7.8017,17.3989,17.4189,17.3989h54.8399l26.5714,69.9111H352.4844c-2.9986,0-5.8394,0.6904-8.3838,1.8936\n            c-3.5708,1.3711-6.707,3.8369-8.7984,7.3877l-65.354,112.0962c-24.5693-11.688-51.9204-18.4249-80.8984-18.4249\n            C84.8145,207.6811,0,292.4858,0,396.7114c0,104.2451,84.8145,189.0293,189.0498,189.0293\n            c98.376,0,179.3438-75.5224,188.1714-171.6113h39.019c7.5357,25.1318,30.5567,43.5371,58.1245,43.5371\n            c33.6734,0,60.9556-27.2627,60.9556-60.9355c0-11.4415-3.334-22.0049-8.789-31.1182l180.5976-215.3652l29.4902,77.5449\n            c-61.9609,31.0498-104.708,95.0029-104.708,168.9189c0,104.2451,84.7842,189.0293,189.0401,189.0293\n            c104.2343,0,189.0488-84.7842,189.0488-189.0293C1010,292.4858,925.1855,207.6811,820.9512,207.6811z M220.9473,379.2827\n            l61.3105-105.1328c32.6475,24.8652,55.1358,62.3262,59.9785,105.1328H220.9473z M299.9033,243.9189l51.2393-87.8818\n            l83.0097,195.2241c-8.4038,7.4073-14.5976,17.0332-17.9121,28.0215h-39.019C372.1123,323.6831,342.7588,275.0869,299.9033,243.9189z\n             M474.3647,335.7759c-1.0751,0-2.081,0.2666-3.1464,0.3154l-81.3521-191.3081h269.6026L495.8467,339.8589\n            C489.1299,337.3345,481.9497,335.7759,474.3647,335.7759z M189.0498,550.9233c-85.0415,0-154.2227-69.1905-154.2227-154.2119\n            s69.1812-154.1929,154.2227-154.1929c22.5869,0,43.9702,5.0005,63.3125,13.7593l-61.9316,106.208\n            c-0.4639,0-0.9175-0.1191-1.3809-0.1191c-18.977,0-34.3838,15.3574-34.3838,34.3643c0,18.9873,15.4068,34.3632,34.3838,34.3632\n            c12.605,0,23.4941-6.8545,29.501-16.9648h123.6855C333.5469,490.9741,268.2021,550.9233,189.0498,550.9233z M820.9512,550.9233\n            c-85.0616,0-154.2227-69.1905-154.2227-154.2119c0-59.0615,33.416-110.4199,82.2988-136.2812l44.1778,116.1699\n            c-4.1328,5.6611-6.628,12.5752-6.628,20.1309c0,18.9873,15.3868,34.3632,34.3741,34.3632c18.9961,0,34.3633-15.3759,34.3633-34.3632\n            c0-15.377-10.1104-28.2188-24.0274-32.6377l-44.71-117.5899c11.0967-2.5156,22.5381-3.9849,34.3741-3.9849\n            c85.0215,0,154.2217,69.1714,154.2217,154.1929S905.9727,550.9233,820.9512,550.9233z"}})])]):t._e(),2===t.type?s("i",{staticClass:"icon"},[s("svg",{attrs:{fill:t.color,viewBox:"0 18 100 100"}},[s("path",{attrs:{d:"M76.454,50.452c-0.786,0-1.552,0.082-2.301,0.213l-3.79-11.997h1.154c0.552,0,1.071-0.259,1.403-0.701  c0.331-0.441,0.436-1.013,0.282-1.542l-3.549-12.251c-0.218-0.75-0.904-1.267-1.686-1.267h-3.08c-0.969,0-1.755,0.786-1.755,1.755  s0.786,1.755,1.755,1.755h1.761l2.533,8.741h-1.214c-0.56,0-1.086,0.267-1.416,0.718s-0.427,1.033-0.258,1.566l1.042,3.299  l-25.845,7.105l-0.708-2.24l4.297-2.076c0.873-0.421,1.238-1.471,0.817-2.343c-0.422-0.873-1.471-1.239-2.344-0.817l-11.614,5.61  c-0.873,0.421-1.238,1.471-0.817,2.343c0.303,0.627,0.93,0.992,1.582,0.992c0.256,0,0.516-0.057,0.762-0.175l4.124-1.992  l0.706,2.235l-5.678,4.664c-2.381-2.224-5.567-3.596-9.075-3.596c-7.345,0-13.32,5.975-13.32,13.32s5.976,13.321,13.32,13.321  c7.001,0,12.746-5.432,13.27-12.301l2.753-0.153c0.789,1.846,2.621,3.144,4.752,3.144c2.849,0,5.165-2.317,5.165-5.166  c0-0.601-0.123-1.169-0.312-1.706l19.495-15.96l2.141,6.775c-4.526,2.13-7.674,6.722-7.674,12.047  c0,7.345,5.976,13.321,13.32,13.321c7.346,0,13.321-5.976,13.321-13.321S83.8,50.452,76.454,50.452z M41.189,58.535  c-0.846,0.651-1.476,1.552-1.792,2.598l-2.771,0.154c-0.311-1.636-0.925-3.162-1.776-4.528l4.588-3.769L41.189,58.535z   M32.113,59.005c0.429,0.769,0.752,1.602,0.963,2.479l-4.27,0.238L32.113,59.005z M23.545,73.583c-5.409,0-9.811-4.401-9.811-9.811  s4.401-9.811,9.811-9.811c2.416,0,4.626,0.881,6.338,2.334l-7.451,6.121c-0.587,0.481-0.797,1.286-0.521,1.993  c0.264,0.677,0.915,1.118,1.635,1.118c0.032,0,0.065-0.001,0.098-0.002l9.63-0.536C32.67,69.825,28.542,73.583,23.545,73.583z   M46.95,58.194c-0.714-0.427-1.534-0.686-2.416-0.723l-1.983-6.275l19.491-5.359L46.95,58.194z M76.454,73.583  c-5.409,0-9.811-4.401-9.811-9.811c0-3.756,2.124-7.021,5.231-8.669l2.906,9.199c0.236,0.748,0.928,1.227,1.673,1.227  c0.175,0,0.354-0.026,0.529-0.082c0.924-0.292,1.437-1.278,1.145-2.202l-2.906-9.197c0.405-0.051,0.814-0.086,1.232-0.086  c5.41,0,9.812,4.401,9.812,9.811S81.864,73.583,76.454,73.583z"}})])]):t._e()])},G=[],J={props:{_color:String,_type:Number},data:function(){return{}},computed:{color:function(){return this._color},type:function(){return+this._type}}},F=J,Q=(s("620b"),Object(d["a"])(F,q,G,!1,null,"6835bca2",null));Q.options.__file="index.vue";var K=Q.exports,W=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"photo__wrap"},[s("div",{staticClass:"photo__text"},[t._v("no photo")]),s("div",{staticClass:"photo__img",style:t.backgroundImage})])},Y=[],X={props:{product:Object,refresh:Boolean},computed:{url:function(){if(!this.product||!this.product.id_rent)return!1;var t=this.$store.getters.activePath,e=this.$store.getters.appID,s=this.product.img,r=this.refresh?"?"+Math.floor(1e6*Math.random()):"",n="".concat(t,"user_uploads/").concat(e,"_").concat(this.product.id_rent,"_").concat(s).concat(r);return n},backgroundImage:function(){return{backgroundImage:this.product.img?"url("+this.url+")":"none"}}}},Z=X,tt=(s("fc13"),Object(d["a"])(Z,W,Y,!1,null,"65d99d8a",null));tt.options.__file="index.vue";var et=tt.exports,st=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"details"},[s("table",[s("tr",[s("td",[t._v("Заказ")]),s("td",[t._v(" # "+t._s(t.order.order_id))])]),s("tr",[s("td",[t._v("Клиент")]),s("td",[t.order.customer_name?s("span",[t._v(t._s(t.order.customer_name))]):s("span",[t._v("-")])])]),s("tr",[s("td",[t._v("Залог")]),s("td",[t.deposit?s("span",[t._v(t._s(t.deposit.name))]):s("span",[t._v("-")])])]),s("tr",[s("td",[t._v("Начало")]),s("td",[t._v(t._s(t.order.start_time))])]),s("tr",[s("td",[t._v("Чистое время")]),s("td",[t._v(t._s(t.activeTime))])]),s("tr",[s("td",{attrs:{colspan:"2"}},[s("p",[t._v("Товары")]),s("table",{staticClass:"suborders"},[t._l(t.subOrders,function(e){return s("tr",{key:e.id_rent},[s("td",{staticClass:"suborders__td--descript"},[e.id_rent===t._subOrder.id_rent?s("span",[t._v(">")]):t._e()]),s("td",{staticClass:"suborders__td suborders__td--name"},[t._v("\n                                    "+t._s(t.productNames[e.product_id])+"\n                                ")]),e.bill_access>0?s("td",{staticClass:"suborders__td suborders__td--number",attrs:{title:"Прокат"}},[t._v("\n                                    "+t._s(e.bill_rent)+"\n                                ")]):t._e(),e.bill_access>0?s("td",{staticClass:"suborders__td suborders__td--sign"},[t._v("\n                                    +\n                                ")]):t._e(),e.bill_access>0?s("td",{staticClass:"suborders__td suborders__td--number",attrs:{title:"Аксессуары"}},[t._v("\n                                    "+t._s(e.bill_access)+"\n                                ")]):t._e(),e.bill_access>0?s("td",{staticClass:"suborders__td suborders__td--sign"},[t._v("\n                                    =\n                                ")]):t._e(),s("td",{staticClass:"suborders__td suborders__td--number"},[t._v("\n                                    "+t._s(+e.bill_rent+ +e.bill_access)+"\n                                ")]),"1"===e.paid?s("td",{staticClass:"suborders__td suborders__td--paid",attrs:{title:"Оплачено"}},[t._v("\n                                    ✓\n                                ")]):t._e()])}),s("tr",[s("td"),t._m(0),s("td",{staticClass:"suborders__td suborders__td--rentbill",attrs:{colspan:"3"}},[s("b",[t._v(t._s(t.billRent)+" р.")])])])],2)])]),t.sale>0?s("tr",[s("td",[t._v("Общая скидка ("+t._s(t.customer.sale)+"%)")]),s("td",[s("span",[t._v(t._s(t.sale)+" р.")])])]):t._e(),t.paidBefore>0?s("tr",[s("td",[t._v("Оплачено ранее")]),s("td",[s("span",[t._v(t._s(t.paidBefore))]),t.saledBefore?s("span",{attrs:{title:"С учетом скидки "+t.saledBefore+" р."}},[t._v("("+t._s(t.paidBefore-t.saledBefore)+")")]):t._e(),t._v("\n                         р.\n                    ")])]):t._e(),t.isLast()&&t.order.advance>0?s("tr",[s("td",[t._v("Аванс")]),s("td",[s("span",[t._v(t._s(t.order.advance)+" р.")])])]):t._e(),s("tr",{staticClass:"details__bill"},[s("td",[t.total>=0?s("span",[t._v("\n                            К оплате\n                        ")]):s("span",[t._v("Сдача")])]),s("td",[t._v("\n                        "+t._s(t.total)+" р.\n                    ")])])]),s("div",{staticClass:"btn-group"},[s("button",{staticClass:"resume__button",on:{click:function(e){t.pay("money")}}},[s("i",{staticClass:"fa fa-eur",attrs:{"aria-hidden":"true"}}),t._v("Наличными\n            ")]),s("button",{staticClass:"resume__button",on:{click:function(e){t.pay("card")}}},[s("i",{staticClass:"icon fa fa-credit-card",attrs:{"aria-hidden":"true"}}),t._v("Картой\n            ")]),t.isLast()?t._e():s("button",{staticClass:"resume__button",on:{click:function(e){t.pay("dont pay")}}},[t._v("\n                Без оплаты\n            ")])])])])},rt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{attrs:{colspan:"3"}},[s("b",[t._v("Итого")])])}],nt=(s("28a5"),s("cebc")),ot=function(t){var e="";t<0&&(e="-",t*=-1);var s=function(t){return t=Math.floor(t),t<10?"0"+t:t},r=t/1e3,n=r/86400,o=r/3600%24,i=r/60%60,a=r%60,c=Math.floor(n)?"".concat(Math.floor(n)," дн. "):"";return"".concat(e," ").concat(c).concat(s(o),":").concat(s(i),":").concat(s(a)).trim()},it=ot;function at(t){var e=L.getters.options.rent_round_bill;return e>1?Math.round(t/e)*e:Math.round(t)}function ct(t){if("ACTIVE"==t.status||"PAUSE"==t.status){var e=function(){t.status="PAUSE",t.pause_start=P()()},s=function(){t.status="ACTIVE";var e=P()()-+t.pause_start;t.pause_time=+t.pause_time+e,t.pause_start=0};"ACTIVE"==t.status?e():s()}else console.log("unknown status - ",t.status)}function ut(t,e){if(!t||!e)return 0;var s=L.getters.tariffs.find(function(e){return e.id_rent==t});if(!s)return 0;var r=function(t,e){var s=L.getters.options.rent_min_time,r=t._h_h,n=+t._h_h[0],o=t._h_max>0?t._h_max:1/0;if(e<0)return 0;if(e<s)return t._h_min;for(var i=0,a=e/1e3/3600,c=0;c<Math.floor(a);c++)if(i+=r[c]?+r[c]:n,n=r[c]?+r[c]:n,i>o)return o;return i+=n*(a-Math.floor(a)),i>o?i=o:i<t._h_min&&(i=t._h_min),i},n=function(t,e){var s=e/1e3/86400,r=Math.ceil(s);return r*t.cost};switch(s.type){case"d":return+n(s,e);case"f":return+s.cost;case"h":return+r(s,e)}}var dt=function(t,e,s){if(t&&!isNaN(Number(e))){if(0===e)return 0;var r=function(t,e){return e*(t/100)},n=function(t){return+t};return"%"===t?r(e,s):"р"===t?n(e):void 0}},lt=function(t,e,s){if(!t||!e)return 0;var r=t.split(","),n=r?r.map(function(t){return t.trim()}):[],o=n.reduce(function(t,r){var n=e.find(function(t){return t.id_rent===r});return n||console.log("Acessory ".concat(r," not found")),t+=n?dt(n.type,n.value,s):0,t},0);return Number(o)},ft=function(t,e){try{if(isNaN(+e))throw new TypeError("")}catch(r){console.log(r)}if(t<=0)return 0;var s=L.getters.customers.find(function(t){return t.id_rent===e});return s?Math.round(s.sale/100*t):0};function _t(t){var e=L.getters.products.find(function(e){return e.id_rent===t.product_id});if(e)return e.status="free",e}var pt={stopSubOrder:function(t,e,s){var r=[];e.end_time="PAUSE"===e.status?e.pause_start:P()();var n=function(){var s=e.end_time-Date.parse(t.start_time)-e.pause_time;return at(ut(e.tariff_id,s))};e.bill_rent=n(),e.bill_access=e.accessories?lt(e.accessories,this.$store.getters.accessories,e.bill_rent):0,e.sale=ft(+e.bill_rent+ +e.bill_access,+t.customer_id),console.log(e.sale),e.status="END",r.push({cmd:"changeSubOrder",value:e});var o=_t(e);r.push({cmd:"setProduct",value:o});var i=this.$store.getters.subOrders.filter(function(t){return t.order_id===e.order_id&&("ACTIVE"===t.status||"PAUSE"===t.status)});0===i.length&&(t.status="END",r.push({cmd:"changeOrder",value:t})),s&&this.$store.dispatch("send",r)}},ht={props:{_order:Object,_subOrder:Object},data:function(){return{order:{},subOrder:{},cmds:[],productNames:[]}},created:function(){var t=this;this.order=this._order,this.subOrder=this._subOrder,this.productNames=this.subOrders.reduce(function(e,s){var r=t.$store.getters.products.find(function(t){return t.id_rent===s.product_id});return e[r.id_rent]=r.name,e},{}),"PAUSE"==this.subOrder.status&&ct(this.subOrder)},methods:Object(nt["a"])({},pt,{isLast:function(){return!this.subOrders.find(function(t){return"ACTIVE"===t.status||"PAUSE"===t.status})},close:function(){this.$emit("close")},pay:function(t){"money"===t&&(this.subOrder.paid=!0),"card"===t&&(this.subOrder.paid=!0),"dont pay"===t&&(this.subOrder.paid=!1),this.cmds.push({cmd:"stopOrder",value:this.subOrder}),this.$store.dispatch("send",this.cmds),this.close()}}),computed:{billRent:function(){return this.isLast()?this.subOrders.reduce(function(t,e){return t+=+e.bill_rent+ +e.bill_access,t},0):+this.subOrder.bill_rent+this.subOrder.bill_access},paidBefore:function(){return this.subOrders?this.subOrders.reduce(function(t,e){return 1==e.paid&&(t+=+e.bill_access+ +e.bill_rent),t},0):0},saledBefore:function(){return this.subOrders?this.subOrders.reduce(function(t,e){return 1==e.paid&&(t+=+e.sale),t},0):0},sale:function(){return this.isLast()?this.subOrders.reduce(function(t,e){return t+=+e.sale,t},0):+this.subOrder.sale},advance:function(){return this.isLast()?this.order.advance:0},total:function(){return this.isLast?at(this.billRent-this.paidBefore-(this.sale-this.saledBefore))-+this.advance:this.billRent-this.sale},customer:function(){var t=this;return this.$store.getters.customers.find(function(e){return e.id_rent==t.order.customer_id})},accessories:function(){var t=this;if(!this.subOrder.accessories)return null;var e=this.subOrder.accessories.split(",");return e.map(function(e){return t.$store.getters.accessories.find(function(t){return t.id_rent==e})})},activeTime:function(){var t=Date.parse(this.order.start_time),e=this.subOrder.end_time,s=this.subOrder.pause_time?this.subOrder.pause_time:0,r=e-t-s;return it(r)},deposit:function(){var t=this;return this.$store.getters.deposits.find(function(e){return e.id_rent===+t.order.deposit})},subOrders:function(){var t=this;return this.$store.getters.subOrders.filter(function(e){return e.order_id==t.order.order_id&&"DEL"!==e.status})}}},vt=ht,mt=(s("5c2c"),Object(d["a"])(vt,st,rt,!1,null,"7124d5c6",null));mt.options.__file="Resume.vue";var gt=mt.exports,bt={components:{Bike:K,Photo:et,Resume:gt},data:function(){return{modal:!1,product:{}}},methods:{onClick:function(t){this.$emit("addOrder",t)},openPhoto:function(t){this.modal=!0,this.product=t},closePhoto:function(){this.modal=!1,this.product={}}},computed:{products:function(){var t=this.$store.getters.products;return t?t.filter(function(t){return"free"==t.status}):[]}}},Ct=bt,Ot=(s("91c4"),Object(d["a"])(Ct,z,V,!1,null,"2817cba4",null));Ot.options.__file="product-list.vue";var wt=Ot.exports,yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-list"},[s("h3",[t._v("В прокате "),t.countActiveSubOrders?s("span",[t._v("("+t._s(t.countActiveSubOrders)+")")]):t._e()]),0==t.orders.length?s("p",{staticClass:"empty"},[t._v("Ативные ордера отсутствуют")]):t._e(),s("table",{staticClass:"table",attrs:{cellspacing:"0"}},t._l(t.orders,function(e){return t.subOrders[e.order_id]?s("tr",{key:e.order_id,staticClass:"table-tr",attrs:{title:e.title}},[s("td",{staticClass:"td-1"},[s("Icon",{attrs:{id:e.order_id_position,show:!0}})],1),s("td",{staticClass:"td-2"},[t._v(t._s(e.format_start_time))]),s("td",t._l(t.subOrders[e.order_id],function(r){return s("tr",{key:r.id_rent,staticClass:"product-tr",class:"PAUSE"===r.status?"suborder--pause":"suborder--active"},[s("td",{staticClass:"td-3",on:{click:function(s){t.toChange(e,r)}}},[t._v(t._s(r.product_name))]),s("td",{staticClass:"td-4",on:{click:function(s){t.toChange(e,r)}}},[t._v(t._s(t.getTimePlay(e,r)))]),s("td",{staticClass:"td-5",on:{click:function(s){t.toChange(e,r)}}},[t._v("\n                        "+t._s(t.getBillWrap(e,r))+" р\n                    ")])])}),0),s("td",{staticClass:"td-6 td-6-1"},[s("i",{staticClass:"icon far fa-pause-circle",on:{click:function(s){t.pauseOrder(e)}}})]),s("td",{staticClass:"td-7"},[s("i",{staticClass:"icon far fa-stop-circle",on:{click:function(s){t.stopOrder(e)}}})])]):t._e()}),0),t.showDetails?s("DetailsOrder",{attrs:{dataOrder:t.order,dataSubOrder:t.subOrder},on:{close:t.closeDetails,openResume:function(e){t.openResume(e)}}}):t._e(),t.showResume?s("Resume",{attrs:{_order:t.order,_subOrder:t.subOrder},on:{close:t.onClose}}):t._e()],1)},kt=[],$t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"add-order details"},[s("h3",[t._v("Детали заказа"),s("span",[t._v(" - #"+t._s(t.order.order_id)+" / "+t._s(t.subOrder.id_rent))])]),s("form",{on:{submit:function(t){t.preventDefault()}}},[s("table",[s("tr",[s("td",[t._v("Товар")]),s("td",[t._v(t._s(t.product.name))])]),s("tr",[s("td",[t._v("ID заказа")]),s("td",[s("Position",{attrs:{position:t.getPosition()},on:{setPosition:function(e){t.setPosition(e)}}})],1)]),s("tr",[s("td",[t._v("Статус")]),s("td",[t._v("\n                        "+t._s(t.subOrder.status)+"\n                    ")])]),s("tr",[s("td",[t._v("Аванс")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.order.advance,expression:"order.advance"}],staticClass:"add-order__input add-order__input--advance",attrs:{placeholder:"0 руб"},domProps:{value:t.order.advance},on:{input:function(e){e.target.composing||t.$set(t.order,"advance",e.target.value)}}})])]),s("tr",[s("td",[t._v("Клиент")]),s("td",[s("SelectCustomer",{attrs:{customer:t.order.customer_id},on:{setCustomer:function(e){t.setCustomer(e)}}})],1)]),s("tr",[s("td",[t._v("Залог")]),s("td",[s("SelectDeposit",{attrs:{deposit:t.order.deposit},on:{setDeposit:function(e){t.setDeposit(e)}}})],1)]),s("tr",[s("td",[t._v("Примечание")]),s("td",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.order.note,expression:"order.note"}],staticClass:"add-order__input add-order__input--note",attrs:{cols:"30",rows:"3"},domProps:{value:t.order.note},on:{input:function(e){e.target.composing||t.$set(t.order,"note",e.target.value)}}})])]),s("tr",[s("td",[t._v("Акция")]),s("td",[s("SelectPromotion",{attrs:{promotion:t.order.promotion},on:{setPromotion:function(e){t.setPromotion(e)}}})],1)]),s("tr",[s("td",[t._v("Аксессуары")]),s("td",[s("SelectAccessories",{attrs:{accessory:t.subOrder.accessories},on:{setAccessories:function(e){t.setAccessories(e)}}})],1)]),s("tr",[s("td",[t._v("Тарифный план")]),s("td",[s("SelectTariff",{attrs:{"data-tariffs":t.tariffs,"data-tariff-default":t.subOrder.tariff_id?t.subOrder.tariff_id:t.product.tariff_default},on:{setTariff:function(e){t.setTariff(e)}}})],1)])]),s("div",{staticClass:"btn-group"},[s("button",{staticClass:"change-order__button",on:{click:t.toPrint}},[t._v("\n                    Печать\n                ")]),s("button",{staticClass:"change-order__button",on:{click:function(e){return e.preventDefault(),t.save(e)}}},[t._v("\n                    Сохранить                        \n                ")]),s("button",{staticClass:"change-order__button",on:{click:function(e){return e.preventDefault(),t.abortSubOrder(e)}}},[t._v("\n                    Удалить товар\n                ")]),s("button",{staticClass:"change-order__button",on:{click:function(e){e.preventDefault(),t.stop()}}},[t._v("\n                    Стоп\n                ")]),s("button",{staticClass:"change-order__button",on:{click:function(e){e.preventDefault(),t.pauseSubOrder()}}},[t._v("\n                    Пауза\n                ")])]),s("button",{staticClass:"details__close",on:{click:function(e){return e.preventDefault(),t.close(e)}}})]),t.print?s("Print",{attrs:{order:t.order},on:{close:t.closePrint}}):t._e(),t.showResume?s("Resume",{attrs:{_order:t.order,_subOrder:t.subOrder},on:{close:t.closeResume}}):t._e()],1)])},Tt=[],Pt={getOrderId:function(){return Math.max.apply(Math,Object(g["a"])(this.$store.getters.history.map(function(t){return+t.order_id})).concat([0]))+1}},St=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"customer-id"},[t.open?s("div",{staticClass:"btns"},t._l(t.btns,function(e,r){return s("div",{key:r,staticClass:"btn",on:{click:function(s){t.onClick(e,r)}}},[s("Icon",{attrs:{id:r,show:t.select==r||"number"==typeof e.position,select:t.select==r}})],1)}),0):s("div",{staticClass:"btn",on:{click:function(e){t.open=!0}}},[s("Icon",{attrs:{id:t.select,show:!0,select:!1}})],1)])},xt=[],At=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"icon-wrap"},[s("div",{staticClass:"icon",class:t.iconClass},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.select,expression:"select"}],staticClass:"outline"}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.show,expression:"!show"}],staticClass:"fill"})])])},Et=[],Dt={props:{id:null,show:null,select:null},data:function(){return{}},computed:{iconClass:function(){return"d"+this.id}}},It=Dt,Nt=(s("e637"),Object(d["a"])(It,At,Et,!1,null,"dcde19b0",null));Nt.options.__file="Icon.vue";var jt=Nt.exports,Rt={props:{position:null},components:{Icon:jt},data:function(){return{open:!1,select:this.position,selectIcon:"d"+this.position}},methods:Object(nt["a"])({},Pt,{onClick:function(t,e){var s=t.order_id;this.select=e,this.selectIcon=t.class,this.$emit("setPosition",{order_id:s,order_id_position:e}),this.open=!1}}),computed:{btns:function(){var t=[],e=this.$store.getters.orders,s=this.getOrderId("new"),r=function r(n){var o=e.find(function(t){return t.order_id_position==n});return t[n]={position:o?n:null,order_id:o?o.order_id:s,class:"d"+n},n<1?t:r(n-1)};return r(15)}}},Ut=Rt,Mt=(s("95a6"),Object(d["a"])(Ut,St,xt,!1,null,null,null));Mt.options.__file="idPosition.vue";var Lt=Mt.exports,Ht=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("multiselect",{ref:"vms",attrs:{"deselect-label":"","track-by":"fname",label:"fname",placeholder:"...","custom-label":t.fullName,options:t.options,searchable:!0,"allow-empty":!1},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},Bt=[],zt=s("8e5f"),Vt=s.n(zt),qt={props:{customer:null,focus:Boolean},components:{Multiselect:Vt.a},mounted:function(){this.focus&&this.$refs.vms.$el.focus()},data:function(){var t=this;return{value:this.$store.getters.customers.find(function(e){return e.id_rent==t.customer}),options:this.$store.getters.customers}},methods:{fullName:function(t){var e=t.fname,s=t.sname,r=t.tname;return"".concat(e," ").concat(s," ").concat(r)}},watch:{customer:function(){var t=this;this.value=this.customer?this.$store.getters.customers.find(function(e){return e.id_rent==t.customer}):null},value:function(){this.$emit("setCustomer",this.value),this.value||console.log("empty value")}}},Gt=qt,Jt=(s("60bc"),s("d93b"),Object(d["a"])(Gt,Ht,Bt,!1,null,null,null));Jt.options.__file="SelectCustomer.vue";var Ft=Jt.exports,Qt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!0,"clear-on-select":!1,"hide-selected":!0,"preserve-search":!0,placeholder:"...",label:"name","track-by":"name","preselect-first":!1},scopedSlots:t._u([{key:"tag",fn:function(e){return[s("span",{staticClass:"custom__tag"},[s("span",[t._v(t._s(e.option.name)+" "+t._s(e.option.value)+t._s(e.option.type))]),s("span",{staticClass:"custom__remove",on:{click:function(t){e.remove(e.option)}}},[t._v("❌")])])]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},Kt=[],Wt={components:{Multiselect:Vt.a},props:{accessory:null},data:function(){return{value:this.split(this.accessory),options:this.$store.getters.accessories}},methods:{split:function(t){var e=this;if(!t)return[];var s=t.split(",");return s.map(function(t){return e.$store.getters.accessories.find(function(e){return e.id_rent==t})})},type:function(t){return"%"==t?"%":"p."}},watch:{value:function(){this.$emit("setAccessories",this.value.map(function(t){return t.id_rent}).join())}}},Yt=Wt,Xt=(s("6d04"),Object(d["a"])(Yt,Qt,Kt,!1,null,null,null));Xt.options.__file="SelectAccessories.vue";var Zt=Xt.exports,te=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("multiselect",{attrs:{"deselect-label":"","track-by":"name",label:"name",placeholder:"Выбрать",options:t.options,searchable:!1,"allow-empty":!1},scopedSlots:t._u([{key:"singleLabel",fn:function(e){var r=e.option;return[s("strong",[t._v(t._s(r.name))])]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},ee=[],se={props:{dataTariffs:{type:Array,required:!0},dataTariffDefault:null},components:{Multiselect:Vt.a},created:function(){console.log(this.dataTariffs,this.dataTariffDefault)},data:function(){var t=this;return{value:this.dataTariffDefault?this.dataTariffs.find(function(e){return e.id_rent==t.dataTariffDefault}):null,options:this.dataTariffs?this.dataTariffs:[]}},watch:{value:function(){this.$emit("setTariff",this.value)}}},re=se,ne=Object(d["a"])(re,te,ee,!1,null,null,null);ne.options.__file="SelectTariff.vue";var oe=ne.exports,ie=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("multiselect",{attrs:{label:"name",options:t.options,searchable:!1,"close-on-select":!0,"show-labels":!1,placeholder:"..."},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},ae=[],ce={props:{promotion:null},components:{Multiselect:Vt.a},data:function(){var t=this;return{value:this.$store.getters.promotions.find(function(e){return e.id==t.promotion}),options:this.$store.getters.promotions}},watch:{promotion:function(){var t=this;this.value=this.$store.getters.promotions.find(function(e){return e.id==t.promotion})},value:function(){this.$emit("setPromotion",this.value)}}},ue=ce,de=Object(d["a"])(ue,ie,ae,!1,null,null,null);de.options.__file="SelectPromotion.vue";var le=de.exports,fe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("multiselect",{attrs:{label:"name",options:t.options,searchable:!1,"close-on-select":!0,"show-labels":!1,placeholder:"..."},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},_e=[],pe={props:{deposit:null},components:{Multiselect:Vt.a},data:function(){var t=this;return{value:this.$store.getters.deposits.find(function(e){return e.id_rent==t.deposit}),options:this.$store.getters.deposits}},watch:{deposit:function(){var t=this;this.value=this.$store.getters.deposits.find(function(e){return e.id_rent==t.deposit})},value:function(){this.$emit("setDeposit",this.value)}}},he=pe,ve=Object(d["a"])(he,fe,_e,!1,null,null,null);ve.options.__file="SelectDeposit.vue";var me=ve.exports,ge=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"print"},[s("div",{staticClass:"print__page"},[s("h2",{staticClass:"print__title"},[t._v("Договор  проката №  "+t._s(t.order.order_id))]),s("p",{staticClass:"print__p print__p--date"},[s("span",[t._v("г. Армавир")]),s("span",{staticClass:"print__date"},[t._v(t._s(t.date))])]),s("p",{staticClass:"print__p"},[t._v("\n                Индивидуальный предприниматель Колтыков Анатолий Владимирович именуемый в дальнейшем "),s("b",[t._v("«Арендодатель»")]),t._v(", действующий на основании свидетельства о государственной регистрации физического лица в качестве индивидуального предпринимателя серия 23 №008878961, с одной стороны и "),s("span",{staticClass:"print__renter"},[t._v(t._s(t.renter))]),t._v(", именуемый в дальнейшем "),s("b",[t._v("«Арендатор»")]),t._v(", с другой стороны, в соответствии с требованиями статей 626-631 ГК РФ, заключили настоящий договор о нижеследующем:\n            ")]),s("h3",{staticClass:"print__caption"},[t._v("1. Предмет Договора")]),s("p",{staticClass:"print__p"},[t._v("\n                1.1. Арендодатель сдает в прокат (во временное пользование за плату) имущество: "+t._s(t.products_name)+" в полной исправности, оцениваемое в сумме "+t._s(t.products_cost)+" рублей."),s("br"),t._v("\n                1.2. Дата и время передачи имущества в аренду: "+t._s(t.order.start_time)),s("br"),t._v("\n                1.3. Залоговый документ: "+t._s(t.deposit)),s("br"),t._v("\n                1.4. Арендатор принимает в прокат Имущество и оплачивает его в соответствии с условиями настоящего Договора. Сдача Имущества в прокат не влечет за собой передачи права собственности на него."),s("br")]),s("h3",{staticClass:"print__caption"},[t._v("2. Права и обязанности  арендодателя")]),t._m(0),s("h3",{staticClass:"print__caption"},[t._v("3. Права И Обязанности  Арендатора")]),t._m(1),s("h3",{staticClass:"print__caption"},[t._v("4. Заключительные  Условия")]),t._m(2),s("h3",{staticClass:"print__caption"},[t._v("5. Согласие На Обработку Персональных Данных")]),t._m(3),s("h3",{staticClass:"print__caption"},[t._v("6. Реквизиты  и  Подписи  Сторон")]),s("p",{staticClass:"print__p"},[s("table",{staticClass:"print__p--info"},[s("tr",[t._m(4),s("td",[t._v("\n                            Арендатор: "+t._s(t.renter)),s("br"),t._v("\n                            Паспорт: "+t._s(t.passport)),s("br"),t._v("\n                            Место жительства: "+t._s(t.address)),s("br"),t._v("\n                            Телефон: "+t._s(t.phone)+"\n                        ")])]),s("tr",[s("td",[t._v("\n                            АРЕНДОДАТЕЛЬ"),s("br"),t._v("\n                            _______________/ ИП Колтыков А.В./"),s("br"),t._v("\n                            "+t._s(t.date)+"    \n                        ")]),s("td",[t._v("\n                            АРЕНДАТОР"),s("br"),t._v("\n                            ___________ /"+t._s(t.renter_small)+" /"),s("br"),t._v("\n                            "+t._s(t.date)+"                                \n                        ")])])])])])])])},be=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"print__p"},[t._v("\n                2.1. Арендодатель принимает на себя обязательства:"),s("br"),t._v("\n                2.1.1. Передать в прокат Арендатору Имущество надлежащего качества, в техническом состоянии, позволяющем беспрепятственно использовать его в соответствии с целевым назначением в течении всего периода действия настоящего Договора. "),s("br"),t._v("\n                2.1.2. В присутствии Арендатора проверить работоспособность Имущества."),s("br"),t._v(" \n                2.1.3. Ознакомить Арендатора с правилами использования и содержания Имущества и предоставить Арендатору инструкцию по надлежащему использованию Имущества в соответствии с целевым назначением, а также по надлежащему содержанию и обслуживанию Имущества."),s("br"),t._v(" \n                2.1.4.  Не передавать личные и паспортные данные Арендатора третьим лицам."),s("br"),t._v("\n                2.2. В случае выявления в процессе приемки Арендатором недостатков качества Имущества, возникших не по вине Арендатора, полностью или частично препятствующих его использованию в соответствии с целевым назначением,  безвозмездно устранить выявленные недостатки или заменить его на Имущество, соответствующее требованиям пункта 2.1. настоящего Договора"),s("br"),t._v("\n                2.3. Арендодатель не несет ответственности за вред, который может быть нанесен здоровью людей, а также за материальный ущерб, который может понести Арендатор в ходе эксплуатации Имущества\n            ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"print__p"},[t._v("\n                Арендатор принимает на себя обязательства:"),s("br"),t._v("\n                3.1. Оплатить Арендодателю стоимость проката Имущества в соответствии с условиями настоящего Договора."),s("br"),t._v(" \n                3.2. Использовать Имущество в соответствии с целевым назначением, осуществлять надлежащий уход, обслуживание и содержание Имущества в соответствии с полученными от Арендодателя инструкциями в течении всего срока проката."),s("br"),t._v("\n                3.3. Возвратить Имущество Арендодателю в установленный настоящим Договором срок, без неисправностей, повреждений внешнего вида и в чистом состоянии, пригодном для использования в соответствии с целевым назначением."),s("br"),t._v("\n                3.4. Немедленно уведомлять Арендодателя обо всех случаях причинения какого-либо ущерба или разрушения Имущества с описанием характера повреждений и с указанием причин их возникновения."),s("br"),t._v("\n                3.5. В случае возникновения повреждений внешнего вида и неисправности Имущества по вине Арендатора, возместить Арендодателю расходы по ремонту или замене Имущества."),s("br"),t._v(" \n                3.6.  При желании продлить срок аренды Имущества, Арендатор обязан за сутки до истечения этого срока уведомить Арендодателя о своем намерении по телефону указанном в п.6. настоящего Договора. В противном случае, Имущество считается возвращенным не вовремя."),s("br"),t._v("\n                3.7. В случае окончании срока аренды, и не возврата Имущества по вине Арендатора, Арендатору назначается плата за следующую неделю аренды Имущества согласно тарифу проката на данное Имущество и пеню в размере 20% от общей суммы проката\n            ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"print__p"},[t._v("\n                4.1. Настоящий Договор составлен в двух экземплярах, один из которых остается у арендодателя, второй выдается арендатору."),s("br"),t._v("\n                4.2. Настоящий Договор вступает в законную силу с момента подписания и действует до 31 декабря текущего года. "),s("br"),t._v("\n                4.3. Отношения между Арендодателем и Арендатором, не предусмотренные положениями настоящего Договора, регламентируются действующим гражданским законодательством Российской Федерации."),s("br")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"print__p"},[t._v('\n                5.1. Согласно Федерального закона № 152 ( ред. от 29.07.2017) "О персональных данных" подписывая настоящий Договор Арендатор дает согласие на обработку и хранение персональных данных в целях обеспечения соблюдения законов и иных нормативных правовых актов.'),s("br"),t._v('\n                5.2 Согласно п. 5 ст. 6 Федерального закона № 152 ( ред. от 29.07.2017) "О персональных данных" обработка и хранение персональных данных необходима для исполнения настоящего Договора'),s("br")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",[t._v("\n                            Арендодатель: ИП Колтыков Анатолий Владимирович"),s("br"),t._v("\n                            ИНН: 230214171784"),s("br"),t._v("\n                            ОГРНИП: 314237201600076"),s("br"),t._v("\n                            Адрес: г.Армавир, ул.Луначарского, д.222"),s("br"),t._v("\n                            Телефон: +7 (918) 941-34-34, +7 (903) 410-44-94\n                        ")])}],Ce={props:{order:Object},mounted:function(){this.print()},methods:{close:function(){this.$emit("close")},print:function(){window.print(),this.close()}},computed:{date:function(){var t=this.order.start_time,e=t.slice(0,4),s=t.slice(5,7),r=t.slice(8,10);return"".concat(r,".").concat(s,".").concat(e," г.")},renter:function(){return this.order.customer_name?this.order.customer_name:"_______________________"},passport:function(){return this.customer?this.customer.passport:""},address:function(){return this.customer?this.customer.address:""},phone:function(){return this.customer?this.customer.phone:""},renter_small:function(){if(!this.customer)return"_______________________";var t=this.customer.fname,e=this.customer.sname?this.customer.sname[0]+".":"",s=this.customer.tname?this.customer.tname[0]+".":"";return"".concat(t," ").concat(e," ").concat(s)},products:function(){var t=this,e=this.$store.getters.orderProducts.filter(function(e){return e.order_id==t.order.order_id}),s=e.map(function(e){return t.$store.getters.products.find(function(t){return t.id_rent==e.product_id})});return s},products_name:function(){var t=this;return this.products.reduce(function(e,s){return e+="".concat(s.name," (").concat(t.products_cost," руб.), "),e},"")},products_cost:function(){return this.products.reduce(function(t,e){return t+=+e.cost,t},0)},customer:function(){var t=this;return this.$store.getters.customers.find(function(e){return e.id_rent==t.order.customer_id})},deposit:function(){var t=this,e=this.$store.getters.deposits.find(function(e){return e.id_rent==t.order.deposit});return e?e.name:"______________"}}},Oe=Ce,we=(s("d241"),Object(d["a"])(Oe,ge,be,!1,null,null,null));we.options.__file="Print.vue";var ye=we.exports,ke={props:{dataOrder:Object,dataSubOrder:Object},components:{Position:Lt,SelectCustomer:Ft,SelectAccessories:Zt,SelectTariff:oe,SelectPromotion:le,SelectDeposit:me,Print:ye,Resume:gt},data:function(){return{order:{},subOrder:{},product:{},orders:this.$store.getters.orders,products:this.$store.getters.products,status:{changeOrder:!1,changeSubOrder:!1,splitOrder:!1},print:!1,showResume:!1}},created:function(){var t=this;this.order=this.dataOrder,this.subOrder=this.dataSubOrder,this.product=this.products.find(function(e){return e.id_rent==t.dataSubOrder.product_id})},methods:Object(nt["a"])({},Pt,pt,{close:function(){this.$emit("close")},save:function(){this.status.changeOrder&&(console.log("changeOrder"),this.$store.dispatch("send",[{cmd:"changeOrder",value:this.order}])),this.status.changeSubOrder&&!this.status.splitOrder&&(console.log("ChangeSubOrder"),this.$store.dispatch("send",[{cmd:"changeOrderProduct",value:this.subOrder}])),this.status.splitOrder&&(console.log("splitOrder"),this.$store.dispatch("send",[{cmd:"splitOrder",value:{order:this.order,subOrder:this.subOrder}}])),this.close()},toPrint:function(){this.print=!0},closePrint:function(){this.print=!1},closeResume:function(){this.showResume=!1,this.close()},abortSubOrder:function(){var t=this.subOrder,e=this.order,s="Почему Вы хотите удалить этот товар?",r="Причина удаления",n=prompt(s,r);if(n){var o=[];t.note=n,t.status="DEL",t.end_time=Math.floor(P()()/1e3),t.pause_start=Date.parse(t.pause_start)/1e3,o.push({cmd:"changeSubOrder",value:t}),this.subOrders.length<1&&(e.status="DEL",o.push({cmd:"changeOrder",value:e})),this.product.status="free",this.product.updated=Date.parse(this.product.updated)/1e3,o.push({cmd:"setProduct",value:this.product}),this.$store.dispatch("send",o),this.$emit("close")}},stop:function(){this.stopSubOrder(this.order,this.subOrder),this.showResume=!0},pauseSubOrder:function(){ct(this.subOrder),this.$store.dispatch("send",{cmd:"changeSubOrder",value:this.subOrder})},getPosition:function(){if(this.order.order_id_position)return this.order.order_id_position},splitOrder:function(t,e){var s=this.order,r=this.subOrder;this.status.splitOrder=!0,s.old_id=this.order.order_id,s.order_id=t,s.start_time=Date.parse(this.order.start_time),s.order_id_position=e,this.order=s,this.subOrder=r},setPosition:function(t){var e=t.order_id,s=t.order_id_position;this.orders.find(function(t){return t.order_id==e})||(this.status.splitOrder=!0,this.splitOrder(e,s))},setCustomer:function(t){this.order.customer_id=t.id_rent,this.order.customer_name="".concat(t.fname," ").concat(t.sname," ").concat(t.tname),this.status.changeOrder=!0},setDeposit:function(t){this.order.deposit=t.id_rent,this.status.changeOrder=!0},setPromotion:function(t){t&&(this.order.promotion=t.id,this.status.changeOrder=!0)},setAccessories:function(t){this.subOrder.accessories=t,this.status.changeSubOrder=!0},setTariff:function(t){this.subOrder.tariff_id=t.id_rent,this.status.changeSubOrder=!0,this.status.changeSubOrder=!0}}),computed:{customers:function(){return this.$store.getters.customers},deposits:function(){return this.$store.getters.depositList},promotions:function(){return this.$store.getters.promotions},accessories:function(){return this.$store.getters.accessories},tariffs:function(){var t=this;if(this.product.id_rent){var e=this.product.tariff_ids.split(",");return e.map(function(e){return t.$store.getters.tariffs.find(function(t){return t.id_rent===e})})}},subOrders:function(){var t=this;return this.$store.getters.subOrders.filter(function(e){return e.order_id===t.subOrder.order_id&&("ACTIVE"===e.status||"PAUSE"===e.status)})},activeSubOrders:function(){return this.subOrders.filter(function(t){return"ACTIVE"===t.status})}}},$e=ke,Te=(s("7f79"),Object(d["a"])($e,$t,Tt,!1,null,null,null));Te.options.__file="DetailsChangeOrder.vue";var Pe=Te.exports,Se={components:{Resume:gt,DetailsOrder:Pe,Icon:jt},data:function(){return{order:null,subOrder:null,showDetails:!1,showResume:!1}},methods:Object(nt["a"])({},pt,{toChange:function(t,e){this.order=t,this.subOrder=e,this.showDetails=!0},openResume:function(t){this.order=t.order,this.subOrder=t.subOrder,this.showResume=!0},closeDetails:function(){this.subOrder=null,this.order=null,this.showDetails=!1},getStartTime:function(t){if(!t)return"";var e=function(t){return t<10?"0".concat(t):"".concat(t)},s=new Date,r=e(s.getFullYear()),n=e(s.getMonth()+1),o=e(s.getDate()),i=new Date(t),a=e(i.getFullYear()),c=e(i.getMonth()+1),u=e(i.getDate()),d=e(i.getHours()),l=e(i.getMinutes());return o==u&&n==+c&&r==a?"".concat(d,":").concat(l):"".concat(u,".").concat(c,".").concat(a," \n ").concat(d,":").concat(l)},getTimePlay:function(t,e){var s=Date.parse(t.start_time),r=this.$store.getters.now,n=e.pause_time,o=r-s;if("ACTIVE"==e.status&&o&&n)return it(o-n);if("PAUSE"==e.status){var i=P()()-+e.pause_start,a=+e.pause_time+i;if(o&&a)return it(o-a)}return"END"==e.status?it(Date.parse(e.end_time)-s-n):void 0},getBillWrap:function(t,e){var s;"ACTIVE"==e.status&&(s=P()()-Date.parse(t.start_time)-e.pause_time),"PAUSE"==e.status&&(s=e.pause_start-Date.parse(t.start_time)),"END"==e.status&&(s=Date.parse(e.end_time)-Date.parse(t.start_time));var r=ut(e.tariff_id,s),n=lt(e.accessories,this.$store.getters.accessories,r),o=ft(r+n,+t.customer_id);return at(r+n-o)},pauseOrder:function(t){var e=this.$store.getters.subOrders.filter(function(e){return e.order_id===t.order_id});if(0!==e.length){var s=e.filter(function(t){return"ACTIVE"===t.status}),r=e.filter(function(t){return"PAUSE"===t.status}),n=function(){return s.map(function(t){return ct(t),{cmd:"changeSubOrder",value:t}})},o=function(){return r.map(function(t){return ct(t),{cmd:"changeSubOrder",value:t}})},i=s.length?n():o();this.$store.dispatch("send",i)}},stopOrder:function(t){for(var e=this.getSubOrders(t.order_id),s=e.length-1;s>=0;s--)this.stopSubOrder(t,e[s],!0);this.order=t,this.subOrder=e[0],this.showResume=!0},onClose:function(){this.order=null,this.showResume=!1},getSubOrders:function(t){return this.$store.getters.subOrders.filter(function(e){return e.order_id===t&&("ACTIVE"===e.status||"PAUSE"===e.status)})},getTitle:function(t){var e=this.$store.getters.customers,s=e.find(function(e){return e.id_rent==t.customer_id}),r=t.note?t.note:"";return s?"".concat(s.fname," ").concat(s.sname[0],". ").concat(s.tname[0],". ").concat(s.phone," "):"".concat(r)},getProductName:function(t){var e=this.$store.getters.products.find(function(e){return e.id_rent==t});return e.name}}),computed:{orders:function(){var t=this;return this.$store.getters.orders.reduce(function(e,s){return s.format_start_time=t.getStartTime(s.start_time),s.title=t.getTitle(s),e[s.order_id]=s,e},{})},subOrders:function(){var t=this,e=function(e){return!(!t.orders[e.order_id]||"ACTIVE"!==e.status&&"PAUSE"!==e.status)};return this.$store.getters.subOrders.reduce(function(s,r){return e(r)?(r.product_name=t.getProductName(r.product_id),s[r.order_id]?s[r.order_id].push(r):s[r.order_id]=[r],s):s},{})},countActiveSubOrders:function(){var t=0;for(var e in this.subOrders)t+=this.subOrders[e].length;return t},products:function(){return this.$store.getters.products}}},xe=Se,Ae=(s("0bda"),Object(d["a"])(xe,yt,kt,!1,null,"49607fc3",null));Ae.options.__file="order-list.vue";var Ee=Ae.exports,De=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"add-order details"},[s("h3",["newOrder"===t.status?s("span",[t._v("Новый заказ #"+t._s(t.order.order_id))]):s("span",[t._v("Добавить товар к заказу #"+t._s(t.order.order_id))])]),s("form",{on:{submit:function(t){t.preventDefault()}}},[s("table",[s("tr",[s("td",[t._v("Товар")]),s("td",[t._v(t._s(t.product.name))])]),s("tr",[s("td",[t._v("ID заказа")]),s("td",[s("Position",{attrs:{position:t.getPosition()},on:{setPosition:function(e){t.setPosition(e)}}})],1)]),s("tr",[s("td",[t._v("Аванс")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.order.advance,expression:"order.advance"}],staticClass:"add-order__input add-order__input--advance",attrs:{placeholder:"0 руб"},domProps:{value:t.order.advance},on:{input:function(e){e.target.composing||t.$set(t.order,"advance",e.target.value)}}})])]),s("tr",[s("td",{staticClass:"customer"},[t._v("Клиент")]),s("td",[s("SelectCustomer",{attrs:{id:"select_customer",customer:t.order.customer_id,focus:!t.order.customer_id},on:{setCustomer:function(e){t.setCustomer(e)}}})],1)]),s("tr",[s("td",[t._v("Залог")]),s("td",[s("SelectDeposit",{attrs:{deposit:t.order.deposit},on:{setDeposit:function(e){t.setDeposit(e)}}})],1)]),s("tr",[s("td",[t._v("Примечание")]),s("td",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.order.note,expression:"order.note"}],staticClass:"add-order__input add-order__input--note",attrs:{cols:"30",rows:"3"},domProps:{value:t.order.note},on:{input:function(e){e.target.composing||t.$set(t.order,"note",e.target.value)}}})])]),s("tr",[s("td",[t._v("Акция")]),s("td",[s("SelectPromotion",{attrs:{promotion:t.order.promotion},on:{setPromotion:function(e){t.setPromotion(e)}}})],1)]),s("tr",[s("td",[t._v("Аксессуары")]),s("td",[s("SelectAccessories",{attrs:{accessory:t.subOrder.accessories},on:{setAccessories:function(e){t.setAccessories(e)}}})],1)]),s("tr",[s("td",[t._v("Тарифный план")]),s("td",[s("SelectTariff",{attrs:{"data-tariffs":t.tariffs,"data-tariff-default":t.subOrder.tariff_id?t.subOrder.tariff_id:t.product.tariff_default},on:{setTariff:function(e){t.setTariff(e)}}})],1)])]),s("div",{staticClass:"btn-group"},[s("button",{on:{click:function(e){return e.preventDefault(),t.save(e)}}},[t._v("Сохранить")]),s("button",{attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.close(e)}}},[t._v("Отмена")])])])])])},Ie=[],Ne={getSubOrderId:function(){return Math.max.apply(Math,Object(g["a"])(this.$store.getters.subOrders.map(function(t){return+t.id_rent})).concat([0]))+1}},je=s("f499"),Re=s.n(je),Ue=function(t){return t?JSON.parse(Re()(t)):null};function Me(){var t={status:null,start_time:null,order_id:null,order_id_position:null,advance:null,note:null,products:null,promotion:null,customer_id:null,deposit:null};return t}var Le={props:{product:Object},components:{Position:Lt,SelectCustomer:Ft,SelectAccessories:Zt,SelectTariff:oe,SelectPromotion:le,SelectDeposit:me},data:function(){return{order:{status:null,start_time:null,order_id:null,order_id_position:null,advance:null,note:null,products:null,promotion:null,customer_id:null,deposit:null},subOrder:{id_rent:null,order_id:null,product_id:null,tariff_id:null,accessories:null,bill:0,bill_rent:0,bill_access:0,sale:0,paid:!1,pause_start:0,pause_time:0,end_time:null,note:null,status:null},status:null}},created:function(){this.isSerial()?this.addSubOrder(this.getLastId()):this.newOrder()},methods:Object(nt["a"])({},Pt,Ne,{close:function(){this.$emit("close")},save:function(){if(console.log("order: ",this.order,"subOrder: ",this.subOrder),"newOrder"==this.status){var t={lastOrderTime:P()(),lastOrderID:this.order.order_id};this.$store.dispatch("send",[{cmd:"newOrder",value:this.order},{cmd:"addOrderProduct",value:this.subOrder},{cmd:"setOptions",value:t}])}"addSubOrder"==this.status&&(console.log("addSubOrder"),this.$store.dispatch("send",[{cmd:"addOrderProduct",value:this.subOrder},{cmd:"changeOrder",value:this.order}])),this.close()},newOrder:function(t){this.order=Me(),this.order.status="ACTIVE",this.order.start_time=P()()+this.registrationTime,this.order.order_id=this.getOrderId(),this.order.order_id_position=t||this.getPosition("new"),this.$set(this.order,"customer_id",null),this.subOrder.id_rent=this.getSubOrderId(),this.subOrder.product_id=this.product.id_rent,this.subOrder.tariff_id=this.product.tariff_default,this.subOrder.order_id=this.order.order_id,this.subOrder.status="ACTIVE",this.subOrder.pause_time=0,this.status="newOrder"},addSubOrder:function(t){if(t){var e=this.orders.find(function(e){return e.order_id==t});e||console.log("order not found!"),this.order=Ue(e),this.subOrder.id_rent=this.getSubOrderId(),this.subOrder.product_id=this.product.id_rent,this.subOrder.tariff_id=this.product.tariff_default,this.subOrder.order_id=this.order.order_id,this.subOrder.status="ACTIVE",this.subOrder.pause_time=0,this.status="addSubOrder"}else console.log("empty order_id!")},isSerial:function(){var t=this.$store.getters.options.lastOrderTime||!1,e=this.$store.getters.options.lastOrderInterval,s=this.$store.getters.now,r=this.getLastId(),n=this.orders.find(function(t){return t.order_id==r});return console.log("lastTime",e),!(!n||"END"===n.status||"DEL"===n.status)&&(t&&s-t<e)},getLastId:function(){return this.$store.getters.options.lastOrderID},getPosition:function(t){var e=this,s=function(){var t=e.$store.getters.orders,s=15,r=null,n=function e(s){return r=t.find(function(t){return t.order_id_position==s})?r:s,s<1?r:e(s-1)},o=n(s);return+o};return"new"==t?s():"newOrder"==this.status?s():"addSubOrder"==this.status?this.order.order_id_position:void 0},setPosition:function(t){var e=t.order_id,s=t.order_id_position;this.orders.find(function(t){return t.order_id==e})?this.addSubOrder(e):this.newOrder(s)},setCustomer:function(t){t&&(this.order.customer_id=t.id_rent,this.order.customer_name="".concat(t.fname," ").concat(t.sname," ").concat(t.tname))},setDeposit:function(t){t&&(this.order.deposit=t.id_rent)},setPromotion:function(t){t&&(this.order.promotion=t.id)},setAccessories:function(t){this.subOrder.accessories=t},setTariff:function(t){this.subOrder.tariff_id=t.id_rent}}),computed:{orders:function(){return this.$store.getters.orders},customers:function(){return this.$store.getters.customers},deposits:function(){return this.$store.getters.depositList},promotions:function(){return this.$store.getters.promotions},accessories:function(){return this.$store.getters.accessories},tariffs:function(){var t=this;if(this.product.id_rent){var e=this.product.tariff_ids.split(","),s=e.reduce(function(e,s){var r=t.$store.getters.tariffs.find(function(t){return t.id_rent===s});return r&&e.push(r),e},[]);return console.log(s),s}},registrationTime:function(){return+this.$store.getters.options.registration_time}}},He=Le,Be=(s("43e6"),Object(d["a"])(He,De,Ie,!1,null,null,null));Be.options.__file="DetailsOrder.vue";var ze=Be.exports,Ve={components:{productList:wt,orderList:Ee,DetailsOrder:ze},data:function(){return{product:{},order:{},subOrder:null,show:!1}},beforeCreate:function(){this.$store.getters.isAppInited||(console.log("asdfasdf"),this.$store.dispatch("INIT_APP"))},methods:{addOrder:function(t){this.product=t,this.show=!0},onClose:function(){this.show=!1}}},qe=Ve,Ge=(s("5216"),Object(d["a"])(qe,H,B,!1,null,"42c5043d",null));Ge.options.__file="index.vue";var Je=Ge.exports,Fe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"history"},[s("h2",[t._v("История заказов")]),s("table",{staticClass:"history__table",attrs:{cellspacing:"0"}},[t._m(0),t._l(t.history,function(e){return s("tr",{key:e.order_id,on:{click:function(s){t.onClick(e)}}},[s("td",{},[t._v(t._s(e.order_id))]),s("td",{},[t._v(t._s(e.customer_name))]),s("td",{},[t._v(t._s(e.start_time))]),s("td",{staticClass:"history__td history__td--time"},[t._v(t._s(e.play_time))]),s("td",[t._v("\n                "+t._s(t.getName(e))+"\n                "),e.products.length>1?s("span",[t._v(" и еще "+t._s(e.products.length-1)+" шт")]):t._e()]),s("td",[t._v(t._s(e.bill)+" р.")]),s("td",[t._v(t._s(e.status))])])})],2),t.show?s("Details",{attrs:{order:t.order},on:{close:t.onClose}}):t._e()],1)},Qe=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",[t._v("id")]),s("th",[t._v("ФИО")]),s("th",[t._v("Старт")]),s("th",[t._v("В прокате")]),s("th",[t._v("Продукт")]),s("th",[t._v("Стоимость")]),s("th",[t._v("Статус")])])}],Ke=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"details"},[s("table",[s("tr",[s("td",[t._v("Заказ")]),s("td",[t._v(t._s(t.order.order_id))])]),s("tr",[s("td",[t._v("Статус")]),s("td",[t._v(t._s(t.order.status))])]),s("tr",[s("td",[t._v("Клиент")]),s("td",[t._v(t._s(t.order.customer_name))])]),s("tr",[s("td",[t._v("Товары")]),s("td",[s("ul",t._l(t.order.products,function(e){return s("li",{key:e.id_rent},[t._v(t._s(e.name)+" - "+t._s(e.bill_rent)+" р.")])}),0)])]),s("tr",[s("td",[t._v("Залог")]),s("td",[t.order.deposit?s("span",[t._v(t._s(t.order.deposit))]):s("span",[t._v("-")])])]),s("tr",[s("td",[t._v("Начало")]),s("td",[t._v(t._s(t.order.start_time))])]),s("tr",[s("td",[t._v("Чистое время")]),s("td",[t._v(t._s(t.getTimePlay(t.order)))])]),s("tr",[s("td",[t._v("Аванс")]),s("td",[t.order.advance>0?s("span",[t._v(t._s(t.order.advance)+" р.")]):s("span",[t._v("-")])])]),s("tr",[s("td",[t._v("Скидка")]),s("td",[t.order.sale>0?s("span",[t._v(t._s(t.order.sale)+" р.")]):s("span",[t._v("-")])])]),"END"===t.order.status?s("tr",{staticClass:"details__bill"},[s("td",[t._v("К оплате")]),s("td",[t._v(t._s(t.order.bill)+" р.")])]):t._e()]),s("div",{staticClass:"details__close",on:{click:t.close}})])])},We=[],Ye={name:"HistoryDetails",props:{order:{type:Object,default:function(){return{}}}},methods:{getTimePlay:function(t){for(var e=this.$store.getters.now,s=t.products,r=null,n=null,o=null,i=Date.parse(t.start_time),a=0;a<s.length;a++)n=s[a].end_time?Date.parse(s[a].end_time):null,o=n?n-i:e-i,o>r&&(r=o);return it(o)},close:function(){this.$emit("close")}}},Xe=Ye,Ze=(s("1184"),Object(d["a"])(Xe,Ke,We,!1,null,"0b79a2de",null));Ze.options.__file="Details.vue";var ts=Ze.exports,es=function(t,e){return e-Date.parse(t)},ss={name:"History",components:{Details:ts},data:function(){return{order:{},show:!1}},methods:Object(nt["a"])({},es,{getTimePlay:function(t){var e=this.$store.getters.subOrders.filter(function(e){return e.order_id==t.order_id}),s=Date.parse(t.start_time),r=Math.max(e.map(function(t){return Date.parse(t.end_time)})),n=s-Date.parse(r);return it(n)},getName:function(t){return t.products[0]?t.products[0].name:""},onClick:function(t){this.order=t,this.show=!0},onClose:function(){this.show=!1}}),computed:{history:function(){var t=this,e=this.$store.getters.history;return e=e.map(function(e){e.subOrders=t.$store.getters.subOrders.filter(function(t){return t.order_id===e.order_id}),e.end_time=Math.max.apply(Math,Object(g["a"])(e.subOrders.map(function(t){return Date.parse(t.end_time)||0})))||P()(),e.play_time=e.end_time>0?it(e.end_time-Date.parse(e.start_time)):0;var s=e.subOrders.reduce(function(t,e){return t.bill+=+e.bill_rent+ +e.bill_access-+e.sale,t.sale+=+e.sale,t},{bill:0,sale:0});return e.bill=s.bill,e.sale=s.sale,e}),e}}},rs=ss,ns=(s("d218"),Object(d["a"])(rs,Fe,Qe,!1,null,"9d02872a",null));ns.options.__file="index.vue";var os=ns.exports,is=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"customer"},[s("table",{staticClass:"customer__table"},[t._m(0),t._l(t.customers,function(e){return s("tr",{key:e.id_rent,on:{click:function(s){t.onClick(e)}}},[s("td",[t._v(t._s(e.id_rent))]),s("td",[t._v(t._s(e.fname)+" "+t._s(e.sname)+" "+t._s(e.tname))]),s("td",[t._v(t._s(e.phone))]),s("td",[t._v(t._s(e.sale))])])})],2),s("div",{staticClass:"customer_buttons"},[s("button",{on:{click:t.addCustomer}},[t._v("Добавить")])]),t.show?s("Details",{attrs:{customer:t.customer},on:{close:t.onClose}}):t._e()],1)},as=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",[t._v("id")]),s("th",[t._v("ФИО")]),s("th",[t._v("Телефон")]),s("th",[t._v("Скидка")])])}],cs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"details customer__details"},[s("h3",[t.customer.id?s("span",[t._v("Сведения о клиенте")]):s("span",[t._v("Добавить нового клиента")])]),s("form",{on:{click:t.onChange}},[s("table",[t.customer.id?s("tr",[s("td",[t._v("id")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.id_rent,expression:"C.id_rent"}],attrs:{type:"text",disabled:""},domProps:{value:t.C.id_rent},on:{input:function(e){e.target.composing||t.$set(t.C,"id_rent",e.target.value)}}})])]):t._e(),s("tr",[s("td",[t._v("Фамилия")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.fname,expression:"C.fname"}],attrs:{type:"text",placeholder:"Фамилия"},domProps:{value:t.C.fname},on:{input:function(e){e.target.composing||t.$set(t.C,"fname",e.target.value)}}})])]),s("tr",[s("td",[t._v("Имя")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.sname,expression:"C.sname"}],attrs:{type:"text",placeholder:"Имя"},domProps:{value:t.C.sname},on:{input:function(e){e.target.composing||t.$set(t.C,"sname",e.target.value)}}})])]),s("tr",[s("td",[t._v("Отчество")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.tname,expression:"C.tname"}],attrs:{type:"text",placeholder:"Отчество"},domProps:{value:t.C.tname},on:{input:function(e){e.target.composing||t.$set(t.C,"tname",e.target.value)}}})])]),s("tr",[s("td",[t._v("Телефон")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.phone,expression:"C.phone"}],attrs:{type:"text",placeholder:"Номер мобильного телефона"},domProps:{value:t.C.phone},on:{input:function(e){e.target.composing||t.$set(t.C,"phone",e.target.value)}}})])]),s("tr",[s("td",[t._v("Паспорт")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.passport,expression:"C.passport"}],attrs:{type:"text",placeholder:"Серия и номер паспорта"},domProps:{value:t.C.passport},on:{input:function(e){e.target.composing||t.$set(t.C,"passport",e.target.value)}}})])]),s("tr",[s("td",[t._v("Адрес")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.address,expression:"C.address"}],attrs:{type:"text",placeholder:"Адрес"},domProps:{value:t.C.address},on:{input:function(e){e.target.composing||t.$set(t.C,"address",e.target.value)}}})])]),s("tr",[s("td",[t._v("Дата рождения")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.birth_date,expression:"C.birth_date"}],attrs:{type:"date",placeholder:"Дата рождения"},domProps:{value:t.C.birth_date},on:{input:function(e){e.target.composing||t.$set(t.C,"birth_date",e.target.value)}}})])]),s("tr",[s("td",[t._v("Скидка, %")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.sale,expression:"C.sale"}],attrs:{type:"text",placeholder:"Скидка, %"},domProps:{value:t.C.sale},on:{input:function(e){e.target.composing||t.$set(t.C,"sale",e.target.value)}}})])]),s("tr",[s("td",[t._v("Баланс, р.")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.C.balance,expression:"C.balance"}],attrs:{type:"text",placeholder:"Текущий баланс, руб"},domProps:{value:t.C.balance},on:{input:function(e){e.target.composing||t.$set(t.C,"balance",e.target.value)}}})])]),s("tr",[s("td",[t._v("Примечание")]),s("td",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.C.note,expression:"C.note"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"Дополнительные сведения о клиенте"},domProps:{value:t.C.note},on:{input:function(e){e.target.composing||t.$set(t.C,"note",e.target.value)}}})])])])]),s("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),s("button",{on:{click:t.close}},[t._v("Отмена")]),t.customer.id?s("button",{on:{click:t.toDelete}},[t._v("Удалить")]):t._e(),s("div",{staticClass:"details__close",on:{click:t.close}})])])},us=[],ds=s("5176"),ls=s.n(ds),fs={props:{customer:Object},data:function(){return{C:ls()({},this.customer),change:!1}},methods:{save:function(){this.C.fname?(this.$store.dispatch("send",{cmd:"setCustomer",value:this.C}),this.close()):alert("Введите фамилию")},close:function(){this.$emit("close")},toDelete:function(){var t=this.C.id_rent;confirm("Вы действительно хотите удалить клиента #".concat(t,"?"))&&this.$store.dispatch("send",{cmd:"deleteCustomer",value:t}),this.close()},onChange:function(){this.change=!0}}},_s=fs,ps=(s("3d08"),Object(d["a"])(_s,cs,us,!1,null,"187e8ecc",null));ps.options.__file="details.vue";var hs=ps.exports,vs={components:{Details:hs},data:function(){return{customer:{},show:!1}},methods:{onClick:function(t){this.customer=t,this.show=!0},addCustomer:function(){this.show=!0,this.customer={}},onClose:function(){this.show=!1}},computed:{customers:function(){return this.$store.getters.customers}}},ms=vs,gs=(s("5238"),Object(d["a"])(ms,is,as,!1,null,null,null));gs.options.__file="index.vue";var bs=gs.exports,Cs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"options"},[s("ul",{staticClass:"options__list"},[s("li",{staticClass:"options__link",class:{options__link_act:t.show.rentalPointInfo},on:{click:function(e){t.select("rentalPointInfo")}}},[t._v("Точка проката")]),s("li",{staticClass:"options__link",class:{options__link_act:t.show.general},on:{click:function(e){t.select("general")}}},[t._v("Общие")]),s("li",{staticClass:"options__link",class:{options__link_act:t.show.tariffs},on:{click:function(e){t.select("tariffs")}}},[t._v("Тарифы")]),s("li",{staticClass:"options__link",class:{options__link_act:t.show.products},on:{click:function(e){t.select("products")}}},[t._v("Товары")]),s("li",{staticClass:"options__link",class:{options__link_act:t.show.categories},on:{click:function(e){t.select("categories")}}},[t._v("Категории")]),s("li",{staticClass:"options__link",class:{options__link_act:t.show.accessories},on:{click:function(e){t.select("accessories")}}},[t._v("Аксессуары")]),s("li",{staticClass:"options__link",class:{options__link_act:t.show.deposit},on:{click:function(e){t.select("deposit")}}},[t._v("Залог")]),s("li",{staticClass:"options__link",class:{options__link_act:t.show.sale},on:{click:function(e){t.select("sale")}}},[t._v("Скидки")])]),t.show.rentalPointInfo?s("RentalPointInfo"):t._e(),t.show.general?s("General"):t._e(),t.show.tariffs?s("Tariffs"):t._e(),t.show.products?s("Products"):t._e(),t.show.categories?s("Categories"):t._e(),t.show.accessories?s("Accessories"):t._e()],1)},Os=[],ws=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"option option-rental-point"},[s("h3",[t._v(t._s(t.message))]),s("table",[s("tr",[s("td",[t._v("Логотип")]),s("td",[s("input",{on:{input:function(e){t.set("logo",e.target.value)}}})])]),s("tr",[s("td",[t._v("Название")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.point.name,expression:"point.name"}],domProps:{value:t.point.name},on:{input:[function(e){e.target.composing||t.$set(t.point,"name",e.target.value)},function(e){t.set("name",e.target.value)}]}})])]),s("tr",[s("td",[t._v("Город")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.point.city,expression:"point.city"}],domProps:{value:t.point.city},on:{input:[function(e){e.target.composing||t.$set(t.point,"city",e.target.value)},function(e){t.set("city",e.target.value)}]}})])]),s("tr",[s("td",[t._v("Адрес")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.point.address,expression:"point.address"}],domProps:{value:t.point.address},on:{input:[function(e){e.target.composing||t.$set(t.point,"address",e.target.value)},function(e){t.set("address",e.target.value)}]}})])]),s("tr",[s("td",[t._v("Время работы")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.point.time_open,expression:"point.time_open"}],attrs:{placeholder:"open:"},domProps:{value:t.point.time_open},on:{input:[function(e){e.target.composing||t.$set(t.point,"time_open",e.target.value)},function(e){t.set("time_open",e.target.value)}]}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.point.time_close,expression:"point.time_close"}],attrs:{placeholder:"close:"},domProps:{value:t.point.time_close},on:{input:[function(e){e.target.composing||t.$set(t.point,"time_close",e.target.value)},function(e){t.set("time_close",e.target.value)}]}})])]),s("tr",[s("td",[t._v("Телефон")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.point.phone,expression:"point.phone"}],domProps:{value:t.point.phone},on:{input:[function(e){e.target.composing||t.$set(t.point,"phone",e.target.value)},function(e){t.set("phone",e.target.value)}]}})])]),s("tr",[s("td",[t._v("Описание")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.point.description,expression:"point.description"}],domProps:{value:t.point.description},on:{input:[function(e){e.target.composing||t.$set(t.point,"description",e.target.value)},function(e){t.set("discriptions",e.target.value)}]}})])]),s("tr",[s("td",[t._v("Точка на карте")]),s("td",[s("input",{on:{input:function(e){t.set("coordinates",e.target.value)}}})])])]),s("button",{staticClass:"option-general__button",on:{click:t.send}},[t._v("Применить")])])},ys=[],ks={data:function(){return{point:Ue(this.$store.getters.rentalPointInfo),change:!1,message:""}},methods:{set:function(t,e){this.point[t]=e},send:function(){this.$store.dispatch("sendRentalPointOptions",this.point).then(this.showMessage("Данные обновлены"))},logout:function(){this.$store.dispatch("AUTH_LOGOUT"),this.$store.dispatch("REBOOT_APP_INIT_STATUS"),this.$router.push("/Login")},showMessage:function(t){this.message=t}},computed:{rentalPointInfo:function(){return Ue(this.$store.getters.rentalPointInfo)}}},$s=ks,Ts=(s("25ad"),Object(d["a"])($s,ws,ys,!1,null,"43922da7",null));Ts.options.__file="RentalPointInfo.vue";var Ps=Ts.exports,Ss=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"option option-general"},[s("table",[s("tr",[s("td",[t._v("Округление (руб)")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.rent_round_bill,expression:"options.rent_round_bill"}],domProps:{value:t.options.rent_round_bill},on:{input:function(e){e.target.composing||t.$set(t.options,"rent_round_bill",e.target.value)}}})])]),s("tr",[s("td",{attrs:{title:"Минимальная стоимость тарифа устанавливается от начала проката до указанного времени"}},[t._v("\n                Порог минимальной стоимости (мин)\n            ")]),s("td",[s("input",{domProps:{value:t.rentMinTime},on:{input:function(e){t.set("rent_min_time",60*e.target.value*1e3)}}})])]),s("tr",[s("td",[t._v("Время на оформление (мин)")]),s("td",[s("input",{domProps:{value:t.registrationTime},on:{input:function(e){t.set("registration_time",60*e.target.value*1e3)}}})])]),s("tr",[s("td",[t._v("Выход из приложения")]),s("td",[s("button",{on:{click:t.logout}},[t._v("logout")])])])]),s("button",{staticClass:"option-general__button",on:{click:t.send}},[t._v("Применить")])])},xs=[],As={data:function(){return{options:this.$store.getters.options,change:!1}},methods:Object(nt["a"])({},Ue,{set:function(t,e){this.options[t]=e},send:function(){console.log(this.options),this.$store.dispatch("send",{cmd:"setOptions",value:this.options})},logout:function(){this.$store.dispatch("AUTH_LOGOUT"),this.$store.dispatch("REBOOT_APP_INIT_STATUS"),this.$router.push("/Login")}}),computed:{rentMinTime:function(){return this.options.rent_min_time/60/1e3},registrationTime:function(){return this.options.registration_time/60/1e3}}},Es=As,Ds=(s("9355"),Object(d["a"])(Es,Ss,xs,!1,null,"1f9025ff",null));Ds.options.__file="General.vue";var Is=Ds.exports,Ns=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"option option-tariffs"},[s("table",[t._m(0),t._l(t.tariffs,function(e){return s("tr",{key:e.id_rent,on:{click:function(s){t.onClick(e)}}},[s("td",[t._v(t._s(e.id_rent))]),s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(e.type))]),s("td",[t._v(t._s(t.getHours(e._h_h)))]),s("td",[t._v(t._s(e._h_min))]),s("td",[t._v(t._s(e._h_max))]),s("td",[t._v(t._s(e.cost))]),s("td",[t._v(t._s(e.note))])])})],2),s("button",{staticClass:"tariff__button tariff__button--add",on:{click:t.addTariff}},[t._v("Добавить")]),t.show?s("Details",{attrs:{tariff:t.tariff},on:{close:t.onClose}}):t._e()],1)},js=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",[t._v("id")]),s("th",[t._v("Название")]),s("th",[t._v("Тип")]),s("th",[t._v("Расчасовка")]),s("th",[t._v("Мин")]),s("th",[t._v("Макс")]),s("th",[t._v("Стоим.")]),s("th",[t._v("Примечание")])])}],Rs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"details"},[s("h3",[t.tariff.id_rent?s("span",[t._v("Редактирование тарифа")]):s("span",[t._v("Новый тариф")])]),s("form",{on:{input:t.onChange}},[s("table",[s("tr",[s("td",[t._v("id")]),s("td",[s("input",{attrs:{disabled:""},domProps:{value:t.newTariff.id_rent}})])]),s("tr",[s("td",[t._v("Название")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff.name,expression:"newTariff.name"}],domProps:{value:t.newTariff.name},on:{input:function(e){e.target.composing||t.$set(t.newTariff,"name",e.target.value)}}})])]),s("tr",{staticClass:"details__tr details__tr--type"},[s("td",[t._v("Тип")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff.type,expression:"newTariff.type"}],staticClass:"tariff__type",attrs:{name:"tariff__type",type:"radio",id:"tariff_type--h",value:"h"},domProps:{checked:"h"==t.newTariff.type,checked:t._q(t.newTariff.type,"h")},on:{change:function(e){t.$set(t.newTariff,"type","h")}}}),s("label",{staticClass:"tariff__type-label",attrs:{for:"tariff_type--h"}},[t._v("Почасовой")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff.type,expression:"newTariff.type"}],staticClass:"tariff__type",attrs:{name:"tariff__type",type:"radio",id:"tariff_type--f",value:"f"},domProps:{checked:"f"==t.newTariff.type,checked:t._q(t.newTariff.type,"f")},on:{change:function(e){t.$set(t.newTariff,"type","f")}}}),s("label",{staticClass:"tariff__type-label",attrs:{for:"tariff_type--f"}},[t._v("Фиксированный")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff.type,expression:"newTariff.type"}],staticClass:"tariff__type",attrs:{name:"tariff__type",type:"radio",id:"tariff_type--d",value:"d"},domProps:{checked:"d"==t.newTariff.type,checked:t._q(t.newTariff.type,"d")},on:{change:function(e){t.$set(t.newTariff,"type","d")}}}),s("label",{staticClass:"tariff__type-label",attrs:{for:"tariff_type--d"}},[t._v("Посуточный")])])]),"h"==t.newTariff.type?s("tr",[t._m(0),s("td",[s("table",t._l(t.newTariff._h_h,function(e,r){return s("tr",{key:r},[s("td",[t._v("\n                                    "+t._s(r+1)),t.newTariff._h_h.length===r+1?s("span",[t._v("+")]):t._e(),t._v(" час\n                                ")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff._h_h[r],expression:"newTariff._h_h[index]"}],domProps:{value:t.newTariff._h_h[r]},on:{input:function(e){e.target.composing||t.$set(t.newTariff._h_h,r,e.target.value)}}})])])}),0),s("button",{on:{click:t.addH}},[t._v("+")]),s("button",{on:{click:t.rmH}},[t._v("-")])])]):t._e(),"h"==t.newTariff.type?s("tr",[s("td",[t._v("Мин")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff._h_min,expression:"newTariff._h_min"}],domProps:{value:t.newTariff._h_min},on:{input:function(e){e.target.composing||t.$set(t.newTariff,"_h_min",e.target.value)}}})])]):t._e(),"h"==t.newTariff.type?s("tr",[s("td",[t._v("Макс")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff._h_max,expression:"newTariff._h_max"}],domProps:{value:t.newTariff._h_max},on:{input:function(e){e.target.composing||t.$set(t.newTariff,"_h_max",e.target.value)}}})])]):t._e(),"h"!=t.newTariff.type?s("tr",[s("td",[t._v("Стоимость")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff.cost,expression:"newTariff.cost"}],domProps:{value:t.newTariff.cost},on:{input:function(e){e.target.composing||t.$set(t.newTariff,"cost",e.target.value)}}})])]):t._e(),s("tr",[s("td",[t._v("Примечание")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTariff.note,expression:"newTariff.note"}],domProps:{value:t.newTariff.note},on:{input:function(e){e.target.composing||t.$set(t.newTariff,"note",e.target.value)}}})])])])]),s("div",{staticClass:"btn-group"},[s("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),s("button",{on:{click:t.close}},[t._v("Отмена")]),t.tariff.id_rent?s("button",{on:{click:t.remove}},[t._v("Удалить")]):t._e()]),s("div",{staticClass:"details__close",on:{click:t.close}})])])},Us=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",[t._v("Расчасовка,"),s("br"),t._v("руб")])}],Ms=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Ls=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tarification t10n"},[s("h5",{staticClass:"t10n__caption"},[t._v("Тарификация")]),s("table",{staticClass:"t10n__table tmp"},[s("tr",[s("th",[s("span",[t._v("Перед")])]),s("th",[t._v("Прокат")]),s("th",[s("span",[t._v("После")])])]),s("tr",[s("td",{staticClass:"t10n__cell t10n__cell--before t10n-before tmp"},[s("input",{attrs:{type:"checkbox",id:"t10n__before"}}),s("div",{staticClass:"t10n__wrap"},[s("span",[t._v("с\n                    "),s("br"),s("input",{staticClass:"t10n-before__input--time",attrs:{type:"time",value:"18:00"}})]),s("br"),s("span",{staticClass:"t10n-before__text"},[t._v("не учитывать время перед стартом проката")]),s("input",{staticClass:"t10n__input",attrs:{type:"number",value:"16"}}),s("span",[t._v("часов")])])]),s("td",{staticClass:"t10n__cell t10n__cell--center tmp"},[s("div",{staticClass:"t10n__wrap"},[s("div",[t._v("Начало "),s("br"),s("input",{staticClass:"t10n__input t10n__input--start",attrs:{type:"time",value:"08:00"}})]),s("div",[t._v("Конец "),s("br"),s("input",{staticClass:"t10n__input t10n__input--end",attrs:{type:"time",value:"08:00"}})])]),s("div",{staticClass:"t10n__length"},[t._v("Продолжительность, часов: "),s("input",{staticClass:"t10n__input",attrs:{type:"number",value:"24"}})]),s("div",{staticClass:"t10n__repeat"},[s("input",{attrs:{type:"checkbox"}}),t._v("Повторять")])]),s("td",{staticClass:"t10n__cell t10n__cell--before t10n-after tmp"},[s("input",{attrs:{type:"checkbox",id:"t10n__after"}}),s("div",{staticClass:"t10n__wrap"},[s("span",[t._v("до\n                    "),s("br"),s("input",{staticClass:"t10n-before__input--time",attrs:{type:"time",value:"12:00"}})]),s("br"),s("span",{staticClass:"t10n-before__text"},[t._v("не учитывать время перед стартом проката")]),s("input",{staticClass:"t10n__input",attrs:{type:"number",value:"4"}}),s("span",[t._v("часа")])])])])])])}],Hs=(s("20b7"),{}),Bs=Object(d["a"])(Hs,Ms,Ls,!1,null,null,null);Bs.options.__file="Tarification.vue";var zs=Bs.exports,Vs={props:{tariff:Object},components:{Tarification:zs},data:function(){return{newTariff:JSON.parse(Re()(this.tariff)),change:!1}},methods:{save:function(){this.newTariff._h_h=this.newTariff._h_h?this.newTariff._h_h.filter(function(t){if(t)return t}):"",this.newTariff._h_h="h"===this.newTariff.type?this.newTariff._h_h:null,this.newTariff.cost="h"===this.newTariff.type?null:this.newTariff.cost,this.newTariff._d_min="h"!==this.newTariff.type?null:this.newTariff._d_min,this.newTariff._d_max="h"!==this.newTariff.type?null:this.newTariff._d_max,console.log(this.newTariff),this.$store.dispatch("send",{cmd:"setTariff",value:this.newTariff}),this.$emit("close")},close:function(){this.change?confirm("Изменения не сохранены. Вы уверены, что хотите выйти?")&&this.$emit("close"):this.$emit("close")},remove:function(){confirm("Вы действительно хотите удалить тариф '".concat(this.newTariff.name,"'?"))&&(this.$store.dispatch("send",{cmd:"deleteTariff",value:this.newTariff.id_rent}),this.$emit("close"))},addH:function(t){t.preventDefault(),this.newTariff._h_h||(this.newTariff._h_h=[]),this.newTariff._h_h.push(""),this.change=!0},rmH:function(t){t.preventDefault(),this.newTariff._h_h&&(this.newTariff._h_h.pop(),this.change=!0)},onChange:function(t){t.preventDefault(),this.change=!0,console.log(this.newTariff)}}},qs=Vs,Gs=(s("def1"),Object(d["a"])(qs,Rs,Us,!1,null,"21681afb",null));Gs.options.__file="Details.vue";var Js=Gs.exports,Fs={components:{Details:Js},data:function(){return{tariff:{},show:!1}},methods:{onClick:function(t){this.show=!0,this.tariff=t},onClose:function(){this.show=!1,this.tariff={}},getHours:function(t){return t?t.reduce(function(t,e){return t+" ".concat(e)},""):null},addTariff:function(){this.show=!0,this.tariff={id_rent:null,type:"h",name:"",_h_h:[0],_h_max:null,_h_min:null,_d_before:null,_d_after:null,cost:null,note:""}}},computed:{tariffs:function(){return this.$store.getters.tariffs}}},Qs=Fs,Ks=(s("aa96"),Object(d["a"])(Qs,Ns,js,!1,null,"441aa651",null));Ks.options.__file="index.vue";var Ws=Ks.exports,Ys=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"option option-products"},[t.products.length?[s("table",t._l(t.products,function(e){return s("tr",{key:e.id_rent,on:{click:function(s){t.onClick(e)}}},[s("td",{staticClass:"product__td--status"},[s("span",{staticClass:"product__status",class:"product__status--"+e.status,attrs:{title:"Статус: "+e.status}})]),s("td",{on:{mousemove:function(s){t.openPhoto(e)},mouseout:function(e){t.closePhoto()}}},[s("Bike",{attrs:{_color:e.color,_type:+e.type}})],1),s("td",{attrs:{title:"Название"}},[t._v(t._s(e.name))])])}),0)]:[t._v("Нет товаров")],s("button",{staticClass:"products__button products__button--add",on:{click:function(e){t.newProduct()}}},[t._v("Добавить")]),t.showDetails?s("Details",{attrs:{data:t.product},on:{close:t.onClose}}):t._e(),t.showPhoto?s("Photo",{staticClass:"photo",attrs:{product:t.product}}):t._e()],2)},Xs=[],Zs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"details"},[s("h3",[t.product.newProduct?s("span",[t._v("Новый товар")]):s("span",[t._v("Редактирование товара")])]),s("form",{on:{input:t.onChange}},[s("table",[s("tr",[s("td",[t._v("id")]),s("td",[s("input",{attrs:{disabled:""},domProps:{value:t.product.id_rent}})])]),s("tr",[s("td",[t._v("Название")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.name,expression:"product.name"}],domProps:{value:t.product.name},on:{input:function(e){e.target.composing||t.$set(t.product,"name",e.target.value)}}})])]),s("tr",[s("td",[t._v("Фото")]),s("td",[s("label",{staticClass:"product__photo--label"},[[t.product.img?s("Photo",{staticClass:"details__photo",attrs:{product:t.product,refresh:t.refresh}}):s("div",{staticClass:"button"},[t._v("Добавить фото")])],s("input",{staticClass:"photo__input",attrs:{type:"file"},on:{input:function(e){t.addImage(e)}}})],2),s("span",{staticClass:"details__status"},[t._v(t._s(t.uploadStatus))])])]),s("tr",[s("td",[t._v("Иконка")]),s("td",{staticClass:"bikes"},[s("div",{on:{click:function(e){t.setType(1)}}},[s("Bike",{staticClass:"bike",class:{bike__active:1==t.product.type},style:{borderColor:t.product.color},attrs:{_color:t.product.color,_type:1}})],1),s("div",{on:{click:function(e){t.setType(2)}}},[s("Bike",{staticClass:"bike",class:{bike__active:2==t.product.type},style:{borderColor:t.product.color},attrs:{_color:t.product.color,_type:2}})],1)])]),s("tr",[s("td",[t._v("Цвет")]),s("td",[s("Palette",{attrs:{_color:t.data.color},on:{setColor:function(e){t.setColor(e)}}})],1)]),s("tr",[s("td",[t._v("Стоимость")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.cost,expression:"product.cost"}],domProps:{value:t.product.cost},on:{input:function(e){e.target.composing||t.$set(t.product,"cost",e.target.value)}}})])]),s("tr",{staticClass:"products_tr--tariffs"},[t._m(0),s("td",[s("Tariffs",{attrs:{data:t.product},on:{setTariffs:function(e){t.setTariffs(e)},setTariffDefault:function(e){t.setTariffDefault(e)}}})],1)]),s("tr",[s("td",[t._v("Статус")]),s("td",[s("select",{directives:[{name:"model",rawName:"v-model",value:t.product.status,expression:"product.status"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.product,"status",e.target.multiple?s:s[0])}}},[s("option",{attrs:{disabled:"",value:""}}),s("option",{attrs:{value:"free"}},[t._v("free")]),s("option",{attrs:{value:"fix"}},[t._v("fix")]),s("option",{attrs:{value:"busy"}},[t._v("busy")])])])])])]),s("div",{staticClass:"btn-group"},[s("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),s("button",{on:{click:t.close}},[t._v("Отмена")]),t.product.id_rent?s("button",{on:{click:t.remove}},[t._v("Удалить")]):t._e()]),t.product.id_rent?s("p",{staticClass:"products__updated"},[t._v("Дата последнего изменения: "+t._s(t.product.updated))]):t._e(),s("div",{staticClass:"details__close",on:{click:t.close}})])])},tr=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",[t._v("Тарифы,"),s("br"),t._v("по умолчанию")])}],er=(s("96cf"),s("3b8d")),sr=function(t){switch(t){case"image/jpeg":return".jpg";case"image/png":return".png"}},rr=function(){var t=Object(er["a"])(regeneratorRuntime.mark(function t(e,s){var r,n,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e&&s&&s.getters.activePath){t.next=2;break}return t.abrupt("return",!1);case 2:return r=String(s.getters.activePath)+"user_uploads.php",n={header:{"Content-Type":"multipart/form-data"}},t.next=6,O.a.post(r,e,n).then(function(t){console.log(t),o=t});case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}},t,this)}));return function(e,s){return t.apply(this,arguments)}}(),nr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tariffs"},[s("table",t._l(t.tariffs,function(e){return s("tr",{key:e.id_rent},[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.check,expression:"tariff.check"}],staticClass:"checkbox",attrs:{id:"check__tariff-"+e.id_rent,type:"checkbox"},domProps:{checked:Array.isArray(e.check)?t._i(e.check,null)>-1:e.check},on:{change:[function(s){var r=e.check,n=s.target,o=!!n.checked;if(Array.isArray(r)){var i=null,a=t._i(r,i);n.checked?a<0&&t.$set(e,"check",r.concat([i])):a>-1&&t.$set(e,"check",r.slice(0,a).concat(r.slice(a+1)))}else t.$set(e,"check",o)},t.setTariffs]}}),s("label",{attrs:{for:"check__tariff-"+e.id_rent,title:"Привязать к товару"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.tariffDefault,expression:"tariffDefault"}],staticClass:"radio",attrs:{id:"radio__tariff-"+e.id_rent,type:"radio",name:"tariff_default"},domProps:{value:e.id_rent,checked:t._q(t.tariffDefault,e.id_rent)},on:{change:[function(s){t.tariffDefault=e.id_rent},t.setTariffDefault]}}),s("label",{attrs:{for:"radio__tariff-"+e.id_rent,title:"По умолчанию"}})]),s("td",[t._v(t._s(e.name))])])}),0)])},or=[],ir={props:{data:Object},data:function(){var t=this;return{tariffs:this.$store.getters.tariffs.map(function(e){var s=t.data.tariff_ids?t.data.tariff_ids.split(","):[];return e.check=!!s.find(function(t){return t===e.id_rent}),e.default=t.data.tariff_default==e.id_rent,e}),tariffDefault:this.data.tariff_default}},methods:{setTariffs:function(){var t=this.tariffs.filter(function(t){return 1==t.check}),e=t.map(function(t){return t.id_rent});this.$emit("setTariffs",e.join())},setTariffDefault:function(){this.$emit("setTariffDefault",this.tariffDefault)}}},ar=ir,cr=(s("ed0d"),Object(d["a"])(ar,nr,or,!1,null,"c6505102",null));cr.options.__file="prod_tariffs.vue";var ur=cr.exports,dr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"categories"},[s("ul",t._l(t.categories,function(e){return s("li",{key:e.name,staticClass:"categories__li"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.check,expression:"category.check"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.check)?t._i(e.check,null)>-1:e.check},on:{change:[function(s){var r=e.check,n=s.target,o=!!n.checked;if(Array.isArray(r)){var i=null,a=t._i(r,i);n.checked?a<0&&t.$set(e,"check",r.concat([i])):a>-1&&t.$set(e,"check",r.slice(0,a).concat(r.slice(a+1)))}else t.$set(e,"check",o)},function(e){t.onSet()}]}}),t._v("\n            "+t._s(e.name)+"\n        ")])}),0)])},lr=[],fr={props:{data:String},data:function(){var t=this;return{categories:this.$store.getters.categories.map(function(e){var s=t.data?t.data.split(","):[];return e.check=!!s.find(function(t){return t===e.id_rent}),e}),map:[[1,[4,[5,6,7]]],[2,[3]]]}},methods:{onSet:function(){var t=this.categories.filter(function(t){return 1==t.check}),e=t.map(function(t){return t.id_rent});this.$emit("setCategories",e.join())}}},_r=fr,pr=(s("5107"),Object(d["a"])(_r,dr,lr,!1,null,"d731278e",null));pr.options.__file="prod_categories.vue";var hr=pr.exports,vr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"palette"},[s("div",{on:{click:function(e){t.open=!0}}}),t.open?s("ul",{staticClass:"colors"},t._l(t.palette,function(e){return s("li",{key:e,staticClass:"color",style:{borderColor:e},on:{click:function(s){t.onClick(e)}}})}),0):t._e()])},mr=[],gr={props:{_color:String},components:{Bike:K},data:function(){return{selectColor:this._color,open:!0,palette:["#ff0000","#0600ff","#397a00","#78ff00","#ff9c00","#b6b6b6","#3c3c3b","#6f00a2","#ffffff","#fcff00","#00deff"]}},methods:{onClick:function(t){this.selectColor=t,this.$emit("setColor",t)}}},br=gr,Cr=(s("0b64"),Object(d["a"])(br,vr,mr,!1,null,"d9071bca",null));Cr.options.__file="Palette.vue";var Or=Cr.exports,wr={props:{data:Object},components:{Tariffs:ur,Categories:hr,Palette:Or,Bike:K,Photo:et},data:function(){return{product:Ue(this.data),change:!1,uploadStatus:"",refresh:!1}},methods:{check:function(){return this.product.name?this.product.tariff_ids?!!this.product.tariff_default||(console.log("empty tariff default"),!1):(console.log("empty tariffs"),!1):(console.log("empty product name"),!1)},addImage:function(){var t=Object(er["a"])(regeneratorRuntime.mark(function t(e){var s,r,n,o,i,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=e.target.files[0],r=Math.floor(P()()/1e3),n=sr(s.type),o="".concat(this.$store.getters.appID,"_").concat(this.product.id_rent,"_").concat(r).concat(n),i=new FormData,i.set("file",s,o),this.uploadStatus="Загрузка ...",t.next=9,rr(i,this.$store);case 9:a=t.sent,a&&(this.uploadStatus="Загрузка завершена",this.product.img="".concat(r).concat(n)),this.refresh=!0;case 12:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),save:function(){this.product.updated=Math.floor(P()()/1e3),this.check()&&(this.$store.dispatch("send",{cmd:"setProduct",value:this.product}),this.$emit("close"))},close:function(){console.log("close"),this.change?confirm("Изменения не сохранены. Вы уверены, что хотите выйти?")&&this.$emit("close"):this.$emit("close")},remove:function(){confirm("Вы уверены, что хотите безвозвратно удалить товар?")&&(this.$store.dispatch("send",{cmd:"deleteProduct",value:this.product.id_rent}),this.$emit("close"))},onChange:function(t){t.preventDefault(),this.change=!0},setTariffs:function(t){this.product.tariff_ids=t},setTariffDefault:function(t){this.product.tariff_default=t},setCategories:function(t){this.product.categories=t},setColor:function(t){this.product.color=t,this.change=!0},setType:function(t){this.product.type=t,this.change=!0}},computed:{tariffs:function(){return this.$store.getters.tariffs},categories:function(){return this.$store.getters.categories}}},yr=wr,kr=(s("1cac"),Object(d["a"])(yr,Zs,tr,!1,null,"0eb949e5",null));kr.options.__file="Details.vue";var $r=kr.exports,Tr=function(t){return t?Math.max.apply(Math,Object(g["a"])(t.map(function(t){return+t.id_rent})).concat([0]))+1:0},Pr={components:{Details:$r,Bike:K,Photo:et},data:function(){return{showDetails:!1,showPhoto:!1,product:{}}},methods:{onClose:function(){this.product={},this.showDetails=!1},onClick:function(t){this.product=t,this.showDetails=!0},openPhoto:function(t){this.product=t,this.showPhoto=!0},closePhoto:function(){this.showPhoto=!1,this.product={}},newProduct:function(){this.showDetails=!0,this.product={newProduct:!0,id_rent:Tr(this.$store.getters.products),categories:null,color:"#fff",cost:0,name:"",note:null,status:"free",tariff_default:null,tariff_ids:null,type:1},console.log("product",this.product)}},computed:{products:function(){return this.$store.getters.products}}},Sr=Pr,xr=(s("1a29"),Object(d["a"])(Sr,Ys,Xs,!1,null,"23b13032",null));xr.options.__file="index.vue";var Ar=xr.exports,Er=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"option option-products"},[s("table",[t._m(0),t._l(t.categories,function(e){return s("tr",{key:e.id_rent,on:{click:function(s){t.onClick(e)}}},[s("td",[t._v(t._s(e.id_rent))]),s("td",[t._v(t._s(e.name))]),s("td",{staticClass:"category__td category__td--parent"},[t._v(t._s(e.parent))])])})],2)])},Dr=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",[t._v("id")]),s("th",[t._v("Название")]),s("th",[t._v("Родительская"),s("br"),t._v("категория")])])}],Ir=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"details"},[s("h3",[t.product.id_rent?s("span",[t._v("Редактирование товара")]):s("span",[t._v("Новый товар")])]),s("form",{on:{input:t.onChange}},[s("table",[s("tr",[s("td",[t._v("id")]),s("td",[s("input",{attrs:{disabled:""},domProps:{value:t.product.id_rent}})])]),s("tr",[s("td",[t._v("Название")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.name,expression:"product.name"}],domProps:{value:t.product.name},on:{input:function(e){e.target.composing||t.$set(t.product,"name",e.target.value)}}})])]),s("tr",[s("td",[t._v("Стоимость")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.cost,expression:"product.cost"}],domProps:{value:t.product.cost},on:{input:function(e){e.target.composing||t.$set(t.product,"cost",e.target.value)}}})])]),s("tr",{staticClass:"products_tr--tariffs"},[s("td",[t._v("Тарифы")]),s("td",[s("Tariffs",{attrs:{data:t.product.tariff_id},on:{setTariffs:function(e){t.setTariffs(e)}}})],1)]),s("tr",[s("td",[t._v("Статус")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.active,expression:"product.active"}],domProps:{value:t.product.active},on:{input:function(e){e.target.composing||t.$set(t.product,"active",e.target.value)}}})])])])]),s("div",{staticClass:"btn-group"},[s("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),s("button",{on:{click:t.close}},[t._v("Отмена")]),t.product.id_rent?s("button",{on:{click:t.remove}},[t._v("Удалить")]):t._e()]),s("div",{staticClass:"details__close",on:{click:t.close}})])])},Nr=[],jr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tariffs"},[s("table",t._l(t.tariffs,function(e){return s("tr",{key:e.id_rent},[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.check,expression:"tariff.check"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.check)?t._i(e.check,null)>-1:e.check},on:{change:[function(s){var r=e.check,n=s.target,o=!!n.checked;if(Array.isArray(r)){var i=null,a=t._i(r,i);n.checked?a<0&&t.$set(e,"check",r.concat([i])):a>-1&&t.$set(e,"check",r.slice(0,a).concat(r.slice(a+1)))}else t.$set(e,"check",o)},t.onSet]}})]),s("td",[t._v(t._s(e.name))])])}),0)])},Rr=[],Ur={props:{data:String},data:function(){var t=this;return{tariffs:this.$store.getters.tariffs.map(function(e){var s=t.data?t.data.split(","):[];return e.check=!!s.find(function(t){return t===e.id_rent}),e})}},methods:{onSet:function(){var t=this.tariffs.filter(function(t){return 1==t.check}),e=t.map(function(t){return t.id_rent});this.$emit("setTariffs",e.join())}}},Mr=Ur,Lr=(s("5f0e"),Object(d["a"])(Mr,jr,Rr,!1,null,"2736a17f",null));Lr.options.__file="Products__tariffs.vue";var Hr=Lr.exports,Br={props:{data:Object},components:{Tariffs:Hr},data:function(){return{product:JSON.parse(Re()(this.data)),change:!1}},methods:{save:function(){this.product.updated=Math.floor(P()()/1e3),this.$store.dispatch("send",{cmd:"setProduct",value:this.product}),this.$emit("close")},close:function(){this.change?confirm("Изменения не сохранены. Вы уверены, что хотите выйти?")&&this.$emit("close"):this.$emit("close")},remove:function(){confirm("Вы действительно хотите удалить тариф '".concat(this.product.name,"'?"))&&(this.$store.dispatch("send",{cmd:"deleteProduct",value:this.product.id_rent}),this.$emit("close"))},onChange:function(t){t.preventDefault(),this.change=!0},setTariffs:function(t){this.product.tariff_id=t}},computed:{tariffs:function(){return this.$store.getters.tariffs}}},zr=Br,Vr=(s("6151"),Object(d["a"])(zr,Ir,Nr,!1,null,"723a1af2",null));Vr.options.__file="Details.vue";var qr=Vr.exports,Gr={components:{Details:qr},data:function(){return{show:!1,product:{}}},methods:{onClose:function(){this.product={},this.show=!1},onClick:function(t){this.product=t,this.show=!0,console.log(t)},newProduct:function(){this.show=!0,this.product={}}},computed:{categories:function(){return this.$store.getters.categories}}},Jr=Gr,Fr=(s("b485"),Object(d["a"])(Jr,Er,Dr,!1,null,"571a34ce",null));Fr.options.__file="index.vue";var Qr=Fr.exports,Kr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"option option-accessories"},[s("table",[t._m(0),t._l(t.accessories,function(e){return s("tr",{key:e.id_rent,on:{click:function(s){t.onClick(e)}}},[s("td",[t._v(t._s(e.id_rent))]),s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(e.value))]),s("td",[t._v(t._s(e.type))])])})],2),s("button",{on:{click:t.newAccessory}},[t._v("Добавить")]),t.show?s("Details",{attrs:{data:t.accessory},on:{close:t.onClose}}):t._e()],1)},Wr=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",[t._v("id")]),s("th",[t._v("Название")]),s("th",[t._v("Значение")]),s("th",[t._v("Тип")])])}],Yr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas"},[s("div",{staticClass:"details"},[s("h3",[t.accessory.id_rent?s("span",[t._v("Редактирование аксессуара")]):s("span",[t._v("Новый аксессуар")])]),s("form",{on:{input:t.onChange}},[s("table",[s("tr",[s("td",[t._v("id")]),s("td",[s("input",{attrs:{disabled:""},domProps:{value:t.accessory.id_rent}})])]),s("tr",[s("td",[t._v("Название")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.accessory.name,expression:"accessory.name"}],domProps:{value:t.accessory.name},on:{input:function(e){e.target.composing||t.$set(t.accessory,"name",e.target.value)}}})])]),s("tr",[s("td",[t._v("Значение")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.accessory.value,expression:"accessory.value"}],domProps:{value:t.accessory.value},on:{input:function(e){e.target.composing||t.$set(t.accessory,"value",e.target.value)}}})])]),s("tr",[s("td",[t._v("Тип")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.accessory.type,expression:"accessory.type"}],domProps:{value:t.accessory.type},on:{input:function(e){e.target.composing||t.$set(t.accessory,"type",e.target.value)}}})])])])]),s("div",{staticClass:"btn-group"},[s("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),s("button",{on:{click:t.close}},[t._v("Отмена")]),t.accessory.id_rent?s("button",{on:{click:t.remove}},[t._v("Удалить")]):t._e()]),s("div",{staticClass:"details__close",on:{click:t.close}})])])},Xr=[],Zr={props:{data:Object},data:function(){return{accessory:this.copy(this.data),change:!1}},methods:Object(nt["a"])({},Ue,{save:function(){this.$store.dispatch("send",[{cmd:"setAccessory",value:this.accessory}]),this.$emit("close")},close:function(){this.change?confirm("Изменения не сохранены. Вы уверены, что хотите выйти?")&&this.$emit("close"):this.$emit("close")},remove:function(){confirm("Вы действительно хотите удалить тариф '".concat(this.product.name,"'?"))&&(this.$store.dispatch("send",{cmd:"deleteProduct",value:this.product.id_rent}),this.$emit("close"))},onChange:function(t){t.preventDefault(),this.change=!0},setTariffs:function(t){this.product.tariff_ids=t},setTariffDefault:function(t){this.product.tariff_default=t},setCategories:function(t){this.product.categories=t}}),computed:{tariffs:function(){return this.$store.getters.tariffs},categories:function(){return this.$store.getters.categories}}},tn=Zr,en=(s("1c89"),Object(d["a"])(tn,Yr,Xr,!1,null,"d87b25ee",null));en.options.__file="Details.vue";var sn=en.exports,rn={components:{Details:sn},data:function(){return{show:!1,accessory:{}}},methods:{onClose:function(){this.accessory={},this.show=!1},onClick:function(t){this.accessory=t,this.show=!0},newAccessory:function(){this.show=!0,this.accessory={}}},computed:{accessories:function(){return this.$store.getters.accessories}}},nn=rn,on=(s("903d"),Object(d["a"])(nn,Kr,Wr,!1,null,"211c0dee",null));on.options.__file="index.vue";var an=on.exports,cn={components:{RentalPointInfo:Ps,Tariffs:Ws,General:Is,Products:Ar,Categories:Qr,Accessories:an},data:function(){return{show:{rentalPointInfo:!0,general:!1,tariffs:!1,products:!1,accessories:!1,deposit:!1,sale:!1}}},methods:{select:function(t){this.show={},this.show[t]=!0},logout:function(){this.$store.dispatch("AUTH_LOGOUT"),this.$router.push("/Login")}}},un=cn,dn=(s("4af1"),Object(d["a"])(un,Cs,Os,!1,null,null,null));dn.options.__file="index.vue";var ln=dn.exports,fn=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},_n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"about"},[s("h1",[t._v("This is Admin Page")])])}],pn={name:"AdminPage"},hn=pn,vn=Object(d["a"])(hn,fn,_n,!1,null,null,null);vn.options.__file="AdminPage.vue";var mn=vn.exports,gn=function(){return s.e("chunk-7a7fe8ed").then(s.bind(null,"a55b"))},bn=function(){return s.e("chunk-2d222385").then(s.bind(null,"ce4a"))},Cn={template:"<h2>Page Not Found</h2>"};r["a"].use(m["a"]);var On=function(t,e,s){L.getters.isAuthenticated?s("/"):s()},wn=function(t,e,s){L.getters.isAuthenticated?s():s("/Login")},yn=new m["a"]({base:"/",routes:[{path:"/",name:"home",component:Je,beforeEnter:wn},{path:"/customers",component:bs,beforeEnter:wn},{path:"/history",component:os,beforeEnter:wn},{path:"/options",component:ln,beforeEnter:wn},{path:"/admin",component:mn,beforeEnter:wn},{path:"/login",component:gn,beforeEnter:On},{path:"/token/:token",component:bn},{path:"*",component:Cn}]});r["a"].config.productionTip=!1,new r["a"]({router:yn,store:L,render:function(t){return t(v)}}).$mount("#app")},5714:function(t,e,s){},"5c2c":function(t,e,s){"use strict";var r=s("d9b5"),n=s.n(r);n.a},"5f0e":function(t,e,s){"use strict";var r=s("9e2f"),n=s.n(r);n.a},6151:function(t,e,s){"use strict";var r=s("237a"),n=s.n(r);n.a},"620b":function(t,e,s){"use strict";var r=s("3ff9"),n=s.n(r);n.a},"64a9":function(t,e,s){},"6d04":function(t,e,s){"use strict";var r=s("9f99"),n=s.n(r);n.a},"6eeb":function(t,e,s){},"73bf":function(t,e,s){},"7c0b":function(t,e,s){},"7f79":function(t,e,s){"use strict";var r=s("017f"),n=s.n(r);n.a},"903d":function(t,e,s){"use strict";var r=s("dad7"),n=s.n(r);n.a},"91c4":function(t,e,s){"use strict";var r=s("941f"),n=s.n(r);n.a},"92b5":function(t,e,s){},9355:function(t,e,s){"use strict";var r=s("6eeb"),n=s.n(r);n.a},"941f":function(t,e,s){},9474:function(t,e,s){},"95a6":function(t,e,s){"use strict";var r=s("2ad2"),n=s.n(r);n.a},"9e2f":function(t,e,s){},"9f99":function(t,e,s){},a159:function(t,e,s){},a7a4:function(t,e,s){},aa96:function(t,e,s){"use strict";var r=s("ccdb"),n=s.n(r);n.a},b485:function(t,e,s){"use strict";var r=s("bda3"),n=s.n(r);n.a},bd9c:function(t,e,s){},bda3:function(t,e,s){},c03e:function(t,e,s){},c476:function(t,e,s){},cb2f:function(t,e,s){},ccdb:function(t,e,s){},d218:function(t,e,s){"use strict";var r=s("5714"),n=s.n(r);n.a},d241:function(t,e,s){"use strict";var r=s("7c0b"),n=s.n(r);n.a},d283:function(t,e,s){},d93b:function(t,e,s){"use strict";var r=s("bd9c"),n=s.n(r);n.a},d9b5:function(t,e,s){},dad7:function(t,e,s){},def1:function(t,e,s){"use strict";var r=s("f773"),n=s.n(r);n.a},e637:function(t,e,s){"use strict";var r=s("4103"),n=s.n(r);n.a},ed0d:function(t,e,s){"use strict";var r=s("c476"),n=s.n(r);n.a},edc0:function(t,e,s){"use strict";var r=s("f526"),n=s.n(r);n.a},edf7:function(t,e,s){},f526:function(t,e,s){},f773:function(t,e,s){},fc13:function(t,e,s){"use strict";var r=s("1733"),n=s.n(r);n.a},ff4c:function(t,e,s){}});
//# sourceMappingURL=app.a7c117f6.js.map