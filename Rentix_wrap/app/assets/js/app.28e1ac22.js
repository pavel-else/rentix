(function(t){function e(e){for(var s,n,a=e[0],c=e[1],u=e[2],l=0,d=[];l<a.length;l++)n=a[l],o[n]&&d.push(o[n][0]),o[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);f&&f(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],s=!0,n=1;n<r.length;n++){var a=r[n];0!==o[a]&&(s=!1)}s&&(i.splice(e--,1),t=c(c.s=r[0]))}return t}var s={},n={app:0},o={app:0},i=[];function a(t){return c.p+"assets/js/"+({}[t]||t)+"."+{"chunk-10935659":"d9ed74d0","chunk-2885c54f":"33f8dad1","chunk-2d222385":"ddee00d4","chunk-2db49ea4":"5bac5552","chunk-a897a9a4":"36ddc514","chunk-c1fb4408":"72f8a180"}[t]+".js"}function c(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(t){var e=[],r={"chunk-10935659":1,"chunk-2885c54f":1,"chunk-2db49ea4":1,"chunk-a897a9a4":1,"chunk-c1fb4408":1};n[t]?e.push(n[t]):0!==n[t]&&r[t]&&e.push(n[t]=new Promise(function(e,r){for(var s="assets/css/"+({}[t]||t)+"."+{"chunk-10935659":"6be99bd0","chunk-2885c54f":"23334ed3","chunk-2d222385":"31d6cfe0","chunk-2db49ea4":"29ec42dd","chunk-a897a9a4":"e613cb65","chunk-c1fb4408":"357d8175"}[t]+".css",o=c.p+s,i=document.getElementsByTagName("link"),a=0;a<i.length;a++){var u=i[a],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===s||l===o))return e()}var d=document.getElementsByTagName("style");for(a=0;a<d.length;a++){u=d[a],l=u.getAttribute("data-href");if(l===s||l===o)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var s=e&&e.target&&e.target.src||o,i=new Error("Loading CSS chunk "+t+" failed.\n("+s+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=s,delete n[t],f.parentNode.removeChild(f),r(i)},f.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(f)}).then(function(){n[t]=0}));var s=o[t];if(0!==s)if(s)e.push(s[2]);else{var i=new Promise(function(e,r){s=o[t]=[e,r]});e.push(s[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=a(t),u=function(e){l.onerror=l.onload=null,clearTimeout(d);var r=o[t];if(0!==r){if(r){var s=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src,i=new Error("Loading chunk "+t+" failed.\n("+s+": "+n+")");i.type=s,i.request=n,r[1](i)}o[t]=void 0}};var d=setTimeout(function(){u({type:"timeout",target:l})},12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=s,c.d=function(t,e,r){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)c.d(r,s,function(e){return t[e]}.bind(null,s));return r},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var f=l;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"029e":function(t,e,r){"use strict";var s=r("5fdc"),n=r.n(s);n.a},"0330":function(t,e,r){},"045c":function(t,e,r){"use strict";var s=r("cd99"),n=r.n(s);n.a},"07d4":function(t,e,r){"use strict";var s=r("4017"),n=r.n(s);n.a},1329:function(t,e,r){"use strict";var s=r("9133"),n=r.n(s);n.a},"163b":function(t,e,r){},"1bb1":function(t,e,r){"use strict";var s=r("7c51"),n=r.n(s);n.a},"1c51":function(t,e,r){},"1f3a":function(t,e,r){"use strict";var s=r("7b70"),n=r.n(s);n.a},"22e1":function(t,e,r){},"23de":function(t,e,r){},2970:function(t,e,r){"use strict";var s=r("9a31"),n=r.n(s);n.a},"2b93":function(t,e,r){},"31a7":function(t,e,r){"use strict";var s=r("d7bc"),n=r.n(s);n.a},3675:function(t,e,r){},4017:function(t,e,r){},4202:function(t,e,r){"use strict";var s=r("8a97"),n=r.n(s);n.a},"460f":function(t,e,r){"use strict";var s=r("3675"),n=r.n(s);n.a},4678:function(t,e,r){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=o(t);return r(e)}function o(t){var e=s[t];if(!(e+1)){var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}return e}n.keys=function(){return Object.keys(s)},n.resolve=o,t.exports=n,n.id="4678"},"46ea":function(t,e,r){},4813:function(t,e,r){},4836:function(t,e,r){"use strict";var s=r("4b27"),n=r.n(s);n.a},"4ab4":function(t,e,r){},"4b27":function(t,e,r){},"4e12":function(t,e,r){"use strict";var s=r("dd0e"),n=r.n(s);n.a},"4edf":function(t,e,r){},5238:function(t,e,r){"use strict";var s=r("a159"),n=r.n(s);n.a},"56d7":function(t,e,r){"use strict";r.r(e);r("cadf"),r("551c"),r("f751"),r("097d");var s=r("2b0e"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrap"},["app"===t.mode?r("div",{staticClass:"app"},[r("div",{staticClass:"app__wrap"},[r("adm-panel",{staticClass:"adm-panel"}),r("div",{staticClass:"app__content"},[r("router-view")],1)],1)]):t._e(),"print"===t.mode?r("Print"):t._e()],1)},o=[],i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"menu"},[r("ul",{staticClass:"menu__list"},[r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/"}},[t._v("Прокат")]),r("RentalCategories",{staticClass:"menu__sublist"})],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/customers"}},[t._v("Клиенты")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/history"}},[t._v("История")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/settings/"}},[t._v("Настройки")]),r("ul",{staticClass:"menu__sublist"},[r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/settings/main/"}},[t._v("Точка проката")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/settings/general/"}},[t._v("Общие")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/settings/tariffs/"}},[t._v("Тарифы")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/settings/products/"}},[t._v("Товары")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/settings/accessories/"}},[t._v("Аксессуары")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/monitor/"}},[t._v("Монитор")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/login/"}},[r("span",{on:{click:function(e){return t.logout()}}},[t._v("Выйти из приложения")])])],1)])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/repairs"}},[t.isThereAnyPlanRepairs?r("span",{staticClass:"sign sign__warn",attrs:{title:t.countPlanRepairs+"шт"}}):t._e(),t._v("\n                Ремонт\n            ")]),r("ul",{staticClass:"menu__sublist"},[r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/repairs/plan/"}},[t.isThereAnyPlanRepairs?r("span",{staticClass:"sign sign__warn",attrs:{title:t.countPlanRepairs+"шт"}}):t._e(),t._v("\n                        Плановое ТО\n                        "),t.isThereAnyPlanRepairs?r("span",[t._v(" ("+t._s(t.countPlanRepairs)+")")]):t._e()])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/repairs/current"}},[t._v("\n                    В ремонте\n                    "),t.isThereAnyCurrentRepairs?r("span",[t._v(" ("+t._s(t.countCurrentRepairs)+")")]):t._e()])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/repairs/history/"}},[t._v("История")])],1),r("li",{staticClass:"menu__item"},[r("router-link",{staticClass:"menu__link",attrs:{to:"/repairs/settings/"}},[t._v("Настройки")])],1)])],1)])])},a=[],c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"rental-categories"},[r("ul",{staticClass:"rental-categories__list"},t._l(t.categories,function(e){return r("li",{key:e.id_rent,staticClass:"rental-categories__item",on:{click:function(r){return t.click(e)}}},[t._v("\n            "+t._s(e.name)+"\n        ")])}),0)])},u=[],l={methods:{click:function(t){this.$store.commit("activeCategory",t),this.$router.push("/")}},computed:{categories:function(){return this.$store.getters.categories}}},d=l,f=(r("be3c"),r("2877")),p=Object(f["a"])(d,c,u,!1,null,"4c8a443f",null),_=p.exports,m=r("bd90"),h={name:"admPanel",components:{RentalCategories:_},methods:{logout:function(){this.$store.dispatch("authLogout")}},computed:{planRepairs:function(){return Object(m["a"])(this.$store)},isThereAnyPlanRepairs:function(){return this.planRepairs.length>0},countPlanRepairs:function(){return this.planRepairs.length},currentRepairs:function(){var t=this.$store.getters.repairs,e=t.filter(function(t){return!t.end_time});return e},isThereAnyCurrentRepairs:function(){return this.currentRepairs.length>0},countCurrentRepairs:function(){return this.currentRepairs.length}}},v=h,g=(r("31a7"),r("045c"),Object(f["a"])(v,i,a,!1,null,"f444ee2e",null)),b=g.exports,C=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"print__page"},[r("h2",{staticClass:"print__title"},[t._v("Договор  проката №  "+t._s(t.order.id_rent))]),r("p",{staticClass:"print__p print__p--date"},[r("span",[t._v("г. Армавир")]),r("span",{staticClass:"print__date"},[t._v(t._s(t.date))])]),r("p",{staticClass:"print__p"},[t._v("\n        Индивидуальный предприниматель Колтыков Анатолий Владимирович именуемый в дальнейшем "),r("b",[t._v("«Арендодатель»")]),t._v(", действующий на основании свидетельства о государственной регистрации физического лица в качестве индивидуального предпринимателя серия 23 №008878961, с одной стороны и "),r("span",{staticClass:"print__renter"},[t._v(t._s(t.renter))]),t._v(", именуемый в дальнейшем "),r("b",[t._v("«Арендатор»")]),t._v(", с другой стороны, в соответствии с требованиями статей 626-631 ГК РФ, заключили настоящий договор о нижеследующем:\n    ")]),r("h3",{staticClass:"print__caption"},[t._v("1. Предмет Договора")]),r("p",{staticClass:"print__p"},[t._v("\n        1.1. Арендодатель сдает в прокат (во временное пользование за плату) имущество: "+t._s(t.products_name_and_cost)+" в полной исправности, оцениваемое в сумме "+t._s(t.products_cost)+" рублей."),r("br"),t._v("\n        1.2. Дата и время передачи имущества в аренду: "+t._s(t.order.start_time)),r("br"),t._v("\n        1.3. Залоговый документ: "+t._s(t.deposit)),r("br"),t._v("\n        1.4. Арендатор принимает в прокат Имущество и оплачивает его в соответствии с условиями настоящего Договора. Сдача Имущества в прокат не влечет за собой передачи права собственности на него."),r("br")]),r("h3",{staticClass:"print__caption"},[t._v("2. Права и обязанности  арендодателя")]),t._m(0),r("h3",{staticClass:"print__caption"},[t._v("3. Права И Обязанности  Арендатора")]),t._m(1),r("h3",{staticClass:"print__caption"},[t._v("4. Заключительные  Условия")]),t._m(2),r("h3",{staticClass:"print__caption"},[t._v("5. Согласие На Обработку Персональных Данных")]),t._m(3),r("h3",{staticClass:"print__caption"},[t._v("6. Реквизиты  и  Подписи  Сторон")]),r("p",{staticClass:"print__p"},[r("table",{staticClass:"print__p--info"},[r("tr",[t._m(4),r("td",[t._v("\n                    Арендатор: "+t._s(t.renter)),r("br"),t._v("\n                    Паспорт: "+t._s(t.passport)),r("br"),t._v("\n                    Место жительства: "+t._s(t.address)),r("br"),t._v("\n                    Телефон: "+t._s(t.phone)+"\n                ")])]),r("tr",[r("td",[t._v("\n                    АРЕНДОДАТЕЛЬ"),r("br"),t._v("\n                    _______________/ ИП Колтыков А.В./"),r("br"),t._v("\n                    "+t._s(t.date)+"    \n                ")]),r("td",[t._v("\n                    АРЕНДАТОР"),r("br"),t._v("\n                    ___________ /"+t._s(t.renter_small)+" /"),r("br"),t._v("\n                    "+t._s(t.date)+"                                \n                ")])])])])])},O=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",{staticClass:"print__p"},[t._v("\n        2.1. Арендодатель принимает на себя обязательства:"),r("br"),t._v("\n        2.1.1. Передать в прокат Арендатору Имущество надлежащего качества, в техническом состоянии, позволяющем беспрепятственно использовать его в соответствии с целевым назначением в течении всего периода действия настоящего Договора. "),r("br"),t._v("\n        2.1.2. В присутствии Арендатора проверить работоспособность Имущества."),r("br"),t._v(" \n        2.1.3. Ознакомить Арендатора с правилами использования и содержания Имущества и предоставить Арендатору инструкцию по надлежащему использованию Имущества в соответствии с целевым назначением, а также по надлежащему содержанию и обслуживанию Имущества."),r("br"),t._v(" \n        2.1.4.  Не передавать личные и паспортные данные Арендатора третьим лицам."),r("br"),t._v("\n        2.2. В случае выявления в процессе приемки Арендатором недостатков качества Имущества, возникших не по вине Арендатора, полностью или частично препятствующих его использованию в соответствии с целевым назначением,  безвозмездно устранить выявленные недостатки или заменить его на Имущество, соответствующее требованиям пункта 2.1. настоящего Договора"),r("br"),t._v("\n        2.3. Арендодатель не несет ответственности за вред, который может быть нанесен здоровью людей, а также за материальный ущерб, который может понести Арендатор в ходе эксплуатации Имущества\n    ")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",{staticClass:"print__p"},[t._v("\n        Арендатор принимает на себя обязательства:"),r("br"),t._v("\n        3.1. Оплатить Арендодателю стоимость проката Имущества в соответствии с условиями настоящего Договора."),r("br"),t._v(" \n        3.2. Использовать Имущество в соответствии с целевым назначением, осуществлять надлежащий уход, обслуживание и содержание Имущества в соответствии с полученными от Арендодателя инструкциями в течении всего срока проката."),r("br"),t._v("\n        3.3. Возвратить Имущество Арендодателю в установленный настоящим Договором срок, без неисправностей, повреждений внешнего вида и в чистом состоянии, пригодном для использования в соответствии с целевым назначением."),r("br"),t._v("\n        3.4. Немедленно уведомлять Арендодателя обо всех случаях причинения какого-либо ущерба или разрушения Имущества с описанием характера повреждений и с указанием причин их возникновения."),r("br"),t._v("\n        3.5. В случае возникновения повреждений внешнего вида и неисправности Имущества по вине Арендатора, возместить Арендодателю расходы по ремонту или замене Имущества."),r("br"),t._v(" \n        3.6.  При желании продлить срок аренды Имущества, Арендатор обязан за сутки до истечения этого срока уведомить Арендодателя о своем намерении по телефону указанном в п.6. настоящего Договора. В противном случае, Имущество считается возвращенным не вовремя."),r("br"),t._v("\n        3.7. В случае окончании срока аренды, и не возврата Имущества по вине Арендатора, Арендатору назначается плата за следующую неделю аренды Имущества согласно тарифу проката на данное Имущество и пеню в размере 20% от общей суммы проката\n    ")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",{staticClass:"print__p"},[t._v("\n        4.1. Настоящий Договор составлен в двух экземплярах, один из которых остается у арендодателя, второй выдается арендатору."),r("br"),t._v("\n        4.2. Настоящий Договор вступает в законную силу с момента подписания и действует до 31 декабря текущего года. "),r("br"),t._v("\n        4.3. Отношения между Арендодателем и Арендатором, не предусмотренные положениями настоящего Договора, регламентируются действующим гражданским законодательством Российской Федерации."),r("br")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",{staticClass:"print__p"},[t._v('\n        5.1. Согласно Федерального закона № 152 ( ред. от 29.07.2017) "О персональных данных" подписывая настоящий Договор Арендатор дает согласие на обработку и хранение персональных данных в целях обеспечения соблюдения законов и иных нормативных правовых актов.'),r("br"),t._v('\n        5.2 Согласно п. 5 ст. 6 Федерального закона № 152 ( ред. от 29.07.2017) "О персональных данных" обработка и хранение персональных данных необходима для исполнения настоящего Договора'),r("br")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[t._v("\n                    Арендодатель: ИП Колтыков Анатолий Владимирович"),r("br"),t._v("\n                    ИНН: 230214171784"),r("br"),t._v("\n                    ОГРНИП: 314237201600076"),r("br"),t._v("\n                    Адрес: г.Армавир, ул.Луначарского, д.222"),r("br"),t._v("\n                    Телефон: +7 (918) 941-34-34, +7 (903) 410-44-94\n                ")])}],y=(r("7f7f"),r("7514"),r("c060")),k={created:function(){var t=this.$store.getters.orderToPrint;this.order=t?Object(y["a"])(t):{}},mounted:function(){this.print()},data:function(){return{order:null}},methods:{close:function(){this.$store.dispatch("unsetOrderToPrint")},print:function(){window.print(),this.close()}},computed:{date:function(){var t=this.order.start_time,e=t.slice(0,4),r=t.slice(5,7),s=t.slice(8,10);return"".concat(s,".").concat(r,".").concat(e," г.")},renter:function(){if(!this.customer)return"_______________________";var t=this.customer.fname?this.customer.fname:"",e=this.customer.sname?this.customer.sname:"",r=this.customer.tname?this.customer.tname:"";return"".concat(t," ").concat(e," ").concat(r).trim()},passport:function(){return this.customer?this.customer.passport:""},address:function(){return this.customer?this.customer.address:""},phone:function(){return this.customer?this.customer.phone:""},renter_small:function(){if(!this.customer)return"_______________________";var t=this.customer.fname,e=this.customer.sname?this.customer.sname[0]+".":"",r=this.customer.tname?this.customer.tname[0]+".":"";return"".concat(t," ").concat(e," ").concat(r)},products:function(){var t=this,e=this.$store.getters.activeSubOrders.filter(function(e){return e.order_id==t.order.id_rent}),r=e.map(function(e){return t.$store.getters.products.find(function(t){return t.id_rent==e.product_id})});return r},products_name_and_cost:function(){return this.products.reduce(function(t,e){return t+="".concat(e.name," (").concat(e.cost," руб.), "),t},"")},products_cost:function(){return this.products.reduce(function(t,e){return t+=+e.cost,t},0)},customer:function(){var t=this;return this.$store.getters.customers.find(function(e){return e.id_rent==t.order.customer_id})},deposit:function(){var t=this,e=this.$store.getters.deposits.find(function(e){return e.id_rent==t.order.deposit});return e?e.name:"______________"}}},S=k,P=(r("029e"),Object(f["a"])(S,C,O,!1,null,"7a13a272",null)),w=P.exports,$={name:"app",components:{admPanel:b,Print:w},beforeCreate:function(){var t=this;this.$store.getters.isAuthenticated?this.$store.dispatch("initStore").then(function(){var e=t.$store.getters.generalSettings.timeToUpdateMonitor;e>0&&t.$store.dispatch("startAutoUpdateOrders",e)}):this.$router.push("/#/login")},created:function(){this.$store.dispatch("startTimer")},computed:{mode:function(){return this.$store.getters.orderToPrint?"print":"app"}}},j=$,T=(r("5c0b"),r("a168"),Object(f["a"])(j,n,o,!1,null,"c49a54a6",null)),A=T.exports,D=r("8c4f"),x=r("75fc"),R=r("2f62"),I=r("bc3a"),E=r.n(I),M={state:{cmds:["getProducts","getOrders","getClients","getHistory","getTariffs","getCategories","getOptions","getLogs","getHeaders"],app_id:null,options:{rent_min_time:0,rent_round_bill:0,lastOrderID:null,lastOrderTime:null,lastOrderInterval:18e4,registration_time:0},now:Date.now(),activeBranch:"master",branch:{master:{url:"https://rentix.biz/api/request.php",path:"https://rentix.biz/"},dev:{url:"https://test.rentix.biz/api/request.php",path:"localhost:8080/"}},depositList:[{id_rent:1,name:"Паспорт"},{id_rent:2,name:"Водительское"},{id_rent:3,name:"Военный билет"},{id_rent:4,name:"Загран. паспорт"},{id_rent:5,name:"Мед. полис"},{id_rent:6,name:"Снилс"},{id_rent:7,name:"Студентческий"},{id_rent:8,name:"Водительское"},{id_rent:9,name:"Другое"}],promotions:[{id:1,name:"30%",discount:30},{id:2,name:"Студент - 10%",discount:10}]},mutations:{setOptions:function(t,e){e&&e.map(function(e){t.options[e.name]=e.value})},setOption:function(t,e){var r=e.option,s=e.value;r&&(t.options[r]=s,console.log("setOption",r,t.options[r]))},now:function(t,e){t.now=e},setAppId:function(t,e){t.app_id=e}},actions:{startTimer:function(t){var e=t.commit;setInterval(function(){e("now",Date.now())},1e3)},setAppId:function(t,e){t("setAppId",e)}},getters:{now:function(t){return t.now},options:function(t){return t.options},depositList:function(t){return t.depositList},deposits:function(t){return t.depositList},promotions:function(t){return t.promotions},activeBranch:function(t){return t.activeBranch},activePath:function(t){return t.branch[t.activeBranch].path},url:function(t){return t.branch[t.activeBranch].url},appID:function(t){return t.app_id}}},N={state:{token:localStorage.getItem("user-token")||"",status:""},getters:{isAuthenticated:function(t){return!!t.token},authStatus:function(t){return t.status}},mutations:{authRequest:function(t){t.status="loading"},authSuccess:function(t,e){t.status="success",t.token=e},authError:function(t){t.status="error"},authLogout:function(t){t.token="",t.status=""}},actions:{authRequest:function(t,e){var r=t.getters,s=t.commit;return console.log("authRequest"),new Promise(function(t,n){s("authRequest"),E()({url:r.url,data:{cmd:"login",value:e},method:"POST"}).then(function(e){console.log(e);var r=e.data.token;r&&(s("authSuccess",r),localStorage.setItem("user-token",r)),t(e)}).catch(function(t){console.log(t),s("authError",t),localStorage.removeItem("user-token"),n(t)})})},authLogout:function(t){var e=t.dispatch,r=t.commit;r("authLogout"),e("unsetStore"),localStorage.removeItem("user-token"),delete E.a.defaults.headers.common["Authorization"]}}},q={state:{name:null,address:null,open:null,close:null,phone:null,description:null,coordinates:null},getters:{rentalPointInfo:function(t){return t}},mutations:{rentalPointInfo:function(t,e){for(var r in console.log("commit: rentalPointInfo",e),e)t[r]=e[r]},unsetRentalPointInfo:function(t){console.log("commit: unsetRentalPointInfo"),t.name=null,t.address=null,t.open=null,t.close=null,t.phone=null,t.description=null,t.coordinates=null}},actions:{getRentalPointInfo:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getRentalPointInfo"),new Promise(function(t,s){var n=[{cmd:"getRentalPointInfo"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("rentalPointInfo",r.data.rental_point_info),t(r)}).catch(function(t){console.log(t),s(t)})})},setRentalPointInfo:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setRentalPointInfo",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"setRentalPointInfo",value:e}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("rentalPointInfo",e)}).catch(function(t){console.log(t),n(t)})})}}},B={state:{repairs:[],repairTypes:[]},getters:{repairs:function(t){return t.repairs},repairTypes:function(t){return t.repairTypes}},mutations:{repairs:function(t,e){console.log("commit: repairs",e),t.repairs=e},repairTypes:function(t,e){console.log("commit: repairTypes",e),t.repairTypes=e},unsetRepairs:function(t){console.log("commit: unsetRepairs"),t.repairs=[]},unsetRepairTypes:function(t){console.log("commit: unsetRepairTypes"),t.repairTypes=[]}},actions:{getRepairs:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getRepairs"),new Promise(function(t,s){var n=[{cmd:"getRepairs"},{cmd:"getRepairTypes"},{cmd:"getProducts"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("repairs",r.data.repairs),e("repairTypes",r.data.repair_types),e("products",r.data.products),t(!0)}).catch(function(t){console.log(t),s(t)})})},setRepair:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setRepair"),new Promise(function(t,n){var o=[{cmd:"setRepair",value:e},{cmd:"getRepairs"},{cmd:"getRepairTypes"},{cmd:"getProducts"}],i=s.url,a=localStorage.getItem("user-token");E()({url:i,data:{queue:o,token:a},method:"POST"}).then(function(e){console.log(e),r("repairs",e.data.repairs),r("repairTypes",e.data.repair_types),r("products",e.data.products),t(e)}).catch(function(t){console.log(t),n(t)})})},stopRepair:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: stopRepair"),new Promise(function(t,n){var o=[{cmd:"stopRepair",value:e},{cmd:"getRepairs"},{cmd:"getRepairTypes"},{cmd:"getProducts"}],i=s.url,a=localStorage.getItem("user-token");E()({url:i,data:{queue:o,token:a},method:"POST"}).then(function(e){console.log(e),r("repairs",e.data.repairs),r("repairTypes",e.data.repair_types),r("products",e.data.products),t(e)}).catch(function(t){console.log(t),n(t)})})},setRepairType:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setRepairType",e),new Promise(function(t,n){var o=[{cmd:"setRepairType",value:e},{cmd:"getRepairTypes"}],i=s.url,a=localStorage.getItem("user-token");E()({url:i,data:{queue:o,token:a},method:"POST"}).then(function(e){console.log(e),r("repairTypes",e.data.repair_types),t(e)}).catch(function(t){console.log(t),n(t)})})},deleteRepairType:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: deleteRepairType",e),new Promise(function(t,n){var o=[{cmd:"deleteRepairType",value:e},{cmd:"getRepairTypes"}],i=s.url,a=localStorage.getItem("user-token");E()({url:i,data:{queue:o,token:a},method:"POST"}).then(function(e){console.log(e),r("repairTypes",e.data.repair_types),t(e)}).catch(function(t){console.log(t),n(t)})})}}},z={state:{rent_min_time:0,rent_round_bill:0,lastOrderID:null,lastOrderTime:null,lastOrderInterval:18e4,registration_time:0,timeToUpdateMonitor:0},getters:{generalSettings:function(t){return t}},mutations:{generalSettings:function(t,e){var r=e.reduce(function(t,e){return t[e.name]=e.value,t},[]);for(var s in console.log("commit: generalSettings",r),r)t[s]=r[s]},unsetGeneralSettings:function(t){console.log("commit: unsetGeneralSettings"),t.rent_min_time=0,t.rent_round_bill=0,t.lastOrderID=null,t.lastOrderTime=null,t.lastOrderInterval=18e4,t.registration_time=0,t.timeToUpdateMonitor=0}},actions:{getGeneralSettings:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getGeneralSettings"),new Promise(function(t,s){var n=[{cmd:"getGeneralSettings"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("generalSettings",r.data.general_settings),t(!0)}).catch(function(t){console.log(t),s(t)})})},setGeneralSettings:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setGeneralSettings",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"setGeneralSettings",value:e},{cmd:"getGeneralSettings"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("generalSettings",t.data.general_settings)}).catch(function(t){console.log(t),n(t)})})}}},U={state:{accessories:[]},getters:{accessories:function(t){return t.accessories}},mutations:{accessories:function(t,e){console.log("commit: accessories",e),t.accessories=e},unsetAccessories:function(t){console.log("commit: unsetAccessories"),t.accessories=[]}},actions:{getAccessories:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getAccessories"),new Promise(function(t,s){var n=[{cmd:"getAccessories"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("accessories",r.data.accessories),t(!0)}).catch(function(t){console.log(t),s(t)})})},setAccessory:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setAccessory",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"setAccessory",value:e},{cmd:"getAccessories"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("accessories",t.data.accessories)}).catch(function(t){console.log(t),n(t)})})},deleteAccessory:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: deleteAccessory",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"deleteAccessory",value:e},{cmd:"getAccessories"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("accessories",t.data.accessories)}).catch(function(t){console.log(t),n(t)})})}}},L={state:{tariffs:[]},getters:{tariffs:function(t){return t.tariffs}},mutations:{tariffs:function(t,e){console.log("commit: tariffs",e),t.tariffs=e}},actions:{getTariffs:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getTariffs"),new Promise(function(t,s){var n=[{cmd:"getTariffs"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("tariffs",r.data.tariffs),t(!0)}).catch(function(t){console.log(t),s(t)})})},setTariff:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setTariff",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"setTariff",value:e},{cmd:"getTariffs"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("tariffs",t.data.tariffs)}).catch(function(t){console.log(t),n(t)})})},deleteTariff:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: deleteTariff",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"deleteTariff",value:e},{cmd:"getTariffs"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("tariffs",t.data.tariffs)}).catch(function(t){console.log(t),n(t)})})}}},Y={state:{products:[]},getters:{products:function(t){return t.products}},mutations:{products:function(t,e){console.log("commit: products",e),t.products=e},unsetProducts:function(t){console.log("commit: unsetProducts"),t.products=[]}},actions:{getProducts:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getProducts"),new Promise(function(t,s){var n=[{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getRentalPointInfo"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("rentalPointInfo",r.data.rental_point_info),e("tariffs",r.data.tariffs),e("products",r.data.products),t(!0)}).catch(function(t){console.log(t),s(t)})})},setProduct:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setProduct",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"setProduct",value:e},{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getRentalPointInfo"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("rentalPointInfo",t.data.rental_point_info),r("tariffs",t.data.tariffs),r("products",t.data.products)}).catch(function(t){console.log(t),n(t)})})},deleteProduct:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: deleteProduct",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"deleteProduct",value:e},{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getRentalPointInfo"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("rentalPointInfo",t.data.rental_point_info),r("tariffs",t.data.tariffs),r("products",t.data.products)}).catch(function(t){console.log(t),n(t)})})}}},H={state:{subOrders:[],activeSubOrders:[]},getters:{subOrders:function(t){return t.subOrders},activeSubOrders:function(t){return t.activeSubOrders}},mutations:{subOrders:function(t,e){console.log("commit: subOrders",e),t.subOrders=e},activeSubOrders:function(t,e){console.log("commit: activeSubOrders",e),t.activeSubOrders=e},unsetActiveSubOrders:function(t){console.log("commit: unsetActiveSubOrders"),t.activeSubOrders=[]},unsetSubOrders:function(t){console.log("commit: unsetSubOrders"),t.subOrders=[]}},actions:{getSubOrders:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getSubOrders"),new Promise(function(t,s){var n=[{cmd:"getSubOrders"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("subOrders",r.data.sub_orders),t(!0)}).catch(function(t){console.log(t),s(t)})})},getActiveSubOrders:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getActiveSubOrders"),new Promise(function(t,s){var n=[{cmd:"getActiveSubOrders"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("activeSubOrders",r.data.active_sub_orders),t(!0)}).catch(function(t){console.log(t),s(t)})})},changeSubOrders:function(t,e){var r=t.getters;return console.log("dispatch: changeSubOrders"),new Promise(function(t,s){var n=e.map(function(t){return{cmd:"changeSubOrder",value:t}}),o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(e){console.log(e),t(!0)}).catch(function(t){console.log(t),s(t)})})},changeSubOrder:function(t,e){var r=t.getters;return console.log("dispatch: changeSubOrder",e),new Promise(function(t,s){var n=[{cmd:"changeSubOrder",value:e}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(e){console.log(e),t(!0)}).catch(function(t){console.log(t),s(t)})})}}},G={state:{orders:[],activeOrders:[]},getters:{orders:function(t){return t.orders},activeOrders:function(t){return t.activeOrders}},mutations:{orders:function(t,e){console.log("commit: orders",e),t.orders=e},activeOrders:function(t,e){console.log("commit: activeOrders",e),t.activeOrders=e},unsetOrders:function(t){console.log("commit: unsetOrders"),t.orders=[]},unsetActiveOrders:function(t){console.log("commit: unsetActiveOrders"),t.activeOrders=[]}},actions:{getOrders:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getOrders"),new Promise(function(t,s){var n=[{cmd:"getOrders"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("orders",r.data.orders),t(!0)}).catch(function(t){console.log(t),s(t)})})},getActiveOrders:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getActiveOrders"),new Promise(function(t,s){var n=[{cmd:"getActiveOrders"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("activeOrders",r.data.active_orders),t(!0)}).catch(function(t){console.log(t),s(t)})})},changeOrder:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: changeOrder",e),new Promise(function(t,n){var o=[{cmd:"changeOrder",value:e},{cmd:"getOrders"}],i=s.url,a=localStorage.getItem("user-token");E()({url:i,data:{queue:o,token:a},method:"POST"}).then(function(e){console.log(e),r("orders",e.data.orders),t(!0)}).catch(function(t){console.log(t),n(t)})})}}},V=function(t){return t instanceof Date&&!isNaN(t)},F=V,J={state:{customers:[]},getters:{customers:function(t){return t.customers},customerById:function(t){return function(e){var r=t.customers.find(function(t){return t.id_rent===e});return r}},lastCustomer:function(t){var e=t.customers.reduce(function(t,e){return null===t&&(t=e),F(new Date(e.created))||console.warn("Date parse error! Customers.js, customer_id = "+e.id_rent),Date.parse(e.created)>Date.parse(t.created)&&(t=e),t},null);return e}},mutations:{customers:function(t,e){console.log("commit: customers",e),t.customers=e},unsetCustomers:function(t){console.log("commit: unsetCustomers"),t.customers=[]}},actions:{getCustomers:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getCustomers"),new Promise(function(t,s){var n=[{cmd:"getCustomers"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("customers",r.data.customers),t(!0)}).catch(function(t){console.log(t),s(t)})})},setCustomer:function(t,e){var r=t.commit,s=t.getters;return console.log("dispatch: setCustomer",e),new Promise(function(t,n){E()({method:"post",url:s.url,data:{queue:[{cmd:"setCustomer",value:e},{cmd:"getCustomers"}],token:localStorage.getItem("user-token")}}).then(function(t){console.log(t),r("customers",t.data.customers)}).catch(function(t){console.log(t),n(t)})})}}},W={state:{history:[]},getters:{history:function(t){return t.history}},mutations:{history:function(t,e){if(console.log("commit: history",e),!e)return[];var r=this.getters.products;!e||e.map(function(t){for(var e=0,s=0;s<t.products.length;s++){var n=r.find(function(e){return e.id_rent==t.products[s].product_id});t.products[s].name=n?n.name:"",e+=+t.products[s].bill}return t.bill=e,t}),t.history=e},unsetHistory:function(t){console.log("commit: unsetHistory"),t.history=[]}},actions:{getHistory:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getHistory"),new Promise(function(t,s){var n=[{cmd:"getHistory"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("history",r.data.history),t(!0)}).catch(function(t){console.log(t),s(t)})})}}},K={state:{initCmds:[]},actions:{multipleRequest:function(t,e){var r=t.commit,s=t.getters;e&&e.map||console.warn("multipleRequest error! Queue is not defined or is not array!",e);var n=function(t){for(var e in t)switch(e){case"active_orders":r("activeOrders",t[e]);break;case"orders":r("orders",t[e]);break;case"active_sub_orders":r("activeSubOrders",t[e]);break;case"sub_orders":r("subOrders",t[e]);break;case"products":r("products",t[e]);break;case"tariffs":r("tariffs",t[e]);break;case"customers":r("customers",t[e]);break;case"accessories":r("accessories",t[e]);break;case"general_settings":r("generalSettings",t[e]);break;case"rental_point_info":r("rentalPointInfo",t[e]);break;case"categories":r("categories",t[e]);break;case"repairs":r("repairs",t[e]);break;case"repair_types":r("repairTypes",t[e]);break;case"logs":break;default:console.warn("multipleRequest: Unknown type data - ",e)}};return console.log("dispatch: multipleRequest",e),new Promise(function(t,r){var o=s.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:e,token:i},method:"POST"}).then(function(e){console.log(e),n(e.data),t(!0)}).catch(function(t){console.log(t),r(t)})})}}},Q={state:{categories:[],activeCategory:!1},getters:{categories:function(t){return t.categories},activeCategory:function(t){return t.activeCategory?t.activeCategory:!!t.categories&&t.categories[0]}},mutations:{categories:function(t,e){console.log("commit: categories",e),t.categories=e},activeCategory:function(t,e){console.log("commit: activeCategory",e),t.activeCategory=e},unsetCategories:function(t){console.log("commit: unsetCategories"),t.categories=[]},unsetActiveCategories:function(t){console.log("commit: unsetActiveCategories"),t.activeCategories=!1}},actions:{getCategories:function(t){var e=t.commit,r=t.getters;return console.log("dispatch: getCategories"),new Promise(function(t,s){var n=[{cmd:"getCategories"}],o=r.url,i=localStorage.getItem("user-token");E()({url:o,data:{queue:n,token:i},method:"POST"}).then(function(r){console.log(r),e("categories",r.data.categories),t(!0)}).catch(function(t){console.log(t),s(t)})})}}},X={state:{orderToPrint:null},getters:{orderToPrint:function(t){return t.orderToPrint}},mutations:{orderToPrint:function(t,e){console.log("commit: orderToPrint",e),t.orderToPrint=e}},actions:{setOrderToPrint:function(t,e){var r=t.commit;console.log("dispatch: setOrderToPrint",e),r("orderToPrint",e)},unsetOrderToPrint:function(t){var e=t.commit;console.log("dispatch: unsetOrderToPrint"),e("orderToPrint",null)}}},Z={actions:{initStore:function(t){var e=t.dispatch;return console.log("dispatch: initStore"),new Promise(function(t){e("multipleRequest",[{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"},{cmd:"getProducts"},{cmd:"getCustomers"},{cmd:"getTariffs"},{cmd:"getCategories"},{cmd:"getAccessories"},{cmd:"getGeneralSettings"},{cmd:"getRentalPointInfo"},{cmd:"getRepairs"},{cmd:"getRepairTypes"}]).then(function(){return t()})})},unsetStore:function(t){var e=t.commit;console.log("dispatch: unsetStore"),e("unsetOrders"),e("unsetActiveOrders"),e("unsetAccessories"),e("unsetActiveCategories"),e("unsetCategories"),e("unsetCustomers"),e("unsetGeneralSettings"),e("unsetHistory"),e("unsetProducts"),e("unsetRentalPointInfo"),e("unsetRepairTypes"),e("unsetRepairs"),e("unsetActiveSubOrders"),e("unsetSubOrders")}}},tt={state:{functionSetInterval:null},getters:{},mutations:{startAutoUpdateOrders:function(t,e){t.functionSetInterval=e},stopAutoUpdateOrders:function(t){clearInterval(t.functionSetInterval),t.functionSetInterval=null}},actions:{startAutoUpdateOrders:function(t,e){var r=t.commit,s=t.dispatch;r("startAutoUpdateOrders",setInterval(function(){var t=[{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"}];s("multipleRequest",t)},e))},stopAutoUpdateOrders:function(t){var e=t.commit;console.log("dispatch: stopAutoUpdateOrders"),e("stopAutoUpdateOrders")}}};s["a"].use(R["a"]);var et=new R["a"].Store({modules:{initStore:Z,subOrders:H,customers:J,orders:G,options:M,categories:Q,history:W,auth:N,RentalPointInfo:q,Repairs:B,GeneralSettings:z,Accessories:U,Tariffs:L,Products:Y,multipleRequest:K,print:X,autoUpdateOrders:tt},actions:{send:function(t,e){var r=this,s=t.commit,n=e&&e.config?e.config:null,o=function(t){if(t)return t.cmd?[{cmd:t.cmd,value:t.value}]:t},i=function(t){var e=r.getters.url;console.log("front --\x3e back",t),E()({method:"post",url:e,data:{queue:t,token:localStorage.getItem("user-token")},config:n}).catch(function(t){console.log(t)}).then(function(t){console.log("front <-- back",t),s("products",t.data.products),s("history",t.data.history),s("tariffs",t.data.tariffs),s("setCategories",t.data.categories),s("customers",t.data.customers),s("subOrders",t.data.sub_orders),s("orders",t.data.orders),s("accessories",t.data.accessories),s("generalSettings",t.data.general_settings)})},a=function(){e=["getProducts","getSubOrders","getOrders","getCustomers","getHistory","getTariffs","getCategories","getLogs","getAccessories","getHeaders","getRentalPointInfo","getGeneralSettings"];var t=e.map(function(t){return{cmd:t}});return t},c=function(t){t=t||[],t=[].concat(Object(x["a"])(t),Object(x["a"])(a())),i(t)};c(o(e))},upload:function(t){var e=this.getters.activePath+"user_uploads.php";console.log(e);var r={header:{"Content-Type":"multipart/form-data"}};E.a.post(e,t,r).then(function(t){console.log(t)})},upd:function(t){var e=t.dispatch;e("send")}}}),rt=et,st=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"desktop"},[r("product-list",{staticClass:"snippet snippet__products",on:{addOrder:function(e){return t.addOrder(e)}}}),r("order-list",{staticClass:"snippet snippet__orders"}),t.show?r("DetailsOrder",{attrs:{product:t.product},on:{close:t.onClose}}):t._e()],1)},nt=[],ot=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"product-list"},[r("h3",[t._v("\n        "+t._s(t.activeCategoryName)),t.products.length>=0?r("span",[t._v(" ("+t._s(t.products.length)+")")]):t._e()]),r("table",{staticClass:"table table-bordered"},t._l(t.products,function(e){return r("tr",{key:e.id_rent,staticClass:"products__product",on:{click:function(r){return t.onClick(e)}}},[r("td",{staticClass:"products__td products__td--icon",on:{mousemove:function(r){return t.openPhoto(e)},mouseout:function(e){return t.closePhoto()}}},[r("Bike",{attrs:{_color:e.color,_type:+e.type}})],1),r("td",{staticClass:"products__td"},[t._v("\n                "+t._s(e.name)+" \n                "),e.size&&1!=e.category?r("span",[t._v("("+t._s(e.size)+")")]):t._e()])])}),0),t.product.id_rent?r("Photo",{staticClass:"products__photo",attrs:{product:t.product}}):t._e()],1)},it=[],at=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"icon"},[1===t.type?r("i",{staticClass:"icon"},[r("svg",{attrs:{viewBox:"0 0 1010 585.7407"}},[r("path",{attrs:{id:"bike-12-bike-12",fill:t.color,d:"M309.8848,64.7134c-12.4971,0-23.9776-4.0542-33.4268-10.8008h-4.0635\n            c-12.645,0-22.9126,10.248-22.9126,22.9224c0,12.645,10.2676,22.893,22.9126,22.893h121.4761\n            c8.6401,0,18.8189-4.9419,18.8189-17.2314c0-11.8555-9.5967-17.7832-19.0064-17.7832H309.8848z M820.9512,207.6811\n            c-16.1758,0-31.7998,2.2784-46.8018,6.1153L697.7881,12.9111c-3.1865-8.4038-11.4522-13.3154-19.9932-12.7632\n            C677.3418,0.0986,676.8877,0,676.4043,0h-67.9678c-9.6172,0-17.4189,7.8022-17.4189,17.4185\n            c0,9.6069,7.8017,17.3989,17.4189,17.3989h54.8399l26.5714,69.9111H352.4844c-2.9986,0-5.8394,0.6904-8.3838,1.8936\n            c-3.5708,1.3711-6.707,3.8369-8.7984,7.3877l-65.354,112.0962c-24.5693-11.688-51.9204-18.4249-80.8984-18.4249\n            C84.8145,207.6811,0,292.4858,0,396.7114c0,104.2451,84.8145,189.0293,189.0498,189.0293\n            c98.376,0,179.3438-75.5224,188.1714-171.6113h39.019c7.5357,25.1318,30.5567,43.5371,58.1245,43.5371\n            c33.6734,0,60.9556-27.2627,60.9556-60.9355c0-11.4415-3.334-22.0049-8.789-31.1182l180.5976-215.3652l29.4902,77.5449\n            c-61.9609,31.0498-104.708,95.0029-104.708,168.9189c0,104.2451,84.7842,189.0293,189.0401,189.0293\n            c104.2343,0,189.0488-84.7842,189.0488-189.0293C1010,292.4858,925.1855,207.6811,820.9512,207.6811z M220.9473,379.2827\n            l61.3105-105.1328c32.6475,24.8652,55.1358,62.3262,59.9785,105.1328H220.9473z M299.9033,243.9189l51.2393-87.8818\n            l83.0097,195.2241c-8.4038,7.4073-14.5976,17.0332-17.9121,28.0215h-39.019C372.1123,323.6831,342.7588,275.0869,299.9033,243.9189z\n             M474.3647,335.7759c-1.0751,0-2.081,0.2666-3.1464,0.3154l-81.3521-191.3081h269.6026L495.8467,339.8589\n            C489.1299,337.3345,481.9497,335.7759,474.3647,335.7759z M189.0498,550.9233c-85.0415,0-154.2227-69.1905-154.2227-154.2119\n            s69.1812-154.1929,154.2227-154.1929c22.5869,0,43.9702,5.0005,63.3125,13.7593l-61.9316,106.208\n            c-0.4639,0-0.9175-0.1191-1.3809-0.1191c-18.977,0-34.3838,15.3574-34.3838,34.3643c0,18.9873,15.4068,34.3632,34.3838,34.3632\n            c12.605,0,23.4941-6.8545,29.501-16.9648h123.6855C333.5469,490.9741,268.2021,550.9233,189.0498,550.9233z M820.9512,550.9233\n            c-85.0616,0-154.2227-69.1905-154.2227-154.2119c0-59.0615,33.416-110.4199,82.2988-136.2812l44.1778,116.1699\n            c-4.1328,5.6611-6.628,12.5752-6.628,20.1309c0,18.9873,15.3868,34.3632,34.3741,34.3632c18.9961,0,34.3633-15.3759,34.3633-34.3632\n            c0-15.377-10.1104-28.2188-24.0274-32.6377l-44.71-117.5899c11.0967-2.5156,22.5381-3.9849,34.3741-3.9849\n            c85.0215,0,154.2217,69.1714,154.2217,154.1929S905.9727,550.9233,820.9512,550.9233z"}})])]):t._e(),2===t.type?r("i",{staticClass:"icon"},[r("svg",{attrs:{fill:t.color,viewBox:"0 18 100 100"}},[r("path",{attrs:{d:"M76.454,50.452c-0.786,0-1.552,0.082-2.301,0.213l-3.79-11.997h1.154c0.552,0,1.071-0.259,1.403-0.701  c0.331-0.441,0.436-1.013,0.282-1.542l-3.549-12.251c-0.218-0.75-0.904-1.267-1.686-1.267h-3.08c-0.969,0-1.755,0.786-1.755,1.755  s0.786,1.755,1.755,1.755h1.761l2.533,8.741h-1.214c-0.56,0-1.086,0.267-1.416,0.718s-0.427,1.033-0.258,1.566l1.042,3.299  l-25.845,7.105l-0.708-2.24l4.297-2.076c0.873-0.421,1.238-1.471,0.817-2.343c-0.422-0.873-1.471-1.239-2.344-0.817l-11.614,5.61  c-0.873,0.421-1.238,1.471-0.817,2.343c0.303,0.627,0.93,0.992,1.582,0.992c0.256,0,0.516-0.057,0.762-0.175l4.124-1.992  l0.706,2.235l-5.678,4.664c-2.381-2.224-5.567-3.596-9.075-3.596c-7.345,0-13.32,5.975-13.32,13.32s5.976,13.321,13.32,13.321  c7.001,0,12.746-5.432,13.27-12.301l2.753-0.153c0.789,1.846,2.621,3.144,4.752,3.144c2.849,0,5.165-2.317,5.165-5.166  c0-0.601-0.123-1.169-0.312-1.706l19.495-15.96l2.141,6.775c-4.526,2.13-7.674,6.722-7.674,12.047  c0,7.345,5.976,13.321,13.32,13.321c7.346,0,13.321-5.976,13.321-13.321S83.8,50.452,76.454,50.452z M41.189,58.535  c-0.846,0.651-1.476,1.552-1.792,2.598l-2.771,0.154c-0.311-1.636-0.925-3.162-1.776-4.528l4.588-3.769L41.189,58.535z   M32.113,59.005c0.429,0.769,0.752,1.602,0.963,2.479l-4.27,0.238L32.113,59.005z M23.545,73.583c-5.409,0-9.811-4.401-9.811-9.811  s4.401-9.811,9.811-9.811c2.416,0,4.626,0.881,6.338,2.334l-7.451,6.121c-0.587,0.481-0.797,1.286-0.521,1.993  c0.264,0.677,0.915,1.118,1.635,1.118c0.032,0,0.065-0.001,0.098-0.002l9.63-0.536C32.67,69.825,28.542,73.583,23.545,73.583z   M46.95,58.194c-0.714-0.427-1.534-0.686-2.416-0.723l-1.983-6.275l19.491-5.359L46.95,58.194z M76.454,73.583  c-5.409,0-9.811-4.401-9.811-9.811c0-3.756,2.124-7.021,5.231-8.669l2.906,9.199c0.236,0.748,0.928,1.227,1.673,1.227  c0.175,0,0.354-0.026,0.529-0.082c0.924-0.292,1.437-1.278,1.145-2.202l-2.906-9.197c0.405-0.051,0.814-0.086,1.232-0.086  c5.41,0,9.812,4.401,9.812,9.811S81.864,73.583,76.454,73.583z"}})])]):t._e()])},ct=[],ut=(r("c5f6"),{props:{_color:String,_type:Number},data:function(){return{}},computed:{color:function(){return this._color},type:function(){return+this._type}}}),lt=ut,dt=(r("6836"),Object(f["a"])(lt,at,ct,!1,null,"6693fae5",null)),ft=dt.exports,pt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"photo__wrap"},[r("div",{staticClass:"photo__text"},[t._v("no photo")]),r("div",{staticClass:"photo__img",style:t.backgroundImage})])},_t=[],mt={props:{product:Object,refresh:Boolean},computed:{url:function(){if(!this.product||!this.product.id_rent)return!1;var t=this.$store.getters.activePath,e=this.$store.getters.rentalPointInfo.id_rent,r=this.product.img,s=this.refresh?"?"+Math.floor(1e6*Math.random()):"",n="".concat(t,"user_uploads/").concat(e,"_").concat(this.product.id_rent,"_").concat(r).concat(s);return n},backgroundImage:function(){return{backgroundImage:this.product.img?"url("+this.url+")":"none"}}}},ht=mt,vt=(r("b0bc"),Object(f["a"])(ht,pt,_t,!1,null,"1ecf4c7b",null)),gt=vt.exports,bt={components:{Bike:ft,Photo:gt},data:function(){return{modal:!1,product:{}}},methods:{onClick:function(t){this.$emit("addOrder",t)},openPhoto:function(t){this.modal=!0,this.product=t},closePhoto:function(){this.modal=!1,this.product={}}},computed:{products:function(){var t=this,e=function(e){var r=t.$store.getters.activeSubOrders;return r.find(function(t){return t.product_id==e})},r=function(e){var r=t.$store.getters.repairs,s=r?r.filter(function(t){return t.product_id===e}):[],n=s.find(function(t){return!t.end_time});return!!n},s=function(e){var r=t.$store.getters.activeCategory;return!r||r.id_rent==e.category},n=this.$store.getters.products;return n?n.filter(function(t){return!e(t.id_rent)&&"active"===t.status&&!r(t.id_rent)&&s(t)}):[]},activeCategoryName:function(){var t=this.$store.getters.activeCategory;return t?t.name:"Все"}}},Ct=bt,Ot=(r("b16a"),Object(f["a"])(Ct,ot,it,!1,null,"1c59a472",null)),yt=Ot.exports,kt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-list"},[r("h3",[t._v("В прокате "),r("span",[t._v("("+t._s(t.length)+")")])]),r("table",{staticClass:"table",attrs:{cellspacing:"0"}},t._l(t.ordersByCategory,function(e){return r("tr",{key:e.id_rent,staticClass:"table-tr",attrs:{title:e.title}},[r("td",{staticClass:"td-1"},[r("Icon",{attrs:{id:e.order_id_position,show:!0}})],1),r("td",{staticClass:"td-2"},[t._v(t._s(e.format_start_time))]),r("td",t._l(e.subOrders,function(s){return r("tr",{key:s.id_rent,staticClass:"product-tr",class:"PAUSE"===s.status?"suborder--pause":"suborder--active"},[r("td",{staticClass:"td-3",on:{click:function(r){return t.toChange(e,s)}}},[t._v(t._s(s.product_name))]),r("td",{staticClass:"td-4",on:{click:function(r){return t.toChange(e,s)}}},[t._v(t._s(t.getTimePlay(e,s)))]),r("td",{staticClass:"td-5",on:{click:function(r){return t.toChange(e,s)}}},[t._v("\n                        "+t._s(t.getBillWrap(e,s))+" р\n                    ")])])}),0),r("td",{staticClass:"td-6 td-6-1"},[r("i",{staticClass:"icon far fa-pause-circle",on:{click:function(r){return t.pauseOrder(e)}}})]),r("td",{staticClass:"td-7"},[r("i",{staticClass:"icon far fa-stop-circle",on:{click:function(r){return t.stopOrder(e)}}})])])}),0),t.showDetails?r("DetailsOrder",{attrs:{_order:t.order,_subOrder:t.subOrder},on:{close:t.closeDetails,openResume:function(e){return t.openResume(e)}}}):t._e(),t.showResume?r("Resume",{attrs:{_order:t.order},on:{close:function(e){t.showResume=!1}}}):t._e()],1)},St=[],Pt=(r("28a5"),r("cebc")),wt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details resume"},[r("h2",{staticClass:"resume__caption"},[t._v("Оплата заказа # "+t._s(t.order.id_rent))]),r("table",{staticClass:"resume__main-table"},[r("tr",[r("td",[t._v("Клиент")]),r("td",[t.order.customer_name?r("span",[t._v(t._s(t.order.customer_name))]):r("span",[t._v("-")])])]),r("tr",[r("td",[t._v("Залог")]),r("td",[t.deposit?r("span",[t._v(t._s(t.deposit.name))]):r("span",[t._v("-")])])]),r("tr",[r("td",[t._v("Начало")]),r("td",[t._v(t._s(t.shortDate(t.order.start_time)))])]),r("tr",[r("td",[t._v("Продолжительность")]),r("td",[t._v(t._s(t.activeTime))])]),t.order.note?r("tr",[r("td",[t._v("Примечание")]),r("td",[t._v(t._s(t.order.note))])]):t._e()]),r("div",{staticClass:"products"},[r("ul",{staticClass:"products__list"},[t._l(t.activeSubOrders,function(e){return r("li",{key:e.id_rent,staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",[t._v(t._s(e.product_name))]),r("span",[t._v(t._s(e.bill_rent)+" руб.")])]),r("ul",{staticClass:"products__access-list"},t._l(e.extended_accessories,function(e){return r("li",{key:e.id_rent,staticClass:"products__access-item products__line"},[r("span",{staticClass:"products__arrow"},[t._v(" "+t._s(e.name))]),r("span",[t._v(t._s(e.bill_access)+" руб.")])])}),0)])}),r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Итого"),t.saleSize>0?r("span",[t._v(" (скидка "+t._s(t.saleSize)+"%) ")]):t._e()]),r("span",{staticClass:"products__text-resume"},[t.billRentAccess>t.billRentAccessSale?r("s",{staticStyle:{"margin-right":"5px"}},[t._v("\n                                "+t._s(t.billRentAccess)+" \n                            ")]):t._e(),t._v("\n                            "+t._s(t.billRentAccessSale)+" руб.\n                        ")])])])],2)]),r("table",[t.advance&&t.advance>0?r("tr",[r("td",[t._v("Внесен аванс:")]),r("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.advance)+" руб")])]):t._e(),t.balance&&0!==t.balance?r("tr",[r("td",[t.balance<0?r("span",[t._v("Долг клиента:")]):r("span",[t._v("Баланс клиента:")])]),r("td",{staticStyle:{"text-align":"right"},style:t.styleBalance},[t._v(t._s(Math.abs(t.balance))+" руб")]),r("td",[0!==t.balance?r("input",{attrs:{type:"checkbox",title:t.balance<0?"Погасить сейчас":"Использовать при оплате"},domProps:{checked:t.isApplyBalance},on:{click:function(e){return t.checkBalance(e)}}}):t._e()])]):t._e()]),r("div",{staticClass:"total"},[r("span",[t._v(t._s(t.msgTotal))]),r("span",[t._v(" "+t._s(t.total)+" руб.")])]),r("div",{staticClass:"btn-group"},[r("button",{staticClass:"resume__button",on:{click:function(e){return t.pay("card")}}},[r("i",{staticClass:"icon fa fa-credit-card",attrs:{"aria-hidden":"true"}}),t._v("Картой\n            ")]),r("button",{staticClass:"resume__button",on:{click:function(e){return t.pay("coin")}}},[r("i",{staticClass:"fa fa-eur",attrs:{"aria-hidden":"true"}}),t._v("Наличными\n            ")])]),r("button",{staticClass:"details__close",on:{click:function(e){return e.preventDefault(),t.close(e)}}})])])},$t=[],jt=function(t){var e="";t<0&&(e="-",t*=-1);var r=function(t){return t=Math.floor(t),1<t&&t<10?"0"+t:t},s=t/1e3,n=s/86400,o=s/3600%24,i=s/60%60,a=s%60,c=Math.floor(n)?"".concat(Math.floor(n)," дн. "):"";return n<1&&o<1&&i<3?"".concat(e," ").concat(r(i),"м ").concat(r(a),"с").trim():"".concat(e," ").concat(c).concat(r(o),"ч ").concat(r(i),"м").trim()},Tt=jt;function At(t){var e=rt.getters.generalSettings.rent_round_bill;return e>1?Math.round(t/e)*e:Math.round(t)}function Dt(t,e){if(!t||!e)return 0;var r=rt.getters.tariffs.find(function(e){return e.id_rent==t});if(!r)return 0;var s=function(t,e){var r=rt.getters.generalSettings.rent_min_time,s=t._h_h,n=+t._h_h[0],o=t._h_max>0?t._h_max:1/0;if(e<0)return 0;if(e<r)return t._h_min;for(var i=0,a=e/1e3/3600,c=0;c<Math.floor(a);c++)if(i+=s[c]?+s[c]:n,n=s[c]?+s[c]:n,i>o)return o;return i+=n*(a-Math.floor(a)),i>o?i=o:i<t._h_min&&(i=t._h_min),i},n=function(t,e){var r=e/1e3/86400,s=Math.ceil(r);return s*t.cost};switch(r.type){case"d":return+n(r,e);case"f":return+r.cost;case"h":return+s(r,e)}}var xt=function(t,e,r){if(t&&!isNaN(Number(e))){if(0===e)return 0;var s=function(t,e){return e*(t/100)},n=function(t){return+t};return"%"===t?s(e,r):"rub"===t?n(e):void 0}},Rt=function(t,e){return t<=0?0:e?Math.round(e.sale/100*t):0},It=function(t,e){if(!e||!e.type)return!1;if(t<=0)return 0;var r=function(t){return Math.round(t/864e5*100)/100},s=function(t){return Math.round(t/36e5*100)/100};if(("d"===e.type||"f"===e.type)&&(!e.mileage||e.mileage<=0))return s(t);switch(e.type){case"h":return s(t);case"d":return r(t)*e.mileage;case"f":return e.mileage}},Et=It,Mt=r("8a88"),Nt={props:{_order:Object},data:function(){return{activeSubOrders:[],order:Object(y["a"])(this._order),balanceAmound:0,isApplyBalance:!0,total:0,msgTotal:""}},created:function(){this.activeSubOrders=this.makeActiveSubOrders(),this.makeTotal()},methods:{makeActiveSubOrders:function(){var t=this,e=Object(y["a"])(this.$store.getters.activeSubOrders.filter(function(e){return e.order_id===t.order.id_rent&&!e.paid}));return e.reduce(function(e,r){var s=t.$store.getters.products.find(function(t){return t.id_rent===r.product_id});return r.product_name=s?s.name:"Нет имени",r.time=t.getTime(r),r.bill_rent=t.getBillRent(r),r.extended_accessories=t.makeAccessories(r),r.bill_access=r.extended_accessories.reduce(function(t,e){return t+=e.bill_access,t},0),r.sale=t.makeSale(r),e.push(r),e},[])},getTime:function(t){var e=Date.parse(this.order.start_time),r=0;if("PAUSE"===t.status){var s=Date.now()-+t.pause_start;r=+t.pause_time+s}else r=t.pause_time;var n=t.end_time?Date.parse(t.end_time):Date.now();return n-e-r},getBillRent:function(t){var e=Dt(t.tariff_id,t.time);return At(e)},makeAccessories:function(t){var e=this;if(!t.accessories)return[];var r=t.accessories.split(","),s=r?r.map(function(t){return t.trim()}):[],n=s.reduce(function(r,s){var n=Object(y["a"])(e.$store.getters.accessories.find(function(t){return t.id_rent===s}));if(!n)return r;var o=xt(n.type,n.value,t.bill_rent);return n.bill_access=At(o),r.push(n),r},[]);return n},makeSale:function(t){var e=t.extended_accessories.reduce(function(t,e){return t+=e.bill_access,t},0),r=Rt(e+t.bill_rent,this.customer);return At(r)},close:function(){this.$emit("close")},pay:function(t){var e=this,r=[],s=this.activeSubOrders.map(function(r){var s=e.stopSubOrder(r);return s.paid=t,s});s.map(function(t){return r.push({cmd:"changeSubOrder",value:t})}),this.stopOrder(),r.push({cmd:"changeOrder",value:this.order}),s.map(function(t){var s=Object(y["a"])(e.$store.getters.products.find(function(e){return e.id_rent===t.product_id})),n=e.$store.getters.tariffs.find(function(e){return e.id_rent===t.tariff_id}),o=Et(t.time,n);o&&o>0&&(s.mileage=+s.mileage+o,r.push({cmd:"setProduct",value:s}))});var n=this.customer;n&&(n.balance=+n.balance+this.balanceAmound,r.push({cmd:"setCustomer",value:n})),r=[].concat(Object(x["a"])(r),[{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"},{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getCustomers"},{cmd:"getAccessories"},{cmd:"getGeneralSettings"}]),this.$store.dispatch("multipleRequest",r),this.close()},stopSubOrder:function(t){var e=Object(y["a"])(t);return e.end_time=Mt["a"]("YYYY-MM-DD HH:mm:ss"),e.status="END",e},stopOrder:function(){this.order.status="END",this.order.off_balance=this.balanceAmound},shortDate:function(t){return Mt["a"]("DD MMMM YYYY HH:mm",t)},checkBalance:function(){this.isApplyBalance=!this.isApplyBalance,this.makeTotal()},getBalanceAmound:function(){var t=this.billRentAccessSale,e=this.balance;return e>t?-t:-e},makeTotal:function(){var t=this.billRentAccessSale,e=this.balance,r=this.advance,s=!1,n="msg",o=0;if(r>0&&!this.isApplyBalance&&(s=Math.abs(r-t),n=r>t?"К сдаче: ":"К оплате: "),r<=0&&!this.isApplyBalance&&(s=t,n="К оплате: "),r>0&&this.isApplyBalance&&(e>t&&(s=r,n="Возврат аванса: ",o=-t),e<=t)){o=-e;var i=t-e;n=r>i?" К сдаче: ":"К оплате: ",s=Math.abs(r-i)}r<=0&&this.isApplyBalance&&(e>t&&(s=0,n="К оплате: ",o=-t),e<=t&&(s=t-e,n="К оплате: ",o=-e)),this.total=s,this.msgTotal=n,this.balanceAmound=o}},computed:{customer:function(){return Object(y["a"])(this.$store.getters.customerById(this.order.customer_id))},billRentAccess:function(){return this.activeSubOrders.reduce(function(t,e){return t+=+e.bill_rent+e.bill_access,t},0)},billRentAccessSale:function(){var t=this.activeSubOrders.reduce(function(t,e){return t+=e.sale,t},0);return this.billRentAccess-t},billRentAccessSaleAdvance:function(){return this.billRentAccessSale-this.advance},billRentAccessSaleAdvanceBalance:function(){return-this.advance},activeTime:function(){var t=Date.parse(this.order.start_time),e=Date.now(),r=e-t;return Tt(r)},deposit:function(){var t=this;return this.$store.getters.deposits.find(function(e){return e.id_rent===+t.order.deposit})},balance:function(){return this.customer&&this.customer.balance?+this.customer.balance:0},advance:function(){return this.order.advance?+this.order.advance:0},saleSize:function(){return this.customer?+this.customer.sale:0},styleBalance:function(){return{color:this.balance<0?"red":"green"}}}},qt=Nt,Bt=(r("d4cb"),Object(f["a"])(qt,wt,$t,!1,null,"7cf9efaa",null)),zt=Bt.exports,Ut=function(t,e,r){if(!t||!e)return 0;var s=t.split(","),n=s?s.map(function(t){return t.trim()}):[],o=n.reduce(function(t,s){var n=e.find(function(t){return t.id_rent===s});return n||console.log("Acessory ".concat(s," not found")),t+=n?xt(n.type,n.value,r):0,t},0);return Number(o)},Lt={stopSubOrder:function(t,e,r){var s=[];e.end_time=Mt["a"]("YYYY-MM-DD hh:mm:ss");var n=Date.parse(e.end_time)-Date.parse(t.start_time)-e.pause_time,o=Dt(e.tariff_id,n);e.bill_rent=At(o);var i=Ut(e.accessories,this.$store.getters.accessories,e.bill_rent);e.bill_access=At(i);var a=Rt(+e.bill_rent+ +e.bill_access,+t.customer_id);e.sale=At(a),e.status="END",s.push({cmd:"changeSubOrder",value:e});var c=n/1e3/60/60;s.push({cmd:"incMileage",value:{product_id:e.product_id,mileage:c}});var u=this.$store.getters.subOrders.filter(function(t){return t.order_id===e.order_id&&("ACTIVE"===t.status||"PAUSE"===t.status)});0===u.length&&(t.status="END",s.push({cmd:"changeOrder",value:t})),r&&this.$store.dispatch("send",s)}},Yt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details change-order__datails"},[r("h3",[t._v("Детали заказа"),r("span",[t._v(" - # "+t._s(t.order.id_rent)+"/"+t._s(t.subOrder.id_rent))])]),r("form",{on:{submit:function(t){t.preventDefault()}}},[r("table",[r("tr",[r("td",[t._v("Товар")]),r("td",[t._v(t._s(t.product.name))])]),r("tr",[r("td",[t._v("Группа")]),r("td",[r("Position",{attrs:{position:t.getPosition()},on:{setPosition:function(e){return t.setPosition(e)}}})],1)]),r("tr",[r("td",[t._v("Статус")]),r("td",[t._v("\n                        "+t._s(t.getStatus(t.subOrder.status))+"\n                    ")])]),r("tr",[r("td",[t._v("Аванс")]),r("td",[r("input",{staticClass:"add-order__input add-order__input--advance",attrs:{placeholder:"0 руб"},domProps:{value:t.order.advance},on:{change:function(e){return t.setAdvance(e)}}})])]),r("tr",[r("td",[t._v("Клиент")]),r("td",[r("SelectCustomer",{attrs:{customer:t.order.customer_id},on:{setCustomer:function(e){return t.setCustomer(e)}}})],1)]),r("tr",[r("td",[t._v("Залог")]),r("td",[r("SelectDeposit",{attrs:{deposit:t.order.deposit},on:{setDeposit:function(e){return t.setDeposit(e)}}})],1)]),r("tr",[r("td",[t._v("Примечание")]),r("td",[r("textarea",{staticClass:"add-order__input add-order__input--note",attrs:{cols:"30",rows:"3"},domProps:{value:t.order.note},on:{input:function(e){return t.setNote(e)}}})])]),r("tr",[r("td",[t._v("Акция")]),r("td",[r("SelectPromotion",{attrs:{promotion:t.order.promotion},on:{setPromotion:function(e){return t.setPromotion(e)}}})],1)]),r("tr",[r("td",[t._v("Аксессуары")]),r("td",[r("SelectAccessories",{attrs:{accessory:t.subOrder.accessories},on:{setAccessories:function(e){return t.setAccessories(e)}}})],1)]),r("tr",[r("td",[t._v("Тарифный план")]),r("td",[r("SelectTariff",{attrs:{"data-tariffs":t.tariffs,"data-tariff-default":t.subOrder.tariff_id?t.subOrder.tariff_id:t.product.tariff_default},on:{setTariff:function(e){return t.setTariff(e)}}})],1)])]),r("div",{staticClass:"btn-group"},[r("button",{staticClass:"change-order__button",on:{click:function(e){return t.toPrint()}}},[t._v("\n                    Печать\n                ")]),r("button",{staticClass:"change-order__button",on:{click:function(e){return e.preventDefault(),t.save()}}},[t._v("\n                    Сохранить                        \n                ")]),r("button",{staticClass:"change-order__button",on:{click:function(e){return e.preventDefault(),t.abortSubOrder()}}},[t._v("\n                    Удалить\n                ")]),r("button",{staticClass:"change-order__button",on:{click:function(e){return e.preventDefault(),t.pauseSubOrder()}}},[t._v("\n                    Пауза\n                ")])]),r("button",{staticClass:"details__close",on:{click:function(e){return e.preventDefault(),t.close(e)}}})]),t.showTotalResume?r("TotalResume",{attrs:{_order:t.order},on:{close:function(e){return t.close()}}}):t._e(),t.showResumeForOne?r("ResumeForOne",{attrs:{_order:t.order,_subOrder:t.subOrder},on:{close:function(e){return t.close()}}}):t._e()],1)])},Ht=[],Gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"customer-id"},[t.open?r("div",{staticClass:"btns"},t._l(t.btns,function(e,s){return r("div",{key:s,staticClass:"btn",on:{click:function(r){return t.onClick(e,s)}}},[r("Icon",{attrs:{id:s,show:t.select==s||"number"==typeof e.position,select:t.select==s}})],1)}),0):r("div",{staticClass:"btn",on:{click:function(e){t.open=!0}}},[r("Icon",{attrs:{id:t.select,show:!0,select:!1}})],1)])},Vt=[],Ft=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"icon-wrap"},[r("div",{staticClass:"icon",class:t.iconClass},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.select,expression:"select"}],staticClass:"outline"}),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.show,expression:"!show"}],staticClass:"fill"})])])},Jt=[],Wt={props:{id:null,show:null,select:null},data:function(){return{}},computed:{iconClass:function(){return"d"+this.id}}},Kt=Wt,Qt=(r("dda8"),Object(f["a"])(Kt,Ft,Jt,!1,null,"c8878bf6",null)),Xt=Qt.exports,Zt={props:{position:null},components:{Icon:Xt},data:function(){return{open:!1,select:this.position,selectIcon:"d"+this.position}},methods:{onClick:function(t,e){var r=t.id_rent;this.select=e,this.selectIcon=t.class,this.$emit("setPosition",{order_id:r,order_id_position:e}),this.open=!1}},computed:{btns:function(){var t=[],e=this.$store.getters.activeOrders,r=null,s=function s(n){var o=e.find(function(t){return t.order_id_position==n});return t[n]={position:o?n:null,id_rent:o?o.id_rent:r,class:"d"+n},n<1?t:s(n-1)};return s(15)}}},te=Zt,ee=(r("460f"),Object(f["a"])(te,Gt,Vt,!1,null,"cf4a0484",null)),re=ee.exports,se=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("multiselect",{ref:"vms",attrs:{"deselect-label":"","track-by":"fname",label:"fname",placeholder:"...","custom-label":t.fullName,options:t.options,searchable:!0,"allow-empty":!1},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},ne=[],oe=r("8e5f"),ie=r.n(oe),ae={props:{customer:null,focus:Boolean},components:{Multiselect:ie.a},mounted:function(){this.focus&&this.$refs.vms.$el.focus()},data:function(){var t=this;return{value:this.$store.getters.customers.find(function(e){return e.id_rent==t.customer}),options:this.$store.getters.customers}},methods:{fullName:function(t){var e=t.fname,r=t.sname,s=t.tname,n=e||"",o=r||"",i=s||"";return"".concat(n," ").concat(o," ").concat(i)}},watch:{customer:function(){var t=this;this.value=this.customer?this.$store.getters.customers.find(function(e){return e.id_rent==t.customer}):null},value:function(){this.$emit("setCustomer",this.value),this.value}}},ce=ae,ue=(r("60bc"),r("925f"),Object(f["a"])(ce,se,ne,!1,null,null,null)),le=ue.exports,de=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!0,"clear-on-select":!1,"hide-selected":!0,"preserve-search":!0,placeholder:"...",label:"name","track-by":"name","preselect-first":!1},scopedSlots:t._u([{key:"tag",fn:function(e){return[r("span",{staticClass:"custom__tag"},[r("span",[t._v(t._s(e.option.name)+" "+t._s(e.option.value)+t._s(e.option.type))]),r("span",{staticClass:"custom__remove",on:{click:function(t){return e.remove(e.option)}}},[t._v("❌")])])]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},fe=[],pe={components:{Multiselect:ie.a},props:{accessory:null},data:function(){return{value:this.split(this.accessory),options:this.$store.getters.accessories}},methods:{split:function(t){var e=this;if(!t)return[];var r=t.split(",");return r.map(function(t){return e.$store.getters.accessories.find(function(e){return e.id_rent==t})})},type:function(t){return"%"==t?"%":"p."}},watch:{value:function(){this.$emit("setAccessories",this.value.map(function(t){return t.id_rent}).join())}}},_e=pe,me=(r("deeb"),Object(f["a"])(_e,de,fe,!1,null,null,null)),he=me.exports,ve=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("multiselect",{attrs:{"deselect-label":"","track-by":"name",label:"name",placeholder:"Выбрать",options:t.options,searchable:!1,"allow-empty":!1},scopedSlots:t._u([{key:"singleLabel",fn:function(e){var s=e.option;return[r("strong",[t._v(t._s(s.name))])]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},ge=[],be={props:{dataTariffs:{type:Array,required:!0},dataTariffDefault:null},components:{Multiselect:ie.a},created:function(){},data:function(){var t=this;return{value:this.dataTariffDefault?this.dataTariffs.find(function(e){return e.id_rent==t.dataTariffDefault}):null,options:this.dataTariffs?this.dataTariffs:[]}},watch:{value:function(){this.$emit("setTariff",this.value)}}},Ce=be,Oe=Object(f["a"])(Ce,ve,ge,!1,null,null,null),ye=Oe.exports,ke=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("multiselect",{attrs:{label:"name",options:t.options,searchable:!1,"close-on-select":!0,"show-labels":!1,placeholder:"..."},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},Se=[],Pe={props:{promotion:null},components:{Multiselect:ie.a},data:function(){var t=this;return{value:this.$store.getters.promotions.find(function(e){return e.id==t.promotion}),options:this.$store.getters.promotions}},watch:{promotion:function(){var t=this;this.value=this.$store.getters.promotions.find(function(e){return e.id==t.promotion})},value:function(){this.$emit("setPromotion",this.value)}}},we=Pe,$e=Object(f["a"])(we,ke,Se,!1,null,null,null),je=$e.exports,Te=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("multiselect",{attrs:{label:"name",options:t.options,searchable:!1,"close-on-select":!0,"show-labels":!1,placeholder:"..."},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},Ae=[],De={props:{deposit:null},components:{Multiselect:ie.a},data:function(){var t=this;return{value:this.$store.getters.deposits.find(function(e){return e.id_rent==t.deposit}),options:this.$store.getters.deposits}},watch:{deposit:function(){var t=this;this.value=this.$store.getters.deposits.find(function(e){return e.id_rent==t.deposit})},value:function(){this.$emit("setDeposit",this.value)}}},xe=De,Re=Object(f["a"])(xe,Te,Ae,!1,null,null,null),Ie=Re.exports;function Ee(t){if("ACTIVE"!=t.status&&"PAUSE"!=t.status)return console.warn("Pause error: unknown status - ",t.status),!1;var e=function(){t.status="PAUSE",t.pause_start=Date.now()},r=function(){t.status="ACTIVE";var e=Date.now()-+t.pause_start;t.pause_time=+t.pause_time+e,t.pause_start=0};return"ACTIVE"==t.status?e():r(),t}var Me=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details resume"},[r("h2",{staticClass:"resume__caption"},[t._v("Оплата заказа # "+t._s(t.order.id_rent)+" / "+t._s(t.subOrder.id_rent))]),r("table",{staticClass:"resume__main-table"},[r("tr",[r("td",[t._v("Клиент")]),r("td",[t.order.customer_name?r("span",[t._v(t._s(t.order.customer_name))]):r("span",[t._v("-")])])]),r("tr",[r("td",[t._v("Залог")]),r("td",[t.deposit?r("span",[t._v(t._s(t.deposit.name))]):r("span",[t._v("-")])])]),r("tr",[r("td",[t._v("Начало")]),r("td",[t._v(t._s(t.shortDate(t.order.start_time)))])]),r("tr",[r("td",[t._v("Продолжительность")]),r("td",[t._v(t._s(t.activeTime))])]),t.order.note?r("tr",[r("td",[t._v("Примечание")]),r("td",[t._v(t._s(t.order.note))])]):t._e()]),r("div",{staticClass:"products"},[r("ul",{staticClass:"products__list"},[t._l(t.activeSubOrders,function(e){return r("li",{key:e.id_rent,staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",[t._v(t._s(e.product_name))]),r("span",[t._v(t._s(e.bill_rent)+" руб.")])]),r("ul",{staticClass:"products__access-list"},t._l(e.extended_accessories,function(e){return r("li",{key:e.id_rent,staticClass:"products__access-item products__line"},[r("span",{staticClass:"products__arrow"},[t._v(" "+t._s(e.name))]),r("span",[t._v(t._s(e.bill_access)+" руб.")])])}),0)])}),r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Итого"),t.saleSize>0?r("span",[t._v(" (скидка "+t._s(t.saleSize)+"%) ")]):t._e()]),r("span",{staticClass:"products__text-resume"},[t.billRentAccess>t.billRentAccessSale?r("s",{staticStyle:{"margin-right":"5px"}},[t._v("\n                                "+t._s(t.billRentAccess)+" \n                            ")]):t._e(),t._v("\n                            "+t._s(t.billRentAccessSale)+" руб.\n                        ")])])])],2)]),r("table",[r("tr",[r("td",[t._v("Внесен аванс:")]),r("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.advance)+" руб")])]),r("tr",[r("td",[t.balance<0?r("span",[t._v("Долг клиента:")]):r("span",[t._v("Баланс клиента:")])]),r("td",{staticStyle:{"text-align":"right"},style:t.styleBalance},[t._v(t._s(Math.abs(t.balance))+" руб")]),r("td",[0!==t.balance?r("input",{attrs:{type:"checkbox",title:t.balance<0?"Погасить сейчас":"Использовать при оплате"},domProps:{checked:t.isApplyBalance},on:{click:function(e){return t.checkBalance(e)}}}):t._e()])])]),r("div",{staticClass:"total"},[r("span",[t._v(t._s(t.msgTotal))]),r("span",[t._v(" "+t._s(t.total)+" руб.")])]),r("div",{staticClass:"btn-group"},[r("button",{staticClass:"resume__button",on:{click:function(e){return t.pay("card")}}},[r("i",{staticClass:"icon fa fa-credit-card",attrs:{"aria-hidden":"true"}}),t._v("Картой\n            ")]),r("button",{staticClass:"resume__button",on:{click:function(e){return t.pay("coin")}}},[r("i",{staticClass:"fa fa-eur",attrs:{"aria-hidden":"true"}}),t._v("Наличными\n            ")]),r("button",{staticClass:"resume__button",on:{click:function(e){return t.pay("advance")}}},[r("i",{staticClass:"fa",attrs:{"aria-hidden":"true"}}),t._v("С аванса\n            ")])]),r("button",{staticClass:"details__close",on:{click:function(e){return e.preventDefault(),t.close(e)}}})])])},Ne=[],qe={props:{_order:Object,_subOrder:Object},data:function(){return{activeSubOrders:[],order:Object(y["a"])(this._order),subOrder:Object(y["a"])(this._subOrder),balanceAmound:0,isApplyBalance:!0,total:0,msgTotal:""}},created:function(){this.activeSubOrders=this.makeActiveSubOrders(),this.makeTotal()},methods:{makeActiveSubOrders:function(){var t=this,e=[];return this.subOrder&&e.push(this.subOrder),e.reduce(function(e,r){var s=t.$store.getters.products.find(function(t){return t.id_rent===r.product_id});return r.product_name=s?s.name:"Нет имени",r.time=t.getTime(r),r.bill_rent=t.getBillRent(r),r.extended_accessories=t.makeAccessories(r),r.bill_access=r.extended_accessories.reduce(function(t,e){return t+=e.bill_access,t},0),r.sale=t.makeSale(r),e.push(r),e},[])},getTime:function(t){var e=Date.parse(this.order.start_time),r=0;if("PAUSE"===t.status){var s=Date.now()-+t.pause_start;r=+t.pause_time+s}else r=t.pause_time;var n=t.end_time?Date.parse(t.end_time):Date.now();return n-e-r},getBillRent:function(t){var e=Dt(t.tariff_id,t.time);return At(e)},makeAccessories:function(t){var e=this;if(!t.accessories)return[];var r=t.accessories.split(","),s=r?r.map(function(t){return t.trim()}):[],n=s.reduce(function(r,s){var n=Object(y["a"])(e.$store.getters.accessories.find(function(t){return t.id_rent===s}));if(!n)return r;var o=xt(n.type,n.value,t.bill_rent);return n.bill_access=At(o),r.push(n),r},[]);return n},makeSale:function(t){var e=t.extended_accessories.reduce(function(t,e){return t+=e.bill_access,t},0),r=Rt(e+t.bill_rent,this.customer);return At(r)},close:function(){this.$emit("close")},pay:function(t){var e=this,r=[],s=this.activeSubOrders.map(function(r){var s=e.stopSubOrder(r);return s.paid=t,s});s.map(function(t){return r.push({cmd:"changeSubOrder",value:t})}),s.map(function(t){var s=Object(y["a"])(e.$store.getters.products.find(function(e){return e.id_rent===t.product_id})),n=e.$store.getters.tariffs.find(function(e){return e.id_rent===t.tariff_id}),o=Et(t.time,n);o&&o>0&&(s.mileage=+s.mileage+o,r.push({cmd:"setProduct",value:s}))});var n=this.customer;n&&(n.balance=+n.balance+this.balanceAmound,r.push({cmd:"setCustomer",value:n})),r=[].concat(Object(x["a"])(r),[{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"},{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getCustomers"},{cmd:"getAccessories"},{cmd:"getGeneralSettings"}]),this.$store.dispatch("multipleRequest",r),this.close()},stopSubOrder:function(t){var e=Object(y["a"])(t);return e.end_time=Mt["a"]("YYYY-MM-DD HH:mm:ss"),e.status="END",e},stopOrder:function(){this.order.status="END",this.order.off_balance=this.balanceAmound},shortDate:function(t){return Mt["a"]("DD MMMM YYYY HH:mm",t)},checkBalance:function(){this.isApplyBalance=!this.isApplyBalance,this.makeTotal()},getBalanceAmound:function(){var t=this.billRentAccessSale,e=this.balance;return e>t?-t:-e},makeTotal:function(){var t=this.billRentAccessSale,e=!1,r="msg",s=0;e=t,r="К оплате: ",this.total=e,this.msgTotal=r,this.balanceAmound=s}},computed:{customer:function(){return Object(y["a"])(this.$store.getters.customerById(this.order.customer_id))},billRentAccess:function(){return this.activeSubOrders.reduce(function(t,e){return t+=+e.bill_rent+e.bill_access,t},0)},billRentAccessSale:function(){var t=this.activeSubOrders.reduce(function(t,e){return t+=e.sale,t},0);return this.billRentAccess-t},billRentAccessSaleAdvance:function(){return this.billRentAccessSale-this.advance},billRentAccessSaleAdvanceBalance:function(){return-this.advance},activeTime:function(){var t=Date.parse(this.order.start_time),e=Date.now(),r=e-t;return Tt(r)},deposit:function(){var t=this;return this.$store.getters.deposits.find(function(e){return e.id_rent===+t.order.deposit})},balance:function(){return this.customer&&this.customer.balance?+this.customer.balance:0},advance:function(){return this.order.advance?+this.order.advance:0},saleSize:function(){return this.customer?+this.customer.sale:0},styleBalance:function(){return{color:this.balance<0?"red":"green"}}}},Be=qe,ze=(r("1329"),Object(f["a"])(Be,Me,Ne,!1,null,"2f81b3d2",null)),Ue=ze.exports,Le={name:"DetailsChangeOrder",props:{_order:Object,_subOrder:Object},components:{Position:re,SelectCustomer:le,SelectAccessories:he,SelectTariff:ye,SelectPromotion:je,SelectDeposit:Ie,TotalResume:zt,ResumeForOne:Ue},data:function(){return{order:{},subOrder:{},product:{},orders:this.$store.getters.orders,products:this.$store.getters.products,status:{changeOrder:!1,changeSubOrder:!1,splitOrder:!1},print:!1,showTotalResume:!1,showResumeForOne:!1}},created:function(){var t=this;this.order=Object(y["a"])(this._order),this.subOrder=Object(y["a"])(this._subOrder);var e=this.products.find(function(e){return e.id_rent==t.subOrder.product_id});this.product=Object(y["a"])(e)},methods:Object(Pt["a"])({},Lt,{close:function(){this.$emit("close")},save:function(){var t=[];this.status.changeOrder&&t.push({cmd:"changeOrder",value:this.order}),this.status.changeSubOrder&&!this.status.splitOrder&&t.push({cmd:"changeSubOrder",value:this.subOrder}),this.status.splitOrder&&t.push({cmd:"splitOrder",value:{order:this.order,subOrder:this.subOrder}}),t.push({cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"}),this.$store.dispatch("multipleRequest",t),this.close()},toPrint:function(){this.$store.dispatch("setOrderToPrint",this.order)},closePrint:function(){this.$store.dispatch("unsetOrderToPrint")},getTime:function(t){var e=Date.parse(this.order.start_time),r=0;if("PAUSE"===t.status){var s=Date.now()-+t.pause_start;r=+t.pause_time+s}else r=t.pause_time;var n=t.end_time?Date.parse(t.end_time):Date.now();return n-e-r},abortSubOrder:function(){var t=this.subOrder,e=this.order,r="Почему Вы хотите удалить этот товар?",s="Причина удаления",n=prompt(r,s);if(!n)return!1;var o=[];if(t.note=n,"PAUSE"===t.status){var i=Date.now()-+t.pause_start;t.pause_time=+t.pause_time+i,t.pause_start=0}t.end_time=Mt["a"]("YYYY-MM-DD HH:mm:ss"),t.status="DEL";var a=Object(y["a"])(this.$store.getters.products.find(function(e){return e.id_rent===t.product_id})),c=this.$store.getters.tariffs.find(function(e){return e.id_rent===t.tariff_id}),u=this.getTime(t),l=Et(u,c);console.log("mileage",l),l&&l>0&&(a.mileage=+a.mileage+l,o.push({cmd:"setProduct",value:a})),o.push({cmd:"changeSubOrder",value:t}),this.subOrders.length<=1&&(e.status="DEL",o.push({cmd:"changeOrder",value:e},{cmd:"getActiveOrders"})),o.push({cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"}),this.$store.dispatch("multipleRequest",o),this.$emit("close")},stop:function(){var t=this,e=function(e){var r=t.$store.getters.activeSubOrders.filter(function(t){return t.order_id===e.order_id&&t.id_rent!==e.id_rent});return 0===r.length};e(this.subOrder)?this.showTotalResume=!0:this.showResumeForOne=!0},pauseSubOrder:function(){Ee(this.subOrder),this.$store.dispatch("multipleRequest",[{cmd:"changeSubOrder",value:this.subOrder},{cmd:"getActiveSubOrders"}])},getPosition:function(){if(this.order.order_id_position)return this.order.order_id_position},splitOrder:function(t,e){var r=this.order,s=this.subOrder;this.status.splitOrder=!0,r.old_id=this.order.id_rent,r.id_rent=t,r.start_time=Date.parse(this.order.start_time),r.order_id_position=e,console.log("position",e),this.order=r,this.subOrder=s},setPosition:function(t){var e=t.order_id,r=t.order_id_position;this.orders.find(function(t){return t.id_rent==e})||(this.status.splitOrder=!0,this.splitOrder(e,r))},setCustomer:function(t){this.order.customer_id=t.id_rent,this.order.customer_name="".concat(t.fname," ").concat(t.sname," ").concat(t.tname),this.status.changeOrder=!0},setAdvance:function(t){this.order.advance=t.target.value,this.status.changeOrder=!0},setDeposit:function(t){this.order.deposit=t.id_rent,this.status.changeOrder=!0},setNote:function(t){this.order.note=t.target.value,this.status.changeOrder=!0},setPromotion:function(t){t&&(this.order.promotion=t.id,this.status.changeOrder=!0)},setAccessories:function(t){this.subOrder.accessories=t,this.status.changeSubOrder=!0},setTariff:function(t){this.subOrder.tariff_id=t.id_rent,this.status.changeSubOrder=!0,this.status.changeSubOrder=!0},getStatus:function(t){switch(t){case"END":return"Завершен";case"ACTIVE":return"В прокате";default:}}}),computed:{customers:function(){return this.$store.getters.customers},deposits:function(){return this.$store.getters.depositList},promotions:function(){return this.$store.getters.promotions},accessories:function(){return this.$store.getters.accessories},tariffs:function(){var t=this;if(this.product.id_rent){var e=this.product.tariff_ids.split(",");return e.map(function(e){return t.$store.getters.tariffs.find(function(t){return t.id_rent===e})})}},subOrders:function(){return this.$store.getters.activeSubOrders}}},Ye=Le,He=(r("1bb1"),r("85ea"),Object(f["a"])(Ye,Yt,Ht,!1,null,"67ace878",null)),Ge=He.exports,Ve={components:{Resume:zt,DetailsOrder:Ge,Icon:Xt},data:function(){return{order:null,subOrder:null,showDetails:!1,showResume:!1}},methods:Object(Pt["a"])({},Lt,{toChange:function(t,e){this.order=t,this.subOrder=e,this.showDetails=!0},openResume:function(t){this.order=t.order,this.subOrder=t.subOrder,this.showResume=!0},closeDetails:function(){this.subOrder=null,this.order=null,this.showDetails=!1},getStartTime:function(t){if(!t)return"";var e=function(t){return t<10?"0".concat(t):"".concat(t)},r=new Date,s=e(r.getFullYear()),n=e(r.getMonth()+1),o=e(r.getDate()),i=new Date(t),a=e(i.getFullYear()),c=e(i.getMonth()+1),u=e(i.getDate()),l=e(i.getHours()),d=e(i.getMinutes());return o==u&&n==+c&&s==a?"".concat(l,":").concat(d):"".concat(u,".").concat(c,".").concat(a," \n ").concat(l,":").concat(d)},getTimePlay:function(t,e){var r=Date.parse(t.start_time),s=this.$store.getters.now,n=e.pause_time,o=s-r;if("ACTIVE"==e.status&&o&&n)return Tt(o-n);if("PAUSE"==e.status){var i=Date.now()-+e.pause_start,a=+e.pause_time+i;if(o&&a)return Tt(o-a)}return"END"==e.status?Tt(Date.parse(e.end_time)-r-n):void 0},getBillWrap:function(t,e){var r;if("ACTIVE"==e.status&&(r=Date.now()-Date.parse(t.start_time)-e.pause_time),"PAUSE"==e.status){var s=Date.now()-+e.pause_start,n=+e.pause_time+s;r=Date.now()-Date.parse(t.start_time)-n}"END"==e.status&&(r=Date.parse(e.end_time)-Date.parse(t.start_time));var o=Dt(e.tariff_id,r),i=Ut(e.accessories,this.$store.getters.accessories,o),a=this.$store.getters.customers.find(function(e){return e.id_rent==t.customer_id}),c=Rt(o+i,a);return At(o)+At(i)-At(c)},pauseOrder:function(t){var e=this.$store.getters.activeSubOrders.filter(function(e){return e.order_id===t.id_rent}),r=Object(y["a"])(e);if(0===r.length)return!1;var s=r.filter(function(t){return"ACTIVE"===t.status}),n=r.filter(function(t){return"PAUSE"===t.status}),o=function(){return s.map(function(t){return{cmd:"changeSubOrder",value:Ee(t)}})},i=function(){return n.map(function(t){return{cmd:"changeSubOrder",value:Ee(t)}})},a=s.length>0?o():i();a.push({cmd:"getActiveSubOrders"}),this.$store.dispatch("multipleRequest",a)},stopOrder:function(t){this.order=t,this.showResume=!0},getTitle:function(t){var e=this.$store.getters.customers,r=e.find(function(e){return e.id_rent==t.customer_id}),s=t.note?t.note:"",n=function(t){if(!t)return"";var e=t.fname?t.fname:"",r=t.sname?t.sname[0]+".":"",s=t.tname?t.tname[0]+".":"";return"".concat(e," ").concat(r," ").concat(s)};return r?n(r)+" "+r.phone:"".concat(s)},getProductName:function(t){var e=this.$store.getters.products.find(function(e){return e.id_rent==t});return e.name},getExtAccessories:function(t){var e=this;if(!t)return[];var r=t.split(","),s=r?r.map(function(t){return t.trim()}):[],n=s.map(function(t){return t=e.$store.getters.accessories.find(function(e){return e.id_rent===t}),t}),o=n.map(function(t){var e=t.name?t.name[0]:"";return e});return o}}),computed:{orders:function(){var t=this;return this.$store.getters.activeCategory,this.$store.getters.activeOrders.reduce(function(e,r){r.format_start_time=t.getStartTime(r.start_time),r.title=t.getTitle(r);var s=t.$store.getters.activeSubOrders.filter(function(t){return t.order_id===r.id_rent}),n=s.map(function(e){return e.product_name=t.getProductName(e.product_id),e.extAccessories=t.getExtAccessories(e.accessories),e});return r.subOrders=n,e.push(r),e},[])},ordersByCategory:function(){var t=this,e=function(e){var r=t.$store.getters.products.find(function(t){return t.id_rent===e.product_id}),s=t.$store.getters.activeCategory;return r.category===s.id_rent};return this.orders.reduce(function(t,r){var s=r.subOrders.filter(function(t){return e(t)});return 0===s.length?t:(r.subOrders=s,t.push(r),t)},[])},length:function(){for(var t=0,e=this.ordersByCategory,r=0;r<e.length;r+=1)for(var s=e[r].subOrders,n=0;n<s.length;n+=1)t+=1;return t}}},Fe=Ve,Je=(r("fc23"),Object(f["a"])(Fe,kt,St,!1,null,"5866655e",null)),We=Je.exports,Ke=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"add-order details"},[r("h3",["newOrder"===t.status?r("span",[t._v("Новый заказ #"+t._s(t.order.id_rent))]):r("span",[t._v("Добавить товар к заказу #"+t._s(t.order.id_rent))])]),r("form",{on:{submit:function(t){t.preventDefault()}}},[r("table",[r("tr",[r("td",[t._v("Товар")]),r("td",[t._v(t._s(t.product.name))])]),r("tr",[r("td",[t._v("Группа")]),r("td",[r("Position",{attrs:{position:t.getPosition()},on:{setPosition:function(e){return t.setPosition(e)}}})],1)]),r("tr",[r("td",[t._v("Аванс")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.order.advance,expression:"order.advance"}],staticClass:"add-order__input add-order__input--advance",attrs:{placeholder:"0 руб"},domProps:{value:t.order.advance},on:{input:function(e){e.target.composing||t.$set(t.order,"advance",e.target.value)}}})])]),r("tr",[r("td",{staticClass:"customer"},[t._v("Клиент")]),r("td",[r("SelectCustomer",{attrs:{id:"select_customer",customer:t.order.customer_id,focus:!t.order.customer_id},on:{setCustomer:function(e){return t.setCustomer(e)}}})],1)]),r("tr",[r("td",[t._v("Залог")]),r("td",[r("SelectDeposit",{attrs:{deposit:t.order.deposit},on:{setDeposit:function(e){return t.setDeposit(e)}}})],1)]),r("tr",[r("td",[t._v("Примечание")]),r("td",[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.order.note,expression:"order.note"}],staticClass:"add-order__input add-order__input--note",attrs:{cols:"30",rows:"3"},domProps:{value:t.order.note},on:{input:function(e){e.target.composing||t.$set(t.order,"note",e.target.value)}}})])]),r("tr",[r("td",[t._v("Акция")]),r("td",[r("SelectPromotion",{attrs:{promotion:t.order.promotion},on:{setPromotion:function(e){return t.setPromotion(e)}}})],1)]),r("tr",[r("td",[t._v("Аксессуары")]),r("td",[r("SelectAccessories",{attrs:{accessory:t.subOrder.accessories},on:{setAccessories:function(e){return t.setAccessories(e)}}})],1)]),r("tr",[r("td",[t._v("Тарифный план")]),r("td",[r("SelectTariff",{attrs:{"data-tariffs":t.tariffs,"data-tariff-default":t.subOrder.tariff_id?t.subOrder.tariff_id:t.product.tariff_default},on:{setTariff:function(e){return t.setTariff(e)}}})],1)])]),r("div",{staticClass:"btn-group"},[r("button",{on:{click:function(e){return e.preventDefault(),t.save(e)}}},[t._v("Сохранить")]),r("button",{attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.close(e)}}},[t._v("Отмена")])])])])])},Qe=[],Xe=function(t){var e=t.fname?t.fname:"",r=t.sname?t.sname:"",s=t.tname?t.tname:"";return"".concat(e," ").concat(r," ").concat(s).trim()},Ze=Xe;function tr(){var t={id_rent:null,status:null,start_time:null,order_id_position:null,advance:null,note:null,products:null,promotion:null,customer_id:null,deposit:null};return t}var er={name:"DetailsOrder",props:{product:Object},components:{Position:re,SelectCustomer:le,SelectAccessories:he,SelectTariff:ye,SelectPromotion:je,SelectDeposit:Ie},created:function(){this.isSerial()?this.addSubOrder(this.getLastId()):this.newOrder()},data:function(){return{order:{status:null,start_time:null,id_rent:null,order_id_position:null,advance:null,note:null,products:null,promotion:null,customer_id:null,deposit:null},subOrder:{id_rent:null,order_id:null,product_id:null,tariff_id:null,accessories:null,bill:0,bill_rent:0,bill_access:0,sale:0,paid:!1,pause_start:0,pause_time:0,end_time:null,note:null,status:null},status:null}},methods:{isSerial:function(){var t=this.$store.getters.generalSettings.lastOrderTime||!1,e=this.$store.getters.generalSettings.lastOrderInterval,r=this.$store.getters.now,s=this.getLastId(),n=this.orders.find(function(t){return t.id_rent==s});return!(!n||"END"===n.status||"DEL"===n.status)&&(t&&r-t<e)},getLastId:function(){var t=this.$store.getters.activeOrders.map(function(t){return t.id_rent});return Math.max.apply(Math,Object(x["a"])(t))},close:function(){this.$emit("close")},save:function(){if("newOrder"==this.status){var t={lastOrderTime:Date.now()};this.$store.dispatch("multipleRequest",[{cmd:"newOrder",value:this.order},{cmd:"newSubOrder",value:this.subOrder},{cmd:"setGeneralSettings",value:t},{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"},{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getCustomers"},{cmd:"getAccessories"},{cmd:"getGeneralSettings"}])}"addSubOrder"==this.status&&this.$store.dispatch("multipleRequest",[{cmd:"newSubOrder",value:this.subOrder},{cmd:"changeOrder",value:this.order},{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"},{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getCustomers"},{cmd:"getAccessories"},{cmd:"getGeneralSettings"}]),this.close()},newOrder:function(t){this.order=tr(),this.order.status="ACTIVE",this.order.start_time=Date.now()+this.registrationTime,this.order.id_rent=null,this.order.order_id_position=t||this.getPosition("new");var e=this.getCustomer();this.order.customer_id=e?e.id_rent:null,this.order.customer_name=e?Ze(e):null,this.subOrder.id_rent=null,this.subOrder.product_id=this.product.id_rent,this.subOrder.tariff_id=this.product.tariff_default,this.subOrder.order_id=this.order.id_rent,this.subOrder.status="ACTIVE",this.subOrder.pause_time=0,this.status="newOrder"},addSubOrder:function(t){if(t){var e=this.orders.find(function(e){return e.id_rent==t});e||console.log("order not found!"),this.order=Object(y["a"])(e),this.subOrder.id_rent=null,this.subOrder.product_id=this.product.id_rent,this.subOrder.tariff_id=this.product.tariff_default,this.subOrder.order_id=this.order.id_rent,this.subOrder.status="ACTIVE",this.subOrder.pause_time=0,this.status="addSubOrder"}else console.log("empty order_id!")},getPosition:function(t){var e=this,r=function(){var t=e.$store.getters.activeOrders,r=15,s=null,n=function e(r){return s=t.find(function(t){return t.order_id_position==r})?s:r,r<1?s:e(r-1)},o=n(r);return+o};return"new"==t?r():"newOrder"==this.status?r():"addSubOrder"==this.status?this.order.order_id_position:void 0},setPosition:function(t){var e=t.order_id,r=t.order_id_position;this.orders.find(function(t){return t.id_rent==e})?this.addSubOrder(e):this.newOrder(r)},getCustomer:function(){var t=this.$store.getters.lastCustomer,e=36e4;return Date.parse(t.created)+e>Date.now()?t:null},setCustomer:function(t){if(t){this.order.customer_id=t.id_rent;var e=t.fname?t.fname:"",r=t.sname?t.sname:"",s=t.tname?t.tname:"";this.order.customer_name="".concat(e," ").concat(r," ").concat(s)}},setDeposit:function(t){t&&(this.order.deposit=t.id_rent)},setPromotion:function(t){t&&(this.order.promotion=t.id)},setAccessories:function(t){this.subOrder.accessories=t},setTariff:function(t){this.subOrder.tariff_id=t.id_rent}},computed:{orders:function(){return this.$store.getters.activeOrders},customers:function(){return this.$store.getters.customers},deposits:function(){return this.$store.getters.depositList},promotions:function(){return this.$store.getters.promotions},accessories:function(){return this.$store.getters.accessories},tariffs:function(){var t=this;if(this.product.id_rent){var e=this.product.tariff_ids.split(","),r=e.reduce(function(e,r){var s=t.$store.getters.tariffs.find(function(t){return t.id_rent===r});return s&&e.push(s),e},[]);return r}},registrationTime:function(){return+this.$store.getters.generalSettings.registration_time}}},rr=er,sr=(r("f888"),r("6c53"),Object(f["a"])(rr,Ke,Qe,!1,null,"56f80fab",null)),nr=sr.exports,or={components:{productList:yt,orderList:We,DetailsOrder:nr},data:function(){return{product:{},order:{},subOrder:null,show:!1}},methods:{addOrder:function(t){this.product=t,this.show=!0},onClose:function(){this.show=!1},updateOrders:function(){var t=this,e=this.$store.getters.getGeneralSettings.timeToUpdateMonitor;e>0&&setInterval(function(){var e=[{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"}];t.$store.dispatch("multipleRequest",e)},1e3*e)}}},ir=or,ar=(r("cde3"),Object(f["a"])(ir,st,nt,!1,null,"34d0bd8a",null)),cr=ar.exports,ur=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"history"},[r("div",{staticClass:"totals"},[r("table",[r("tr",[t._m(0),r("td",[t._v("Наличные: "+t._s(t.coin)+" руб.")]),r("td",[t._v("По карте: "+t._s(t.card)+" руб.")]),r("td",[t._v("Всего: "+t._s(t.total)+" руб.")])])])]),r("input",{staticClass:"input__serch",attrs:{placeholder:"Начните вводить фамилию или название"},on:{input:function(e){return t.search()}}}),r("h2",[t._v("История заказов")]),t.orders&&t.orders.length>0?r("table",{staticClass:"history__table",attrs:{cellspacing:"0"}},[t._m(1),t._l(t.orders.filter(t.filt),function(e){return r("tr",{key:e.id_rent,on:{click:function(r){return t.onClick(e)}}},[r("td",[t._v("\n                "+t._s(e.id_rent)+"\n            ")]),r("td",[t._v("                    \n                "+t._s(e.customerName)+"                \n            ")]),r("td",{staticStyle:{"text-align":"right"}},[t._v("\n                "+t._s(t.shortDate(e.start_time))+"\n            ")]),r("td",{staticStyle:{"text-align":"right"}},[t._v("\n                "+t._s(e.play_time)+"\n            ")]),r("td",{staticStyle:{"padding-left":"20px"}},t._l(e.products,function(s,n){return r("div",{key:e.id_rent+"_"+s.id_rent+"_"+n,staticClass:"product"},[t._v("\n                    "+t._s(s.name)+"\n                ")])}),0),r("td",{staticStyle:{"text-align":"right"}},[t._v("\n                "+t._s(e.bill)+" руб\n            ")])])})],2):r("div",[t._v("Здесь пока пусто..")]),t.show?r("Details",{attrs:{_order:t.order},on:{close:t.onClose}}):t._e()],1)},lr=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("b",[t._v("Итого за день:")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",{staticClass:"tr__caption"},[r("th",[t._v("id")]),r("th",[t._v("ФИО")]),r("th",[t._v("Начало")]),r("th",[t._v("Длительность")]),r("th",[t._v("Товар")]),r("th",[t._v("Стоимость")])])}],dr=(r("55dd"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details resume"},[r("h2",{staticClass:"resume__caption"},[t._v("Заказ # "+t._s(t.order.id_rent))]),r("table",{staticClass:"resume__main-table"},[r("tr",[r("td",[t._v("Клиент")]),r("td",[t.order.customerName?r("span",[t._v(t._s(t.order.customerName))]):r("span",[t._v("-")])])]),r("tr",[r("td",[t._v("Залог")]),r("td",[t.deposit?r("span",[t._v(t._s(t.deposit.name))]):r("span",[t._v("-")])])]),r("tr",[r("td",[t._v("Начало")]),r("td",[t._v(t._s(t.shortDate(t.order.start_time)))])]),r("tr",[r("td",[t._v("Завершение")]),r("td",[t._v(t._s(t.shortDate(t.order.end_time)))])]),r("tr",[r("td",[t._v("Продолжительность")]),r("td",[t._v(t._s(t.order.play_time))])]),t.order.note?r("tr",[r("td",[t._v("Примечание")]),r("td",[t._v(t._s(t.order.note))])]):t._e()]),r("div",{staticClass:"products"},[r("ul",{staticClass:"products__list"},[t._l(t.subOrders,function(e){return r("li",{key:e.id_rent,staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",[t._v(t._s(e.product_name))]),"DEL"===e.status?r("span",{staticStyle:{color:"red"},attrs:{title:e.end_time+" "+e.note}},[t._v("✖")]):r("span",[t._v("\n                                "+t._s(e.bill_rent)+" руб.\n                            ")])]),r("ul",{staticClass:"products__access-list"},t._l(e.accessories,function(e){return r("li",{key:e.id_rent,staticClass:"products__access-item products__line"},[r("span",{staticClass:"products__arrow"},[t._v(" "+t._s(e.name))]),r("span",[t._v(t._s(e.bill_access)+" руб.")])])}),0)])}),r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Итого")]),r("span",{staticClass:"products__text-resume"},[t.billRentAccess>t.billRentAccessSale?r("s",{staticStyle:{"margin-right":"5px"}},[t._v("\n                                    "+t._s(t.billRentAccess)+" \n                                ")]):t._e(),t._v("\n                                "+t._s(t.billRentAccessSale)+" руб.\n                            ")])])]),t.order.off_balance>0?r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Погашена задолженость")]),r("span",{staticClass:"products__text-resume"},[t._v("\n                                "+t._s(t.order.off_balance)+" руб.\n                            ")])])]):t._e(),t.order.off_balance<0?r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Списано с баланса")]),r("span",{staticClass:"products__text-resume"},[t._v("\n                                "+t._s(Math.abs(t.order.off_balance))+" руб.\n                            ")])])]):t._e(),t.order.advance>0?r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Внесен аванс")]),r("span",{staticClass:"products__text-resume"},[t._v("\n                                "+t._s(t.order.advance)+" руб.\n                            ")])])]):t._e(),t.paidCoin>0?r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Оплачено наличными")]),r("span",{staticClass:"products__text-resume"},[t._v("\n                                "+t._s(t.paidCoin+t.offBalance-t.order.advance)+" руб.\n                            ")])])]):t._e(),t.paidCard>0?r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Оплачено картой")]),r("span",{staticClass:"products__text-resume"},[t._v("\n                                "+t._s(t.paidCard+t.offBalance-t.order.advance)+" руб.\n                            ")])])]):t._e(),t.paidCard+t.paidCoin<0?r("li",{staticClass:"products__item"},[r("div",{staticClass:"products__line"},[r("span",{staticClass:"products__text-resume"},[t._v("Сдача")]),r("span",{staticClass:"products__text-resume"},[t._v("\n                                "+t._s(t.paidCoin+t.offBalance-t.order.advance)+" руб.\n                            ")])])]):t._e()],2)]),r("button",{staticClass:"details__close",on:{click:function(e){return e.preventDefault(),t.close(e)}}})])])}),fr=[],pr={props:{_order:Object},data:function(){return{order:Object(y["a"])(this._order)}},beforeCreate:function(){this.$store.dispatch("getAccessories")},created:function(){this.order.abs="asdfasdf"},methods:{close:function(){this.$emit("close")},makeAccessories:function(t){var e=this;if(!t.accessories)return[];var r=t.accessories.split(","),s=r?r.map(function(t){return t.trim()}):[],n=s.reduce(function(r,s){var n=Object(y["a"])(e.$store.getters.accessories.find(function(t){return t.id_rent===s}));if(!n)return r;var o=xt(n.type,n.value,t.bill_rent);return n.bill_access=At(o),r.push(n),r},[]);return n},shortDate:function(t){return Mt["a"]("DD MMMM YYYY HH:mm",t)}},computed:{subOrders:function(){var t=this,e=this.$store.getters.subOrders.filter(function(e){return e.order_id===t.order.id_rent});return e.reduce(function(e,r){var s=Object(y["a"])(r),n=t.$store.getters.products.find(function(t){return t.id_rent===s.product_id});return s.product_name=n?n.name:"Нет имени",s.accessories=t.makeAccessories(s),e.push(s),e},[])},billRentAccess:function(){return this.subOrders.reduce(function(t,e){return t+=+e.bill_rent+ +e.bill_access,t},0)},billRentAccessSale:function(){var t=this.subOrders.reduce(function(t,e){return t+=+e.sale,t},0);return this.billRentAccess-t},deposit:function(){var t=this;return this.$store.getters.deposits.find(function(e){return e.id_rent===+t.order.deposit})},paidCoin:function(){var t=this.subOrders.reduce(function(t,e){return"coin"===e.paid&&(t+=+e.bill_rent,t+=+e.bill_access,t-=+e.sale),t},0);return t},paidCard:function(){var t=this.subOrders.reduce(function(t,e){return"card"===e.paid&&(t+=+e.bill_rent,t+=+e.bill_access,t-=+e.sale),t},0);return t},offBalance:function(){return+this.order.off_balance},bill:function(){return this.paidCard+this.paidCoin+this.offBalance},changeMoney:function(){return this.order.advance<=0?0:0!==this.offBalance?+this.order.advance-this.offBalance:void 0}}},_r=pr,mr=(r("8066"),Object(f["a"])(_r,dr,fr,!1,null,"a061c868",null)),hr=mr.exports,vr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"totals"},[r("table",[r("tr",[t._m(0),r("td",[t._v("Наличные: "+t._s(t.coin)+" руб.")]),r("td",[t._v("По карте: "+t._s(t.card)+" руб.")]),r("td",[t._v("Всего: "+t._s(t.total)+" руб.")])])])])},gr=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("b",[t._v("Итого за день:")])])}],br={beforeCreate:function(){this.$store.dispatch("getSubOrders")},data:function(){return{}},methods:{getBill:function(t){return+t.bill_rent+ +t.bill_access-+t.sale}},computed:{currentSubOrders:function(){var t=function(t){var e=new Date(t);if(!F(e))return console.warn("Totals: date parse error"),!1;var r=new Date;return e.getDate()===r.getDate()&&e.getMonth()===r.getMonth()&&e.getYear()===r.getYear()};return this.$store.getters.subOrders.filter(function(e){return t(e.end_time)})},coin:function(){var t=this,e=this.currentSubOrders.filter(function(t){return"coin"===t.paid});return e.reduce(function(e,r){return e+=t.getBill(r),e},0)},card:function(){var t=this,e=this.currentSubOrders.filter(function(t){return"card"===t.paid});return e.reduce(function(e,r){return e+=t.getBill(r),e},0)},total:function(){return this.coin+this.card}}},Cr=br,Or=(r("8ebb"),Object(f["a"])(Cr,vr,gr,!1,null,"f5db2ee6",null)),yr=Or.exports,kr={name:"History",components:{Details:hr,Totals:yr},beforeCreate:function(){this.$store.dispatch("multipleRequest",[{cmd:"getOrders"},{cmd:"getSubOrders"},{cmd:"getProducts"},{cmd:"getCustomers"}])},data:function(){return{order:{},show:!1,filt:function(t){return t}}},methods:{search:function(){var t=this,e=event.target.value.trim();this.filt=function(r){var s=t.getProducts(r.id_rent),n=s.filter(function(t){var r=t?t.name:"";return r.toUpperCase().indexOf(e.toUpperCase())>=0});if(n&&n.length>0)return!0;var o=r.customerName.toUpperCase().indexOf(e.toUpperCase())>=0;return!!o||void 0}},onClick:function(t){this.order=t,this.show=!0},onClose:function(){this.show=!1},shortDate:function(t){var e=new Date,r=e.getDate(),s=new Date(t);if(!F(s))return"Ошибка парсинга";var n=s.getDate()===r?"HH:mm":"DD MMMM YYYY";return Mt["a"](n,s)},getEndTime:function(t){var e=this.$store.getters.subOrders.filter(function(e){return e.order_id===t}),r=e.reduce(function(t,e){return t||(t=e.end_time),Date.parse(t)<Date.parse(e.end_time)&&(t=e.end_time),t},null);return r},getCustomerName:function(t){if(!t)return"";var e=this.$store.getters.customers.find(function(e){return e.id_rent===t});return e||console.warn("History.index.getCustomerName: Клиент не найден!"),e?Ze(e):""},getProducts:function(t){var e=this,r=this.$store.getters.subOrders,s=r.filter(function(e){return e.order_id===t&&"DEL"!==e.status}),n=s.map(function(t){var r=e.$store.getters.products.find(function(e){return e.id_rent===t.product_id});return r||null});return n.filter(function(t){return t})},getBill:function(t){var e=this.$store.getters.subOrders.filter(function(e){return e.order_id===t}),r=e.reduce(function(t,e){return t+=+e.bill_rent,t+=+e.bill_access,t-=+e.sale,t},0);return r},getStatus:function(t){var e=t.status;switch(e){case"ACTIVE":return"В прокате";case"END":return"Завершен";default:return e}},getTimePlay:function(t,e,r){var s=Date.parse(e),n=Date.parse(t);return isNaN(s)||isNaN(n)?"Ошибка парсинга. order_id = "+r:Tt(s-n)}},computed:{orders:function(){var t=this,e=this.$store.getters.orders.filter(function(t){return"END"===t.status}),r=e.reduce(function(e,r){var s=Object(y["a"])(r);return s.customerName=t.getCustomerName(s.customer_id),s.end_time=t.getEndTime(s.id_rent),s.play_time=t.getTimePlay(s.start_time,s.end_time,s.id_rent),s.products=t.getProducts(s.id_rent),s.bill=t.getBill(s.id_rent),s.formStatus=t.getStatus(s),e.push(s),e},[]);return r.sort(function(t,e){return Date.parse(e.end_time)-Date.parse(t.end_time)})},currentSubOrders:function(){var t=function(t,e){var r=new Date(t);if(!F(r))return console.warn("Totals: date parse error. subOrderId = "+e),!1;var s=new Date;return r.getDate()===s.getDate()&&r.getMonth()===s.getMonth()&&r.getYear()===s.getYear()};return this.$store.getters.subOrders.filter(function(e){return t(e.end_time,e.id_rent)})},coin:function(){var t=this.currentSubOrders.filter(function(t){return"coin"===t.paid});return t.reduce(function(t,e){return t+=+e.bill_rent+ +e.bill_access-+e.sale,t},0)},card:function(){var t=this.currentSubOrders.filter(function(t){return"card"===t.paid});return t.reduce(function(t,e){return t+=+e.bill_rent+ +e.bill_access-+e.sale,t},0)},total:function(){return this.coin+this.card}}},Sr=kr,Pr=(r("b97a"),Object(f["a"])(Sr,ur,lr,!1,null,"748c10dd",null)),wr=Pr.exports,$r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"customer"},[r("table",{staticClass:"customer__table"},[t._m(0),t._l(t.customers,function(e){return r("tr",{key:e.id_rent,on:{click:function(r){return t.onClick(e)}}},[r("td",[t._v(t._s(e.id_rent))]),r("td",[t._v(t._s(e.fname)+" "+t._s(e.sname)+" "+t._s(e.tname))]),r("td",[t._v(t._s(e.formatPhone))]),r("td",{staticClass:"col--sale"},[e&&e.sale>0?r("span",[t._v(t._s(e.sale)+" %")]):t._e()]),r("td",{staticClass:"col--balance"},[e&&0!=e.balance?r("span",[t._v(t._s(e.balance)+" р")]):t._e()])])})],2),r("div",{staticClass:"customer_buttons"},[r("button",{on:{click:function(e){return t.addCustomer()}}},[t._v("Добавить")])]),t.show?r("Details",{attrs:{customer:t.customer},on:{close:function(e){return t.onClose()}}}):t._e()],1)},jr=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("th",[t._v("id")]),r("th",[t._v("ФИО")]),r("th",[t._v("Телефон")]),r("th",[t._v("Скидка")]),r("th",[t._v("Баланс")])])}],Tr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details customer__details"},[r("h3",[t.customer.id?r("span",[t._v("Сведения о клиенте")]):r("span",[t._v("Добавить нового клиента")])]),r("form",{on:{input:t.onChange}},[r("table",[t.customer.id?r("tr",[r("td",[t._v("id")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.id_rent,expression:"C.id_rent"}],attrs:{type:"text",disabled:""},domProps:{value:t.C.id_rent},on:{input:function(e){e.target.composing||t.$set(t.C,"id_rent",e.target.value)}}})])]):t._e(),r("tr",[r("td",[t._v("Фамилия")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.fname,expression:"C.fname"}],ref:"fname",attrs:{type:"text",placeholder:"Фамилия"},domProps:{value:t.C.fname},on:{input:function(e){e.target.composing||t.$set(t.C,"fname",e.target.value)}}})])]),r("tr",[r("td",[t._v("Имя")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.sname,expression:"C.sname"}],attrs:{type:"text",placeholder:"Имя"},domProps:{value:t.C.sname},on:{input:function(e){e.target.composing||t.$set(t.C,"sname",e.target.value)}}})])]),r("tr",[r("td",[t._v("Отчество")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.tname,expression:"C.tname"}],attrs:{type:"text",placeholder:"Отчество"},domProps:{value:t.C.tname},on:{input:function(e){e.target.composing||t.$set(t.C,"tname",e.target.value)}}})])]),r("tr",[r("td",[t._v("Телефон")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.phone,expression:"C.phone"}],ref:"phone",attrs:{type:"text",placeholder:"Номер мобильного телефона"},domProps:{value:t.C.phone},on:{input:function(e){e.target.composing||t.$set(t.C,"phone",e.target.value)}}})])]),r("tr",[r("td",[t._v("Паспорт")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.passport,expression:"C.passport"}],ref:"pass",attrs:{type:"text",placeholder:"Серия и номер паспорта"},domProps:{value:t.C.passport},on:{input:function(e){e.target.composing||t.$set(t.C,"passport",e.target.value)}}})])]),r("tr",[r("td",[t._v("Дата рождения")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.birth_date,expression:"C.birth_date"}],attrs:{type:"date",placeholder:"Дата рождения"},domProps:{value:t.C.birth_date},on:{input:function(e){e.target.composing||t.$set(t.C,"birth_date",e.target.value)}}})])]),r("tr",[r("td",[t._v("Адрес")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.address,expression:"C.address"}],attrs:{type:"text",placeholder:"Адрес"},domProps:{value:t.C.address},on:{input:function(e){e.target.composing||t.$set(t.C,"address",e.target.value)}}})])]),r("tr",[r("td",{staticClass:"customer_td--sale"},[t._v("Скидка, %")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.sale,expression:"C.sale"}],attrs:{type:"text",placeholder:"Скидка, %"},domProps:{value:t.C.sale},on:{input:function(e){e.target.composing||t.$set(t.C,"sale",e.target.value)}}})])]),r("tr",[r("td",{staticClass:"customer_td--balance"},[t._v("Баланс, р.")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.C.balance,expression:"C.balance"}],attrs:{type:"text",placeholder:"Текущий баланс, руб"},domProps:{value:t.C.balance},on:{input:function(e){e.target.composing||t.$set(t.C,"balance",e.target.value)}}})])]),r("tr",[r("td",[t._v("Примечание")]),r("td",[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.C.note,expression:"C.note"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"Дополнительные сведения о клиенте"},domProps:{value:t.C.note},on:{input:function(e){e.target.composing||t.$set(t.C,"note",e.target.value)}}})])])])]),r("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),r("button",{on:{click:t.close}},[t._v("Отмена")]),t.customer.id?r("button",{on:{click:t.toDelete}},[t._v("Удалить")]):t._e(),r("div",{staticClass:"details__close",on:{click:t.close}})])])},Ar=[],Dr=(r("a481"),r("23d1")),xr=r.n(Dr),Rr={props:{customer:Object},mounted:function(){var t=this,e=function(){var e=new xr.a("+7 (999) 999-99-99");e.mask(t.$refs.phone);var r=new xr.a("9999 999999");r.mask(t.$refs.pass)};e();var r=function(){t.C.id_rent||t.$nextTick(function(){return t.$refs.fname.focus()})};r()},data:function(){return{C:Object(y["a"])(this.customer),change:!1}},methods:{save:function(){if(!this.C.fname)return alert("Введите фамилию"),!1;var t=function(t){return t.replace(/[^.\d]+/g,"")};this.C.phone=t(this.C.phone),this.$store.dispatch("multipleRequest",[{cmd:"setCustomer",value:this.C},{cmd:"getCustomers"}]),this.close()},close:function(){this.$emit("close")},toDelete:function(){var t=this.C.id_rent;confirm("Вы действительно хотите удалить клиента #".concat(t,"?"))&&this.$store.dispatch("multipleRequest",[{cmd:"deleteCustomer",value:t},{cmd:"getCustomers"}]),this.close()},onChange:function(){this.change=!0}}},Ir=Rr,Er=(r("07d4"),Object(f["a"])(Ir,Tr,Ar,!1,null,"01b295bc",null)),Mr=Er.exports,Nr={components:{Details:Mr},beforeCreate:function(){this.$store.dispatch("getCustomers")},data:function(){return{customer:{},show:!1}},methods:{onClick:function(t){this.customer=t,this.show=!0},addCustomer:function(){this.show=!0,this.customer={}},onClose:function(){this.show=!1},preparePhone:function(){}},computed:{customers:function(){var t=Object(y["a"])(this.$store.getters.customers);return t.reduce(function(t,e){if(!e.phone||e.phone.length<11)return e.formatPhone=e.phone,t.push(e),t;var r=e.phone;return e.formatPhone="+".concat(r[0]," (").concat(r[1]).concat(r[2]).concat(r[3],") ").concat(r[4]).concat(r[5]).concat(r[6],"-").concat(r[7]).concat(r[8],"-").concat(r[9]).concat(r[10]),t.push(e),t},[])}}},qr=Nr,Br=(r("5238"),Object(f["a"])(qr,$r,jr,!1,null,null,null)),zr=Br.exports,Ur=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"option option-rental-point"},[r("h3",[t._v(t._s(t.message))]),r("table",{staticClass:"table table__rental-info"},[r("tr",[r("td",[t._v("ID")]),r("td",[r("input",{attrs:{disabled:""},domProps:{value:t.point.id_rent}})])]),r("tr",[r("td",[t._v("Логотип")]),r("td",[r("input",{attrs:{type:"file"},on:{input:function(e){return t.set("logo",e.target.value)}}})])]),r("tr",[r("td",[t._v("Название")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.point.name,expression:"point.name"}],domProps:{value:t.point.name},on:{input:[function(e){e.target.composing||t.$set(t.point,"name",e.target.value)},function(e){return t.set("name",e.target.value)}]}})])]),r("tr",[r("td",[t._v("Город")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.point.city,expression:"point.city"}],domProps:{value:t.point.city},on:{input:[function(e){e.target.composing||t.$set(t.point,"city",e.target.value)},function(e){return t.set("city",e.target.value)}]}})])]),r("tr",[r("td",[t._v("Адрес")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.point.address,expression:"point.address"}],domProps:{value:t.point.address},on:{input:[function(e){e.target.composing||t.$set(t.point,"address",e.target.value)},function(e){return t.set("address",e.target.value)}]}})])]),r("tr",[r("td",[t._v("Время работы")]),r("td",[r("div",{staticClass:"options__time-wrap"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.point.time_open,expression:"point.time_open"}],staticClass:"options__input--time",staticStyle:{"margin-right":"5px"},attrs:{type:"time",placeholder:"open:"},domProps:{value:t.point.time_open},on:{input:[function(e){e.target.composing||t.$set(t.point,"time_open",e.target.value)},function(e){return t.set("time_open",e.target.value)}]}}),r("input",{directives:[{name:"model",rawName:"v-model",value:t.point.time_close,expression:"point.time_close"}],staticClass:"options__input--time",attrs:{type:"time",placeholder:"close:"},domProps:{value:t.point.time_close},on:{input:[function(e){e.target.composing||t.$set(t.point,"time_close",e.target.value)},function(e){return t.set("time_close",e.target.value)}]}})])])]),r("tr",[r("td",[t._v("Телефон")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.point.phone,expression:"point.phone"}],domProps:{value:t.point.phone},on:{input:[function(e){e.target.composing||t.$set(t.point,"phone",e.target.value)},function(e){return t.set("phone",e.target.value)}]}})])]),r("tr",[r("td",[t._v("Краткое описание")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.point.description_short,expression:"point.description_short"}],domProps:{value:t.point.description_short},on:{input:[function(e){e.target.composing||t.$set(t.point,"description_short",e.target.value)},function(e){return t.set("description_short",e.target.value)}]}})])]),r("tr",[r("td",[t._v("Описание")]),r("td",[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.point.description,expression:"point.description"}],domProps:{value:t.point.description},on:{input:[function(e){e.target.composing||t.$set(t.point,"description",e.target.value)},function(e){return t.set("discriptions",e.target.value)}]}})])]),t._m(0)]),r("div",{staticClass:"options__buttons-wrap"},[r("button",{staticClass:"option-general__button",on:{click:t.save}},[t._v("Применить")]),r("button",{on:{click:t.logout}},[t._v("Выйти из приложения")])])])},Lr=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("td",{attrs:{colspan:"2"}},[r("iframe",{attrs:{src:"https://yandex.ru/map-widget/v1/?um=constructor%3A548e8cd2e20fb08de643851d0b02c3287a5f0ae16cca22e2219bdf303975b4ad&source=constructor",width:"500",height:"400",frameborder:"0"}})])])}],Yr={beforeCreate:function(){this.$store.dispatch("getRentalPointInfo")},data:function(){return{change:!1,message:""}},methods:{set:function(t,e){this.point[t]=e},save:function(){this.$store.dispatch("setRentalPointInfo",this.point).then(this.showMessage("Данные обновлены"))},logout:function(){this.$store.dispatch("authLogout"),this.$router.push("/Login")},showMessage:function(t){this.message=t}},computed:{point:function(){return Object(y["a"])(this.$store.getters.rentalPointInfo)}}},Hr=Yr,Gr=(r("4202"),Object(f["a"])(Hr,Ur,Lr,!1,null,"e8d2c872",null)),Vr=Gr.exports,Fr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"option option-general"},[r("table",[r("tr",[r("td",[t._v("Округление")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.rent_round_bill,expression:"settings.rent_round_bill"}],domProps:{value:t.settings.rent_round_bill},on:{input:function(e){e.target.composing||t.$set(t.settings,"rent_round_bill",e.target.value)}}})]),r("td",[t._v("(руб)")])]),r("tr",[r("td",{attrs:{title:"Минимальная стоимость тарифа устанавливается от начала проката до указанного времени"}},[t._v("\n                Порог минимальной стоимости\n            ")]),r("td",[r("input",{domProps:{value:t.rentMinTime},on:{input:function(e){return t.set("rent_min_time",60*e.target.value*1e3)}}})]),r("td",[t._v("(мин)")])]),r("tr",[r("td",[t._v("Время на оформление")]),r("td",[r("input",{domProps:{value:t.registrationTime},on:{input:function(e){return t.set("registration_time",60*e.target.value*1e3)}}})]),r("td",[t._v("(мин)")])]),r("tr",[r("td",[t._v("Интервал обновления монитора")]),r("td",[r("input",{domProps:{value:t.timeToUpdateMonitor},on:{input:function(e){return t.set("timeToUpdateMonitor",1e3*e.target.value)}}})]),r("td",[t._v("(сек)")])])]),r("button",{staticClass:"option-general__button",on:{click:t.send}},[t._v("Применить")])])},Jr=[],Wr={data:function(){return{settings:Object(y["a"])(this.$store.getters.generalSettings),change:!1}},methods:{set:function(t,e){this.settings[t]=e},send:function(){this.$store.dispatch("setGeneralSettings",this.settings)}},computed:{rentMinTime:function(){return this.$store.getters.generalSettings.rent_min_time/60/1e3},registrationTime:function(){return this.$store.getters.generalSettings.registration_time/60/1e3},timeToUpdateMonitor:function(){return this.$store.getters.generalSettings.timeToUpdateMonitor/1e3}},watch:{timeToUpdateMonitor:function(){console.warn("timeToUpdateMonitor",this.timeToUpdateMonitor);var t=this.timeToUpdateMonitor;t>0?this.$store.dispatch("startAutoUpdateOrders",1e3*t):this.$store.dispatch("stopAutoUpdateOrders")}}},Kr=Wr,Qr=(r("1f3a"),Object(f["a"])(Kr,Fr,Jr,!1,null,"775155df",null)),Xr=Qr.exports,Zr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"option option-tariffs"},[r("table",[t._m(0),t._l(t.tariffs,function(e){return r("tr",{key:e.id_rent,on:{click:function(r){return t.onClick(e)}}},[r("td",[t._v(t._s(e.name))]),r("td",[t._v(t._s(t.getType(e)))]),r("td",[t._v(t._s(t.getHours(e._h_h)))]),r("td",[t._v(t._s(e._h_min))]),r("td",[t._v(t._s(e._h_max))]),r("td",[t._v(t._s(e.cost))]),r("td",[t._v(t._s(e.note))])])})],2),r("button",{staticClass:"tariff__button tariff__button--add",on:{click:t.addTariff}},[t._v("Добавить")]),t.show?r("Details",{attrs:{_tariff:t.tariff},on:{close:t.onClose}}):t._e()],1)},ts=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("th",[t._v("Название")]),r("th",[t._v("Тип")]),r("th",[t._v("Расчасовка")]),r("th",[t._v("Мин")]),r("th",[t._v("Макс")]),r("th",[t._v("Стоим.")]),r("th",[t._v("Примечание")])])}],es=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details"},[r("h3",[t.tariff.id_rent?r("span",[t._v("Редактирование тарифа")]):r("span",[t._v("Новый тариф")])]),r("form",{on:{input:t.onChange}},[r("table",[r("tr",[r("td",[t._v("Название")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff.name,expression:"tariff.name"}],domProps:{value:t.tariff.name},on:{input:function(e){e.target.composing||t.$set(t.tariff,"name",e.target.value)}}})])]),r("tr",{staticClass:"details__tr details__tr--type"},[r("td",[t._v("Тип")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff.type,expression:"tariff.type"}],staticClass:"tariff__type",attrs:{name:"tariff__type",type:"radio",id:"tariff_type--h",value:"h"},domProps:{checked:"h"==t.tariff.type,checked:t._q(t.tariff.type,"h")},on:{change:function(e){return t.$set(t.tariff,"type","h")}}}),r("label",{staticClass:"tariff__type-label",attrs:{for:"tariff_type--h"}},[t._v("Почасовой")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff.type,expression:"tariff.type"}],staticClass:"tariff__type",attrs:{name:"tariff__type",type:"radio",id:"tariff_type--f",value:"f"},domProps:{checked:"f"==t.tariff.type,checked:t._q(t.tariff.type,"f")},on:{change:function(e){return t.$set(t.tariff,"type","f")}}}),r("label",{staticClass:"tariff__type-label",attrs:{for:"tariff_type--f"}},[t._v("Фиксированный")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff.type,expression:"tariff.type"}],staticClass:"tariff__type",attrs:{name:"tariff__type",type:"radio",id:"tariff_type--d",value:"d"},domProps:{checked:"d"==t.tariff.type,checked:t._q(t.tariff.type,"d")},on:{change:function(e){return t.$set(t.tariff,"type","d")}}}),r("label",{staticClass:"tariff__type-label",attrs:{for:"tariff_type--d"}},[t._v("Посуточный")])])]),"h"==t.tariff.type?r("tr",[t._m(0),r("td",[r("table",t._l(t.tariff._h_h,function(e,s){return r("tr",{key:s},[r("td",[t._v("\n                                    "+t._s(s+1)),t.tariff._h_h.length===s+1?r("span",[t._v("+")]):t._e(),t._v(" час\n                                ")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff._h_h[s],expression:"tariff._h_h[index]"}],domProps:{value:t.tariff._h_h[s]},on:{input:function(e){e.target.composing||t.$set(t.tariff._h_h,s,e.target.value)}}})])])}),0),r("button",{on:{click:t.addH}},[t._v("+")]),r("button",{on:{click:t.rmH}},[t._v("-")])])]):t._e(),"h"==t.tariff.type?r("tr",[r("td",[t._v("Мин")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff._h_min,expression:"tariff._h_min"}],domProps:{value:t.tariff._h_min},on:{input:function(e){e.target.composing||t.$set(t.tariff,"_h_min",e.target.value)}}})])]):t._e(),"h"==t.tariff.type?r("tr",[r("td",[t._v("Макс")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff._h_max,expression:"tariff._h_max"}],domProps:{value:t.tariff._h_max},on:{input:function(e){e.target.composing||t.$set(t.tariff,"_h_max",e.target.value)}}})])]):t._e(),"f"===t.tariff.type?r("tr",[t._m(1),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff.mileage,expression:"tariff.mileage"}],domProps:{value:t.tariff.mileage},on:{input:function(e){e.target.composing||t.$set(t.tariff,"mileage",e.target.value)}}})])]):t._e(),"h"!=t.tariff.type?r("tr",[r("td",[t._v("Стоимость")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff.cost,expression:"tariff.cost"}],domProps:{value:t.tariff.cost},on:{input:function(e){e.target.composing||t.$set(t.tariff,"cost",e.target.value)}}})])]):t._e(),r("tr",[r("td",[t._v("Примечание")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariff.note,expression:"tariff.note"}],domProps:{value:t.tariff.note},on:{input:function(e){e.target.composing||t.$set(t.tariff,"note",e.target.value)}}})])])])]),r("div",{staticClass:"btn-group"},[r("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),r("button",{on:{click:t.close}},[t._v("Отмена")]),t.tariff.id_rent?r("button",{on:{click:t.remove}},[t._v("Удалить")]):t._e()]),r("div",{staticClass:"details__close",on:{click:t.close}})])])},rs=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[t._v("Расчасовка,"),r("br"),t._v("руб")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[t._v("Пробег"),r("br"),r("small",[t._v("часов за весь период")])])}],ss={props:{_tariff:Object},components:{},data:function(){return{tariff:Object(y["a"])(this._tariff),change:!1}},methods:{save:function(){this.tariff._h_h=this.tariff._h_h?this.tariff._h_h.filter(function(t){if(t)return t}):"",this.tariff._h_h="h"===this.tariff.type?this.tariff._h_h:null,this.tariff.cost="h"===this.tariff.type?null:this.tariff.cost,this.tariff._d_min="h"!==this.tariff.type?null:this.tariff._d_min,this.tariff._d_max="h"!==this.tariff.type?null:this.tariff._d_max,this.$store.dispatch("setTariff",this.tariff),this.$emit("close")},close:function(){this.change?confirm("Изменения не сохранены. Вы уверены, что хотите выйти?")&&this.$emit("close"):this.$emit("close")},remove:function(){confirm("Вы действительно хотите удалить тариф '".concat(this.tariff.name,"'?"))&&(this.$store.dispatch("deleteTariff",this.tariff.id_rent),this.$emit("close"))},addH:function(t){t.preventDefault(),this.tariff._h_h||(this.tariff._h_h=[]),this.tariff._h_h.push(""),this.change=!0},rmH:function(t){t.preventDefault(),this.tariff._h_h&&(this.tariff._h_h.pop(),this.change=!0)},onChange:function(t){t.preventDefault(),this.change=!0}}},ns=ss,os=(r("ccba"),Object(f["a"])(ns,es,rs,!1,null,"4e9cf9df",null)),is=os.exports,as={components:{Details:is},beforeCreate:function(){this.$store.dispatch("getTariffs")},data:function(){return{tariff:{},show:!1}},methods:{onClick:function(t){this.show=!0,this.tariff=t},onClose:function(){this.show=!1,this.tariff={}},getHours:function(t){return t?t.reduce(function(t,e){return t+" ".concat(e)},""):null},addTariff:function(){this.show=!0,this.tariff={id_rent:null,type:"h",name:"",_h_h:[0],_h_max:null,_h_min:null,_d_before:null,_d_after:null,cost:null,mileage:0,note:""}},getType:function(t){if(!t||!t.type)return"Нет типа тарифа";switch(t.type){case"h":return"Почасовой";case"d":return"Посуточный";case"f":return"Фиксированный"}}},computed:{tariffs:function(){return this.$store.getters.tariffs}}},cs=as,us=(r("4836"),Object(f["a"])(cs,Zr,ts,!1,null,"0c63fe04",null)),ls=us.exports,ds=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"option option-accessories"},[r("table",[t._m(0),t._l(t.accessories,function(e){return r("tr",{key:e.id_rent,on:{click:function(r){return t.onClick(e)}}},[r("td",[t._v(t._s(e.id_rent))]),r("td",[t._v(t._s(e.name))]),r("td",[t._v(t._s(e.value))]),r("td",[t._v(t._s(e.type))])])})],2),r("button",{on:{click:t.newAccessory}},[t._v("Добавить")]),t.show?r("Details",{attrs:{payload:t.accessory},on:{close:t.onClose}}):t._e()],1)},fs=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("th",[t._v("id")]),r("th",[t._v("Название")]),r("th",[t._v("Значение")]),r("th",[t._v("Тип")])])}],ps=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details"},[r("h3",[t.accessory.id_rent?r("span",[t._v("Редактирование аксессуара")]):r("span",[t._v("Новый аксессуар")])]),r("form",{on:{input:t.onChange}},[r("table",[t.accessory.is_new?r("tr",[r("td",[t._v("id")]),r("td",[r("span",[t._v(t._s(t.accessory.id_rent))])])]):t._e(),r("tr",[r("td",[t._v("Название")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.accessory.name,expression:"accessory.name"}],domProps:{value:t.accessory.name},on:{input:function(e){e.target.composing||t.$set(t.accessory,"name",e.target.value)}}})])]),r("tr",[r("td",[t._v("Значение")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.accessory.value,expression:"accessory.value"}],domProps:{value:t.accessory.value},on:{input:function(e){e.target.composing||t.$set(t.accessory,"value",e.target.value)}}})])]),r("tr",[r("td",[t._v("Тип")]),r("td",[r("div",{staticClass:"wrap"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.accessory.type,expression:"accessory.type"}],attrs:{id:"access__type_rub",type:"radio",value:"rub",name:"type"},domProps:{checked:t._q(t.accessory.type,"rub")},on:{change:function(e){return t.$set(t.accessory,"type","rub")}}}),r("label",{attrs:{for:"access__type_rub"}},[t._v("руб")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.accessory.type,expression:"accessory.type"}],attrs:{id:"access__type_per",type:"radio",value:"%",name:"type"},domProps:{checked:t._q(t.accessory.type,"%")},on:{change:function(e){return t.$set(t.accessory,"type","%")}}}),r("label",{attrs:{for:"access__type_per"}},[t._v("%")])])])])])]),r("div",{staticClass:"btn-group"},[r("button",{attrs:{disabled:!t.change},on:{click:t.save}},[t._v("Сохранить")]),r("button",{on:{click:t.close}},[t._v("Отмена")]),t.accessory.id_rent?r("button",{on:{click:t.remove}},[t._v("Удалить")]):t._e()]),r("div",{staticClass:"details__close",on:{click:t.close}})])])},_s=[],ms={props:{payload:Object},data:function(){return{accessory:Object(y["a"])(this.payload),change:!1}},methods:{save:function(){this.$store.dispatch("setAccessory",this.accessory),this.$emit("close")},close:function(){this.change?confirm("Изменения не сохранены. Вы уверены, что хотите выйти?")&&this.$emit("close"):this.$emit("close")},remove:function(){confirm("Вы действительно хотите удалить тариф '".concat(this.accessory.name,"'?"))&&(this.$store.dispatch("deleteAccessory",this.accessory.id_rent),this.$emit("close"))},onChange:function(t){t.preventDefault(),this.change=!0}}},hs=ms,vs=(r("5754"),Object(f["a"])(hs,ps,_s,!1,null,"38a75786",null)),gs=vs.exports,bs={components:{Details:gs},beforeCreate:function(){this.$store.dispatch("getAccessories")},data:function(){return{show:!1,accessory:{}}},methods:{onClose:function(){this.accessory={},this.show=!1},onClick:function(t){this.accessory=Object(y["a"])(t),this.accessory.is_new=!0,this.show=!0},newAccessory:function(){this.show=!0,this.accessory={},this.accessory.is_new=!1,this.accessory.type="rub"}},computed:{accessories:function(){return this.$store.getters.accessories}}},Cs=bs,Os=(r("a1fa"),Object(f["a"])(Cs,ds,fs,!1,null,"28251a3c",null)),ys=Os.exports,ks=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"products"},[t.products&&t.products.length?[r("table",t._l(t.products,function(e){return r("tr",{key:e.id_rent,on:{click:function(r){return t.onClick(e)}}},[r("td",{staticClass:"product__td--status"},[r("span",{staticClass:"product__status",class:"product__status--"+e.status,attrs:{title:"Статус: "+e.status}})]),r("td",{on:{mousemove:function(r){return t.openPhoto(e)},mouseout:function(e){return t.closePhoto()}}},[r("Bike",{attrs:{_color:e.color,_type:+e.type}})],1),r("td",{attrs:{title:"Название"}},[t._v(t._s(e.name))])])}),0)]:[t._v("Нет товаров")],r("button",{staticClass:"products__button products__button--add",on:{click:function(e){return t.newProduct()}}},[t._v("Добавить")]),t.showDetails?r("Details",{attrs:{data:t.product},on:{close:t.onClose}}):t._e(),t.showPhoto?r("Photo",{staticClass:"photo",attrs:{product:t.product}}):t._e()],2)},Ss=[],Ps=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"canvas"},[r("div",{staticClass:"details"},[r("h3",[t.product.newProduct?r("span",[t._v("Новый товар")]):r("span",[t._v("Редактирование товара")])]),r("form",{on:{input:t.onChange}},[r("table",[r("tr",[r("td",[t._v("id")]),r("td",[r("input",{staticClass:"input",attrs:{disabled:""},domProps:{value:t.product.id_rent}})])]),r("tr",[r("td",[t._v("Название")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.product.name,expression:"product.name"}],staticClass:"input",domProps:{value:t.product.name},on:{input:function(e){e.target.composing||t.$set(t.product,"name",e.target.value)}}})])]),r("tr",[r("td",[t._v("Фото")]),r("td",[r("label",{staticClass:"product__photo--label"},[[t.product.img?r("Photo",{staticClass:"details__photo",attrs:{product:t.product,refresh:t.refresh}}):r("div",{staticClass:"button"},[t._v("Добавить фото")])],r("input",{staticClass:"photo__input",attrs:{type:"file"},on:{input:function(e){return t.addImage(e)}}})],2),r("span",{staticClass:"details__status"},[t._v(t._s(t.uploadStatus))])])]),r("tr",[r("td",[t._v("Иконка")]),r("td",{staticClass:"bikes"},[r("div",{on:{click:function(e){return t.setType(1)}}},[r("Bike",{staticClass:"bike",class:{bike__active:1==t.product.type},style:{borderColor:t.product.color},attrs:{_color:t.product.color,_type:1}})],1),r("div",{on:{click:function(e){return t.setType(2)}}},[r("Bike",{staticClass:"bike",class:{bike__active:2==t.product.type},style:{borderColor:t.product.color},attrs:{_color:t.product.color,_type:2}})],1)])]),r("tr",[r("td",[t._v("Цвет")]),r("td",[r("Palette",{attrs:{_color:t.data.color},on:{setColor:function(e){return t.setColor(e)}}})],1)]),r("tr",[r("td",[t._v("Стоимость")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.product.cost,expression:"product.cost"}],staticClass:"input",domProps:{value:t.product.cost},on:{input:function(e){e.target.composing||t.$set(t.product,"cost",e.target.value)}}})])]),r("tr",{staticClass:"products_tr--tariffs"},[t._m(0),r("td",[r("Tariffs",{attrs:{data:t.product},on:{setTariffs:function(e){return t.setTariffs(e)},setTariffDefault:function(e){return t.setTariffDefault(e)}}})],1)]),r("tr",[r("td",[t._v("Категория")]),r("td",[r("Categories",{attrs:{productCategory:t.product.category},on:{setCategories:function(e){return t.setCategories(e)}}})],1)]),r("tr",[r("td",[t._v("Описание")]),r("td",[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.product.note,expression:"product.note"}],staticClass:"textarea",domProps:{value:t.product.note},on:{input:function(e){e.target.composing||t.$set(t.product,"note",e.target.value)}}})])]),r("tr",[r("td",[t._v("Размер")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.product.size,expression:"product.size"}],staticClass:"input",domProps:{value:t.product.size},on:{input:function(e){e.target.composing||t.$set(t.product,"size",e.target.value)}}})])]),r("tr",[r("td",[t._v("Статус")]),r("td",{staticClass:"details__td details__td--status"},[r("input",{attrs:{type:"radio",name:"status",value:"active",id:"status_active"},domProps:{checked:"active"==t.product.status},on:{click:function(e){return t.checkStatus(e)}}}),r("label",{attrs:{for:"status_active"}},[t._v("Active")]),r("input",{attrs:{type:"radio",name:"status",value:"off",id:"status_off"},domProps:{checked:"off"==t.product.status||!t.product.status},on:{click:function(e){return t.checkStatus(e)}}}),r("label",{attrs:{for:"status_off"}},[t._v("Off")])])])])]),r("div",{staticClass:"btn-group"},[r("button",{on:{click:t.save}},[t._v("Сохранить")]),r("button",{on:{click:t.close}},[t._v("Отмена")]),t.product.newProduct?t._e():r("button",{on:{click:t.remove}},[t._v("Удалить")])]),t.product.id_rent?r("p",{staticClass:"products__updated"},[t._v("Дата последнего изменения: "+t._s(t.product.updated))]):t._e(),r("div",{staticClass:"details__close",on:{click:t.close}})])])},ws=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[t._v("Тарифы,"),r("br"),t._v("по умолчанию")])}],$s=(r("96cf"),r("3b8d")),js=function(t){switch(t){case"image/jpeg":return".jpg";case"image/png":return".png"}},Ts=function(){var t=Object($s["a"])(regeneratorRuntime.mark(function t(e,r){var s,n,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e&&r&&r.getters.activePath){t.next=2;break}return t.abrupt("return",!1);case 2:return s=String(r.getters.activePath)+"libs/user_uploads.php",n={header:{"Content-Type":"multipart/form-data"}},t.next=6,E.a.post(s,e,n).then(function(t){console.log(t),o=t});case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}(),As=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tariffs"},[r("table",t._l(t.tariffs,function(e){return r("tr",{key:e.id_rent},[r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.check,expression:"tariff.check"}],staticClass:"checkbox",attrs:{id:"check__tariff-"+e.id_rent,type:"checkbox"},domProps:{checked:Array.isArray(e.check)?t._i(e.check,null)>-1:e.check},on:{change:[function(r){var s=e.check,n=r.target,o=!!n.checked;if(Array.isArray(s)){var i=null,a=t._i(s,i);n.checked?a<0&&t.$set(e,"check",s.concat([i])):a>-1&&t.$set(e,"check",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(e,"check",o)},t.setTariffs]}}),r("label",{staticClass:"tariffs__checkbox-lbl",attrs:{for:"check__tariff-"+e.id_rent,title:"Привязать к товару"}}),r("input",{directives:[{name:"model",rawName:"v-model",value:t.tariffDefault,expression:"tariffDefault"}],staticClass:"radio",attrs:{id:"radio__tariff-"+e.id_rent,type:"radio",name:"tariff_default"},domProps:{value:e.id_rent,checked:t._q(t.tariffDefault,e.id_rent)},on:{change:[function(r){t.tariffDefault=e.id_rent},t.setTariffDefault]}}),r("label",{attrs:{for:"radio__tariff-"+e.id_rent,title:"По умолчанию"}})]),r("td",[t._v(t._s(e.name))])])}),0)])},Ds=[],xs={props:{data:Object},data:function(){var t=this;return{tariffs:this.$store.getters.tariffs.map(function(e){var r=t.data.tariff_ids?t.data.tariff_ids.split(","):[];return e.check=!!r.find(function(t){return t===e.id_rent}),e.default=t.data.tariff_default==e.id_rent,e}),tariffDefault:this.data.tariff_default}},methods:{setTariffs:function(){var t=this.tariffs.filter(function(t){return 1==t.check}),e=t.map(function(t){return t.id_rent});this.$emit("setTariffs",e.join())},setTariffDefault:function(){this.$emit("setTariffDefault",this.tariffDefault)}}},Rs=xs,Is=(r("ca14"),Object(f["a"])(Rs,As,Ds,!1,null,"34f4c664",null)),Es=Is.exports,Ms=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"categories"},[r("ul",t._l(t.categories,function(e){return r("li",{key:e.name,staticClass:"categories__li"},[r("input",{attrs:{type:"radio",name:"category"},domProps:{checked:t.productCategory===e.id_rent},on:{change:function(r){return t.onSet(e.id_rent)}}}),t._v("\n            "+t._s(e.name)+"\n        ")])}),0)])},Ns=[],qs={props:{productCategory:String},data:function(){return{}},methods:{onSet:function(t){this.$emit("setCategories",t)}},computed:{categories:function(){return this.$store.getters.categories}}},Bs=qs,zs=(r("4e12"),Object(f["a"])(Bs,Ms,Ns,!1,null,"589f96fa",null)),Us=zs.exports,Ls=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"palette"},[r("div",{on:{click:function(e){t.open=!0}}}),t.open?r("ul",{staticClass:"colors"},t._l(t.palette,function(e){return r("li",{key:e,staticClass:"color",style:{borderColor:e},on:{click:function(r){return t.onClick(e)}}})}),0):t._e()])},Ys=[],Hs={props:{_color:String},components:{Bike:ft},data:function(){return{selectColor:this._color,open:!0,palette:["#ff0000","#0600ff","#397a00","#78ff00","#ff9c00","#b6b6b6","#3c3c3b","#6f00a2","#ffffff","#fcff00","#00deff"]}},methods:{onClick:function(t){this.selectColor=t,this.$emit("setColor",t)}}},Gs=Hs,Vs=(r("5dfc"),Object(f["a"])(Gs,Ls,Ys,!1,null,"45423326",null)),Fs=Vs.exports,Js={props:{data:Object},components:{Tariffs:Es,Categories:Us,Palette:Fs,Bike:ft,Photo:gt},data:function(){return{product:Object(y["a"])(this.data),change:!1,uploadStatus:"",refresh:!1}},methods:{checkStatus:function(t){this.product.status=t.target.value},check:function(){return this.product.name?this.product.tariff_ids?!!this.product.tariff_default||(console.log("empty tariff default"),alert("Укажите тариф по умолчанию"),!1):(console.log("empty tariffs"),alert("Укажите доступные тарифы"),!1):(console.log("empty product name"),alert("Укажите название товара"),!1)},addImage:function(){var t=Object($s["a"])(regeneratorRuntime.mark(function t(e){var r,s,n,o,i,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r=e.target.files[0],s=Math.floor(Date.now()/1e3),n=js(r.type),o="".concat(this.$store.getters.rentalPointInfo.id_rent,"_").concat(this.product.id_rent,"_").concat(s).concat(n),i=new FormData,i.set("file",r,o),this.uploadStatus="Загрузка ...",t.next=9,Ts(i,this.$store);case 9:a=t.sent,a&&(this.uploadStatus="Загрузка завершена",this.product.img="".concat(s).concat(n)),this.refresh=!0;case 12:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),save:function(){this.product.updated=Math.floor(Date.now()/1e3),this.check()&&(this.$store.dispatch("setProduct",this.product),this.$emit("close"))},close:function(){this.change?confirm("Изменения не сохранены. Вы уверены, что хотите выйти?")&&this.$emit("close"):this.$emit("close")},remove:function(){confirm("Вы уверены, что хотите безвозвратно удалить товар?")&&(this.$store.dispatch("deleteProduct",this.product.id_rent),this.$emit("close"))},onChange:function(t){t.preventDefault(),this.change=!0},setTariffs:function(t){this.product.tariff_ids=t},setTariffDefault:function(t){this.product.tariff_default=t},setCategories:function(t){this.product.category=t},setColor:function(t){this.product.color=t,this.change=!0},setType:function(t){this.product.type=t,this.change=!0}},computed:{tariffs:function(){return this.$store.getters.tariffs},categories:function(){return this.$store.getters.categories}}},Ws=Js,Ks=(r("a570"),Object(f["a"])(Ws,Ps,ws,!1,null,"d3e0fe6a",null)),Qs=Ks.exports,Xs=function(t){return t?Math.max.apply(Math,Object(x["a"])(t.map(function(t){return+t.id_rent})).concat([0]))+1:0},Zs={components:{Details:Qs,Bike:ft,Photo:gt},beforeCreate:function(){this.$store.dispatch("getProducts")},data:function(){return{showDetails:!1,showPhoto:!1,product:{}}},methods:{onClose:function(){this.product={},this.showDetails=!1},onClick:function(t){this.product=t,this.showDetails=!0},openPhoto:function(t){this.product=t,this.showPhoto=!0},closePhoto:function(){this.showPhoto=!1,this.product={}},newProduct:function(){this.showDetails=!0,this.product={newProduct:!0,id_rent:Xs(this.$store.getters.products),categories:null,color:"#fff",cost:0,name:"",note:null,status:"active",tariff_default:null,tariff_ids:null,type:1}}},computed:{products:function(){var t=this.$store.getters.products,e=function(t){return"deleted"!==t.status};return t.filter(function(t){return e(t)})}}},tn=Zs,en=(r("2970"),Object(f["a"])(tn,ks,Ss,!1,null,"3e5745de",null)),rn=en.exports,sn=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"desktop"},[r("iframe",{staticClass:"banner banner--left",attrs:{src:""}}),r("product-list",{staticClass:"snippet snippet__products",on:{addOrder:function(e){return t.addOrder(e)}}}),r("order-list",{staticClass:"snippet snippet__orders"}),r("iframe",{staticClass:"banner banner--right",attrs:{src:"https://rentix.biz/banners/b1/adv_bike2.html"}}),t.show?r("DetailsOrder",{attrs:{product:t.product},on:{close:t.onClose}}):t._e()],1)},nn=[],on={components:{productList:yt,orderList:We,DetailsOrder:nr},created:function(){var t=[{cmd:"getActiveOrders"},{cmd:"getActiveSubOrders"},{cmd:"getProducts"},{cmd:"getTariffs"},{cmd:"getCustomers"},{cmd:"getAccessories"},{cmd:"getGeneralSettings"},{cmd:"getRentalPointInfo"},{cmd:"getCategories"}];this.$store.dispatch("multipleRequest",t)},data:function(){return{product:{},order:{},subOrder:null,show:!1}},methods:{addOrder:function(t){this.product=t,this.show=!0},onClose:function(){this.show=!1}}},an=on,cn=(r("b33a"),Object(f["a"])(an,sn,nn,!1,null,"1353a42b",null)),un=cn.exports,ln=function(){return r.e("chunk-2885c54f").then(r.bind(null,"a55b"))},dn=function(){return r.e("chunk-2d222385").then(r.bind(null,"ce4a"))},fn={template:"<h2>Page Not Found</h2>"};s["a"].use(D["a"]);var pn=function(t,e,r){rt.getters.isAuthenticated?r("/"):r()},_n=function(t,e,r){rt.getters.isAuthenticated?r():r("/Login")},mn=new D["a"]({base:"/",routes:[{path:"/",component:cr,beforeEnter:_n},{path:"/monitor",component:un,beforeEnter:_n},{path:"/customers",component:zr,beforeEnter:_n},{path:"/history",component:wr,beforeEnter:_n},{path:"/settings",redirect:"/settings/main",beforeEnter:_n,component:{render:function(t){return t("router-view")}},children:[{path:"main",component:Vr},{path:"general",component:Xr},{path:"tariffs",component:ls},{path:"products",component:rn},{path:"accessories",component:ys}]},{path:"/repairs",component:{render:function(t){return t("router-view")}},beforeEnter:_n,children:[{path:"/",redirect:"plan"},{path:"plan",component:function(){return r.e("chunk-10935659").then(r.bind(null,"edab"))}},{path:"current",component:function(){return r.e("chunk-2db49ea4").then(r.bind(null,"23f7"))}},{path:"history",component:function(){return r.e("chunk-a897a9a4").then(r.bind(null,"56f9"))}},{path:"settings",component:function(){return r.e("chunk-c1fb4408").then(r.bind(null,"1fcc"))}}]},{path:"/login",component:ln,beforeEnter:pn},{path:"/token/:token",component:dn},{path:"*",component:fn}]});s["a"].config.productionTip=!1,new s["a"]({router:mn,store:rt,render:function(t){return t(A)}}).$mount("#app")},5754:function(t,e,r){"use strict";var s=r("4ab4"),n=r.n(s);n.a},"5c0b":function(t,e,r){"use strict";var s=r("5e27"),n=r.n(s);n.a},"5dfc":function(t,e,r){"use strict";var s=r("2b93"),n=r.n(s);n.a},"5e27":function(t,e,r){},"5fa2":function(t,e,r){},"5fdc":function(t,e,r){},6253:function(t,e,r){},"644e":function(t,e,r){},6816:function(t,e,r){},6836:function(t,e,r){"use strict";var s=r("46ea"),n=r.n(s);n.a},"6c53":function(t,e,r){"use strict";var s=r("8a82"),n=r.n(s);n.a},"792b":function(t,e,r){},"7b70":function(t,e,r){},"7c51":function(t,e,r){},"7ed9":function(t,e,r){},8066:function(t,e,r){"use strict";var s=r("6253"),n=r.n(s);n.a},"85ea":function(t,e,r){"use strict";var s=r("c80f"),n=r.n(s);n.a},"8a82":function(t,e,r){},"8a88":function(t,e,r){"use strict";r.d(e,"a",function(){return o});var s=r("c1df"),n=r.n(s);n.a.locale("ru");var o=function(t,e){var r=n()(e);return r.isValid()?r.format(t):""}},"8a97":function(t,e,r){},"8b67":function(t,e,r){},"8ebb":function(t,e,r){"use strict";var s=r("4813"),n=r.n(s);n.a},9133:function(t,e,r){},"925f":function(t,e,r){"use strict";var s=r("0330"),n=r.n(s);n.a},"9a31":function(t,e,r){},"9a75":function(t,e,r){},a159:function(t,e,r){},a168:function(t,e,r){"use strict";var s=r("163b"),n=r.n(s);n.a},a1fa:function(t,e,r){"use strict";var s=r("792b"),n=r.n(s);n.a},a570:function(t,e,r){"use strict";var s=r("9a75"),n=r.n(s);n.a},b0bc:function(t,e,r){"use strict";var s=r("df77"),n=r.n(s);n.a},b16a:function(t,e,r){"use strict";var s=r("1c51"),n=r.n(s);n.a},b33a:function(t,e,r){"use strict";var s=r("22e1"),n=r.n(s);n.a},b97a:function(t,e,r){"use strict";var s=r("be9e"),n=r.n(s);n.a},bd90:function(t,e,r){"use strict";var s=r("75fc"),n=(r("7f7f"),r("c060")),o=function(t){var e=function(e,r){var s=Object(n["a"])(t.getters.repairs),o=s.filter(function(t){return t.product_id==e&&t.repair_type==r}),i=o.reduce(function(t,e){return null===t&&(t=e),(Date.parse(e.end_time)||Date.now())>Date.parse(t.end_time)&&(t=e),t},null);return i},r=function(r){var s=Object(n["a"])(t.getters.repairTypes),o=s.filter(function(t){return"1"===t.is_plan}),i=o.reduce(function(t,s){var n=e(r.id_rent,s.id_rent);if(n&&!n.end_time)return t;var o=r.mileage-(n?n.mileage:0);return o>=s.period&&t.push({product_id:r.id_rent,product_name:r.name,repair_type:s.id_rent,repair_type_name:s.name,mileage:r.mileage,last_repair:n?n.end_time:"",last_repair_mileage:n?n.mileage:""}),t},[]);return i},o=Object(n["a"])(t.getters.products),i=o.reduce(function(t,e){var n=r(e);return n&&n.length>0&&(t=[].concat(Object(s["a"])(t),Object(s["a"])(n))),t},[]);return i};e["a"]=o},be3c:function(t,e,r){"use strict";var s=r("23de"),n=r.n(s);n.a},be9e:function(t,e,r){},c060:function(t,e,r){"use strict";e["a"]=function(t){return t?JSON.parse(JSON.stringify(t)):null}},c80f:function(t,e,r){},ca14:function(t,e,r){"use strict";var s=r("644e"),n=r.n(s);n.a},ccba:function(t,e,r){"use strict";var s=r("6816"),n=r.n(s);n.a},cd99:function(t,e,r){},cde3:function(t,e,r){"use strict";var s=r("7ed9"),n=r.n(s);n.a},d3da:function(t,e,r){},d4cb:function(t,e,r){"use strict";var s=r("e8fe"),n=r.n(s);n.a},d7bc:function(t,e,r){},dd0e:function(t,e,r){},dda8:function(t,e,r){"use strict";var s=r("d3da"),n=r.n(s);n.a},deeb:function(t,e,r){"use strict";var s=r("4edf"),n=r.n(s);n.a},df77:function(t,e,r){},e8fe:function(t,e,r){},f888:function(t,e,r){"use strict";var s=r("8b67"),n=r.n(s);n.a},fc23:function(t,e,r){"use strict";var s=r("5fa2"),n=r.n(s);n.a}});
//# sourceMappingURL=app.28e1ac22.js.map